!function(){"use strict";angular.module("app",["app.core","app.lab","app.homepage","app.layout"])}(),function(){"use strict";angular.module("app.core",["ngAnimate","ngSanitize","blocks.exception","blocks.logger","blocks.router","ui.router","ngMaterial"])}(),function(){"use strict";function t(t,e,r){t.debugEnabled&&t.debugEnabled(!0),r.configure(o.appErrorPrefix),e.configure({docTitle:o.appTitle+": "})}var e=angular.module("app.core"),o={appErrorPrefix:"[<%= appName %> Error] ",appTitle:"<%= appName %>"};e.value("config",o),e.config(t),t.$inject=["$logProvider","routerHelperProvider","exceptionHandlerProvider"]}(),function(){"use strict";function t(t){var o="/404";t.configureStates(e(),o)}function e(){return[{state:"404",config:{url:"/404",templateUrl:"app/core/404.html",title:"404"}}]}t.$inject=["routerHelper"],angular.module("app.core").run(t)}(),function(){"use strict";function t(t,e,o,r){function n(){return a.products}function c(){return i.then(function(t){return a=t.data,!0},function(){return r.error("Impossible de récupérer les données"),!1})}var u="/ressources/products.json",i=t.get(u),a=null,l={ready:c,getProducts:n};return l}angular.module("app.core").factory("dataservice",t),t.$inject=["$http","$q","exception","logger"]}(),function(){"use strict";angular.module("blocks.exception",["blocks.logger"])}(),function(){"use strict";angular.module("blocks.logger",[])}(),function(){"use strict";angular.module("blocks.router",["ui.router","blocks.logger"])}(),function(){"use strict";function t(){this.config={appErrorPrefix:void 0},this.configure=function(t){this.config.appErrorPrefix=t},this.$get=function(){return{config:this.config}}}function e(t){t.decorator("$exceptionHandler",o)}function o(t,e,o){return function(r,n){var c=e.config.appErrorPrefix||"",u={exception:r,cause:n};r.message=c+r.message,t(r,n),o.error(r.message,u)}}angular.module("blocks.exception").provider("exceptionHandler",t).config(e),e.$inject=["$provide"],o.$inject=["$delegate","exceptionHandler","logger"]}(),function(){"use strict";function t(t,e){function o(o){return function(r){var n,c;return r.data&&r.data.description&&(n="\n"+r.data.description,c=o+n),r.data.description=c,e.error(c),t.reject(r)}}var r={catcher:o};return r}t.$inject=["$q","logger"],angular.module("blocks.exception").factory("exception",t)}(),function(){"use strict";function t(t,e){function o(e,o,r){console.error(e,r),t.error("Error: "+e,o)}function r(e,o,r){console.info(e,r),t.info("Info: "+e,o)}function n(e,o,r){console.log(e,r),t.info("Success: "+e,o)}function c(e,o,r){console.warn(e,r),t.warn("Warning: "+e,o)}var u={error:o,info:r,success:n,warning:c,log:t.log};return u}angular.module("blocks.logger").factory("logger",t),t.$inject=["$log"]}(),function(){"use strict";function t(t,e,o){function r(t,r,c,u){function i(t,r){t.forEach(function(t){t.config.resolve=angular.extend(t.config.resolve||{},n.resolveAlways),e.state(t.state,t.config)}),r&&!g&&(g=!0,o.otherwise(r))}function a(){r.$on("$stateChangeError",function(e,o,r,n,c,i){if(!f){d.errors++,f=!0;var a=o&&(o.title||o.name||o.loadedTemplateUrl)||"unknown target",l="Error routing to "+a+". "+(i.data||"")+". <br/>"+(i.statusText||"")+": "+(i.status||"");u.warning(l,[o]),t.path("/")}})}function l(){a(),p()}function s(){return c.get()}function p(){r.$on("$stateChangeSuccess",function(t,e,o,c,u){d.changes++,f=!1;var i=n.docTitle+" "+(e.title||"");r.title=i})}var f=!1,g=!1,d={errors:0,changes:0},b={configureStates:i,getStates:s,stateCounts:d};return l(),b}var n={docTitle:void 0,resolveAlways:{}};t.html5Mode({enabled:!1,requireBase:!1}),this.configure=function(t){angular.extend(n,t)},this.$get=r,r.$inject=["$location","$rootScope","$state","logger"]}angular.module("blocks.router").provider("routerHelper",t),t.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}(),function(){"use strict";angular.module("app.lab.attributes",["app.core"])}(),function(){angular.module("app.lab.products",["app.core"])}(),function(){"use strict";angular.module("app.homepage",["app.core"])}(),function(){angular.module("app.lab",["app.core","app.lab.products","app.lab.attributes"])}(),function(){"use strict";angular.module("app.layout",["app.core"])}(),function(){"use strict";function t(){var t=this;t.title="Homepage"}angular.module("app.homepage").controller("HomeController",t)}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"homepage",config:{url:"/",templateUrl:"app/homepage/homepage.view.html",controller:"HomeController",controllerAs:"home",title:"DoYourBeauty"}}]}angular.module("app.homepage").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){var e=this;e.choices={}}angular.module("app.lab").controller("LabController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab",config:{url:"/lab",templateUrl:"app/lab/lab.view.html",controller:"LabController",controllerAs:"labVm",title:"DoYourBeauty - Lab"}}]}angular.module("app.lab").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){}angular.module("app.layout").controller("HeaderController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t,e){function o(){return"undefined"==typeof t.labVm.choices.product?void e.go("lab.products"):void(n.attributes=t.labVm.choices.product.attributes)}function r(t){return"app/lab/attributes/forms/"+t.form+"/"+t.form+".view.html"}var n=this;n.getForm=r,o()}angular.module("app.lab.attributes").controller("AttributesController",t),t.$inject=["$scope","$state"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab.attributes",config:{url:"/attributes",title:"DoYourBeauty - attributes",controller:"AttributesController",controllerAs:"attributesVm",templateUrl:"app/lab/attributes/attributes.view.html"}}]}angular.module("app.lab.attributes").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e,o){function r(){o.ready().then(n)}function n(){u.products=o.getProducts()}function c(o){t.labVm.choices.product=o,e.go("lab.attributes")}var u=this;u.select=c,r()}angular.module("app.lab.products").controller("ProductsController",t),t.$inject=["$scope","$state","dataservice"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab.products",config:{url:"/products",title:"DoYourBeauty - products",controller:"ProductsController",controllerAs:"productsVm",templateUrl:"app/lab/products/products.view.html"}}]}angular.module("app.lab.products").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){function e(e){o.choice=e,t.labVm.choices[o.attribute.name]=e}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("BtnRadioController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(t){return n.choices.indexOf(t)>-1}function o(t){var e=n.choices.indexOf(t);e>-1?n.choices.splice(e,1):n.choices.push(t)}function r(){t.labVm.choices[n.attribute.name]=n.choices}var n=this;n.choices=[],n.exists=e,n.toggle=o,n.saveChoices=r}angular.module("app.lab.attributes").controller("CheckboxController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(e){o.choice=e,t.labVm.choices[o.attribute.name]=e}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("ImgRadioController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(){t.labVm.choices[o.attribute.name]=o.choice}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("InputTextController",t),t.$inject=["$scope"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjb3JlLm1vZHVsZS5qcyIsImNvbmZpZy5qcyIsImNvcmUucm91dGUuanMiLCJhcHAubWluLmpzIiwiZGF0YXNlcnZpY2UuanMiLCJleGNlcHRpb24vZXhjZXB0aW9uLm1vZHVsZS5qcyIsImxvZ2dlci9sb2dnZXIubW9kdWxlLmpzIiwicm91dGVyL3JvdXRlci5tb2R1bGUuanMiLCJleGNlcHRpb24vZXhjZXB0aW9uLWhhbmRsZXIucHJvdmlkZXIuanMiLCJleGNlcHRpb24vZXhjZXB0aW9uLmpzIiwibG9nZ2VyL2xvZ2dlci5qcyIsInJvdXRlci9yb3V0ZXItaGVscGVyLnByb3ZpZGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy5tb2R1bGUuanMiLCJsYWIvcHJvZHVjdHMvcHJvZHVjdHMubW9kdWxlLmpzIiwiaG9tZXBhZ2UvaG9tZXBhZ2UubW9kdWxlLmpzIiwibGFiL2xhYi5tb2R1bGUuanMiLCJsYXlvdXQvbGF5b3V0Lm1vZHVsZS5qcyIsImhvbWVwYWdlL2hvbWVwYWdlLmNvbnRyb2xsZXIuanMiLCJob21lcGFnZS9ob21lcGFnZS5yb3V0ZS5qcyIsImxhYi9sYWIuY29udHJvbGxlci5qcyIsImxhYi9sYWIucm91dGUuanMiLCJsYXlvdXQvaGVhZGVyLmNvbnRyb2xsZXIuanMiLCJsYWIvYXR0cmlidXRlcy9hdHRyaWJ1dGVzLmNvbnRyb2xsZXIuanMiLCJsYWIvYXR0cmlidXRlcy9hdHRyaWJ1dGVzLnJvdXRlLmpzIiwibGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLmNvbnRyb2xsZXIuanMiLCJsYWIvcHJvZHVjdHMvcHJvZHVjdHMucm91dGUuanMiLCJsYWIvYXR0cmlidXRlcy9mb3Jtcy9idG4tcmFkaW8vYnRuLXJhZGlvLmNvbnRyb2xsZXIuanMiLCJsYWIvYXR0cmlidXRlcy9mb3Jtcy9jaGVja2JveC9jaGVja2JveC5jb250cm9sbGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvZm9ybXMvaW1nLXJhZGlvL2ltZy1yYWRpby5jb250cm9sbGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvZm9ybXMvaW5wdXQtdGV4dC9pbnB1dC10ZXh0LmNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZ3VyZSIsIiRsb2dQcm92aWRlciIsInJvdXRlckhlbHBlclByb3ZpZGVyIiwiZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyIiwiZGVidWdFbmFibGVkIiwiY29uZmlnIiwiYXBwRXJyb3JQcmVmaXgiLCJkb2NUaXRsZSIsImFwcFRpdGxlIiwiY29yZSIsInZhbHVlIiwiJGluamVjdCIsImFwcFJ1biIsInJvdXRlckhlbHBlciIsIm90aGVyd2lzZSIsImNvbmZpZ3VyZVN0YXRlcyIsImdldFN0YXRlcyIsInN0YXRlIiwidXJsIiwidGVtcGxhdGVVcmwiLCJ0aXRsZSIsInJ1biIsImRhdGFzZXJ2aWNlIiwiJGh0dHAiLCIkcSIsImV4Y2VwdGlvbiIsImxvZ2dlciIsImdldFByb2R1Y3RzIiwiZGF0YSIsInByb2R1Y3RzIiwicmVhZHkiLCJwcm9taXNlIiwidGhlbiIsInJlc3VsdCIsImVycm9yIiwianNvblVSTCIsImdldCIsInNlcnZpY2UiLCJmYWN0b3J5IiwidGhpcyIsInVuZGVmaW5lZCIsIiRnZXQiLCIkcHJvdmlkZSIsImRlY29yYXRvciIsImV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIiLCIkZGVsZWdhdGUiLCJleGNlcHRpb25IYW5kbGVyIiwiY2F1c2UiLCJlcnJvckRhdGEiLCJtZXNzYWdlIiwicHJvdmlkZXIiLCJjYXRjaGVyIiwiZSIsInRocm93bkRlc2NyaXB0aW9uIiwibmV3TWVzc2FnZSIsImRlc2NyaXB0aW9uIiwicmVqZWN0IiwiJGxvZyIsInRvYXN0ciIsImNvbnNvbGUiLCJpbmZvIiwic3VjY2VzcyIsImxvZyIsIndhcm5pbmciLCJ3YXJuIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIlJvdXRlckhlbHBlciIsIiRsb2NhdGlvbiIsIiRyb290U2NvcGUiLCIkc3RhdGUiLCJzdGF0ZXMiLCJvdGhlcndpc2VQYXRoIiwiZm9yRWFjaCIsInJlc29sdmUiLCJleHRlbmQiLCJyZXNvbHZlQWx3YXlzIiwiaGFzT3RoZXJ3aXNlIiwiaGFuZGxlUm91dGluZ0Vycm9ycyIsIiRvbiIsImV2ZW50IiwidG9TdGF0ZSIsInRvUGFyYW1zIiwiZnJvbVN0YXRlIiwiZnJvbVBhcmFtcyIsImhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciIsInN0YXRlQ291bnRzIiwiZXJyb3JzIiwiZGVzdGluYXRpb24iLCJuYW1lIiwibG9hZGVkVGVtcGxhdGVVcmwiLCJtc2ciLCJzdGF0dXNUZXh0Iiwic3RhdHVzIiwicGF0aCIsImluaXQiLCJ1cGRhdGVEb2NUaXRsZSIsImNoYW5nZXMiLCJodG1sNU1vZGUiLCJlbmFibGVkIiwicmVxdWlyZUJhc2UiLCJjZmciLCJIb21lQ29udHJvbGxlciIsInZtIiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsIkxhYkNvbnRyb2xsZXIiLCIkc2NvcGUiLCJjaG9pY2VzIiwiSGVhZGVyQ29udHJvbGxlciIsIkF0dHJpYnV0ZXNDb250cm9sbGVyIiwiYWN0aXZhdGUiLCJsYWJWbSIsInByb2R1Y3QiLCJnbyIsImF0dHJpYnV0ZXMiLCJnZXRGb3JtIiwiYXR0cmlidXRlIiwiZm9ybSIsIlByb2R1Y3RzQ29udHJvbGxlciIsInNlbGVjdCIsIkJ0blJhZGlvQ29udHJvbGxlciIsInNldENob2ljZSIsImF0dHJpYnV0ZUNob2ljZWQiLCJjaG9pY2UiLCJDaGVja2JveENvbnRyb2xsZXIiLCJleGlzdHMiLCJpbmRleE9mIiwidG9nZ2xlIiwiaWR4Iiwic3BsaWNlIiwicHVzaCIsInNhdmVDaG9pY2VzIiwiSW1nUmFkaW9Db250cm9sbGVyIiwiSW5wdXRUZXh0Q29udHJvbGxlciJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQSxZQUVBQSxTQUFBQyxPQUFBLE9BQ0EsV0FDQSxVQUNBLGVBQ0Esa0JDUEEsV0FDQSxZQUVBRCxT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QSxFQVZBN0gsUUFDQUMsT0FBQSxzQkFDQTBHLFdBQUEsc0JBQUE4QixHQUVBQSxFQUFBNUgsU0FBQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAgICAgICAnYXBwLmNvcmUnLFxuICAgICAgICAnYXBwLmxhYicsXG4gICAgICAgICdhcHAuaG9tZXBhZ2UnLFxuICAgICAgICAnYXBwLmxheW91dCdcbiAgICBdKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuY29yZScsIFtcbiAgICAgICAgICAgICduZ0FuaW1hdGUnLCAnbmdTYW5pdGl6ZScsXG4gICAgICAgICAgICAnYmxvY2tzLmV4Y2VwdGlvbicsICdibG9ja3MubG9nZ2VyJywgJ2Jsb2Nrcy5yb3V0ZXInLFxuICAgICAgICAgICAgJ3VpLnJvdXRlcicsICduZ01hdGVyaWFsJ1xuICAgICAgICBdKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBjb3JlID0gYW5ndWxhci5tb2R1bGUoJ2FwcC5jb3JlJyk7XG4gICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgYXBwRXJyb3JQcmVmaXg6ICdbPCU9IGFwcE5hbWUgJT4gRXJyb3JdICcsXG4gICAgICAgIGFwcFRpdGxlOiAnPCU9IGFwcE5hbWUgJT4nXG4gICAgfTtcblxuICAgIGNvcmUudmFsdWUoJ2NvbmZpZycsIGNvbmZpZyk7XG5cbiAgICBjb3JlLmNvbmZpZyhjb25maWd1cmUpO1xuXG4gICAgY29uZmlndXJlLiRpbmplY3QgPSBbJyRsb2dQcm92aWRlcicsICdyb3V0ZXJIZWxwZXJQcm92aWRlcicsICdleGNlcHRpb25IYW5kbGVyUHJvdmlkZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBjb25maWd1cmUoJGxvZ1Byb3ZpZGVyLCByb3V0ZXJIZWxwZXJQcm92aWRlciwgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKSB7XG4gICAgICAgIGlmICgkbG9nUHJvdmlkZXIuZGVidWdFbmFibGVkKSB7XG4gICAgICAgICAgICAkbG9nUHJvdmlkZXIuZGVidWdFbmFibGVkKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlci5jb25maWd1cmUoY29uZmlnLmFwcEVycm9yUHJlZml4KTtcbiAgICAgICAgcm91dGVySGVscGVyUHJvdmlkZXIuY29uZmlndXJlKHtkb2NUaXRsZTogY29uZmlnLmFwcFRpdGxlICsgJzogJ30pO1xuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xuICAgICAgICB2YXIgb3RoZXJ3aXNlID0gJy80MDQnO1xuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpLCBvdGhlcndpc2UpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJzQwNCcsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy80MDQnLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9jb3JlLzQwNC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICc0MDQnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICAgICAgICdhcHAuY29yZScsXG4gICAgICAgICdhcHAubGFiJyxcbiAgICAgICAgJ2FwcC5ob21lcGFnZScsXG4gICAgICAgICdhcHAubGF5b3V0J1xuICAgIF0pO1xuXG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvcmUnLCBbXG4gICAgICAgICAgICAnbmdBbmltYXRlJywgJ25nU2FuaXRpemUnLFxuICAgICAgICAgICAgJ2Jsb2Nrcy5leGNlcHRpb24nLCAnYmxvY2tzLmxvZ2dlcicsICdibG9ja3Mucm91dGVyJyxcbiAgICAgICAgICAgICd1aS5yb3V0ZXInLCAnbmdNYXRlcmlhbCdcbiAgICAgICAgXSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBjb3JlID0gYW5ndWxhci5tb2R1bGUoJ2FwcC5jb3JlJyk7XG4gICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgYXBwRXJyb3JQcmVmaXg6ICdbPCU9IGFwcE5hbWUgJT4gRXJyb3JdICcsXG4gICAgICAgIGFwcFRpdGxlOiAnPCU9IGFwcE5hbWUgJT4nXG4gICAgfTtcblxuICAgIGNvcmUudmFsdWUoJ2NvbmZpZycsIGNvbmZpZyk7XG5cbiAgICBjb3JlLmNvbmZpZyhjb25maWd1cmUpO1xuXG4gICAgY29uZmlndXJlLiRpbmplY3QgPSBbJyRsb2dQcm92aWRlcicsICdyb3V0ZXJIZWxwZXJQcm92aWRlcicsICdleGNlcHRpb25IYW5kbGVyUHJvdmlkZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBjb25maWd1cmUoJGxvZ1Byb3ZpZGVyLCByb3V0ZXJIZWxwZXJQcm92aWRlciwgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKSB7XG4gICAgICAgIGlmICgkbG9nUHJvdmlkZXIuZGVidWdFbmFibGVkKSB7XG4gICAgICAgICAgICAkbG9nUHJvdmlkZXIuZGVidWdFbmFibGVkKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlci5jb25maWd1cmUoY29uZmlnLmFwcEVycm9yUHJlZml4KTtcbiAgICAgICAgcm91dGVySGVscGVyUHJvdmlkZXIuY29uZmlndXJlKHtkb2NUaXRsZTogY29uZmlnLmFwcFRpdGxlICsgJzogJ30pO1xuICAgIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gW1wicm91dGVySGVscGVyXCJdO1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvcmUnKVxuICAgICAgICAucnVuKGFwcFJ1bik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XG4gICAgICAgIHZhciBvdGhlcndpc2UgPSAnLzQwNCc7XG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCksIG90aGVyd2lzZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnNDA0JyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnLzQwNCcsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2NvcmUvNDA0Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJzQwNCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJylcbiAgICAgICAgLmZhY3RvcnkoJ2RhdGFzZXJ2aWNlJywgZGF0YXNlcnZpY2UpO1xuXG4gICAgZGF0YXNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCAnJHEnLCAnZXhjZXB0aW9uJywgJ2xvZ2dlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGRhdGFzZXJ2aWNlKCRodHRwLCAkcSwgZXhjZXB0aW9uLCBsb2dnZXIpIHtcbiAgICAgICAgdmFyIGpzb25VUkwgPSAnL3Jlc3NvdXJjZXMvcHJvZHVjdHMuanNvbic7XG4gICAgICAgIHZhciBwcm9taXNlID0gJGh0dHAuZ2V0KGpzb25VUkwpO1xuICAgICAgICB2YXIgZGF0YSA9IG51bGw7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgIHJlYWR5OiByZWFkeSxcbiAgICAgICAgICBnZXRQcm9kdWN0czogZ2V0UHJvZHVjdHNcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICBmdW5jdGlvbiBnZXRQcm9kdWN0cygpIHtcbiAgICAgICAgICByZXR1cm4gZGF0YS5wcm9kdWN0cztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlYWR5KCkge1xuICAgICAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICBkYXRhID0gcmVzdWx0LmRhdGE7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignSW1wb3NzaWJsZSBkZSByw6ljdXDDqXJlciBsZXMgZG9ubsOpZXMnKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJywgWydibG9ja3MubG9nZ2VyJ10pO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdibG9ja3MubG9nZ2VyJywgW10pO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdibG9ja3Mucm91dGVyJywgW1xuICAgICAgICAndWkucm91dGVyJyxcbiAgICAgICAgJ2Jsb2Nrcy5sb2dnZXInXG4gICAgXSk7XG59KSgpO1xuXG4vLyBJbmNsdWRlIGluIGluZGV4Lmh0bWwgc28gdGhhdCBhcHAgbGV2ZWwgZXhjZXB0aW9ucyBhcmUgaGFuZGxlZC5cbi8vIEV4Y2x1ZGUgZnJvbSB0ZXN0UnVubmVyLmh0bWwgd2hpY2ggc2hvdWxkIHJ1biBleGFjdGx5IHdoYXQgaXQgd2FudHMgdG8gcnVuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJylcbiAgICAgICAgLnByb3ZpZGVyKCdleGNlcHRpb25IYW5kbGVyJywgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKVxuICAgICAgICAuY29uZmlnKGNvbmZpZyk7XG5cbiAgICAvKipcbiAgICAgKiBNdXN0IGNvbmZpZ3VyZSB0aGUgZXhjZXB0aW9uIGhhbmRsaW5nXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKCkge1xuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgICAgICAgdGhpcy5jb25maWcgPSB7XG4gICAgICAgICAgICBhcHBFcnJvclByZWZpeDogdW5kZWZpbmVkXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5jb25maWd1cmUgPSBmdW5jdGlvbiAoYXBwRXJyb3JQcmVmaXgpIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmFwcEVycm9yUHJlZml4ID0gYXBwRXJyb3JQcmVmaXg7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4ge2NvbmZpZzogdGhpcy5jb25maWd9O1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNvbmZpZy4kaW5qZWN0ID0gWyckcHJvdmlkZSddO1xuXG4gICAgLyoqXG4gICAgICogQ29uZmlndXJlIGJ5IHNldHRpbmcgYW4gb3B0aW9uYWwgc3RyaW5nIHZhbHVlIGZvciBhcHBFcnJvclByZWZpeC5cbiAgICAgKiBBY2Nlc3NpYmxlIHZpYSBjb25maWcuYXBwRXJyb3JQcmVmaXggKHZpYSBjb25maWcgdmFsdWUpLlxuICAgICAqIEBwYXJhbSAge09iamVjdH0gJHByb3ZpZGVcbiAgICAgKi9cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBjb25maWcoJHByb3ZpZGUpIHtcbiAgICAgICAgJHByb3ZpZGUuZGVjb3JhdG9yKCckZXhjZXB0aW9uSGFuZGxlcicsIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIpO1xuICAgIH1cblxuICAgIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIuJGluamVjdCA9IFsnJGRlbGVnYXRlJywgJ2V4Y2VwdGlvbkhhbmRsZXInLCAnbG9nZ2VyJ107XG5cbiAgICAvKipcbiAgICAgKiBFeHRlbmQgdGhlICRleGNlcHRpb25IYW5kbGVyIHNlcnZpY2UgdG8gYWxzbyBkaXNwbGF5IGEgdG9hc3QuXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSAkZGVsZWdhdGVcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGV4Y2VwdGlvbkhhbmRsZXJcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGxvZ2dlclxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSB0aGUgZGVjb3JhdGVkICRleGNlcHRpb25IYW5kbGVyIHNlcnZpY2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleHRlbmRFeGNlcHRpb25IYW5kbGVyKCRkZWxlZ2F0ZSwgZXhjZXB0aW9uSGFuZGxlciwgbG9nZ2VyKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihleGNlcHRpb24sIGNhdXNlKSB7XG4gICAgICAgICAgICB2YXIgYXBwRXJyb3JQcmVmaXggPSBleGNlcHRpb25IYW5kbGVyLmNvbmZpZy5hcHBFcnJvclByZWZpeCB8fCAnJztcbiAgICAgICAgICAgIHZhciBlcnJvckRhdGEgPSB7ZXhjZXB0aW9uOiBleGNlcHRpb24sIGNhdXNlOiBjYXVzZX07XG4gICAgICAgICAgICBleGNlcHRpb24ubWVzc2FnZSA9IGFwcEVycm9yUHJlZml4ICsgZXhjZXB0aW9uLm1lc3NhZ2U7XG4gICAgICAgICAgICAkZGVsZWdhdGUoZXhjZXB0aW9uLCBjYXVzZSk7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvdWxkIGFkZCB0aGUgZXJyb3IgdG8gYSBzZXJ2aWNlJ3MgY29sbGVjdGlvbixcbiAgICAgICAgICAgICAqIGFkZCBlcnJvcnMgdG8gJHJvb3RTY29wZSwgbG9nIGVycm9ycyB0byByZW1vdGUgd2ViIHNlcnZlcixcbiAgICAgICAgICAgICAqIG9yIGxvZyBsb2NhbGx5LiBPciB0aHJvdyBoYXJkLiBJdCBpcyBlbnRpcmVseSB1cCB0byB5b3UuXG4gICAgICAgICAgICAgKiB0aHJvdyBleGNlcHRpb247XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICAgICAqICAgICB0aHJvdyB7IG1lc3NhZ2U6ICdlcnJvciBtZXNzYWdlIHdlIGFkZGVkJyB9O1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXhjZXB0aW9uLm1lc3NhZ2UsIGVycm9yRGF0YSk7XG4gICAgICAgIH07XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGV4Y2VwdGlvbi4kaW5qZWN0ID0gW1wiJHFcIiwgXCJsb2dnZXJcIl07XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJylcbiAgICAgICAgLmZhY3RvcnkoJ2V4Y2VwdGlvbicsIGV4Y2VwdGlvbik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBleGNlcHRpb24oJHEsIGxvZ2dlcikge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGNhdGNoZXI6IGNhdGNoZXJcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgZnVuY3Rpb24gY2F0Y2hlcihtZXNzYWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aHJvd25EZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICB2YXIgbmV3TWVzc2FnZTtcbiAgICAgICAgICAgICAgICBpZiAoZS5kYXRhICYmIGUuZGF0YS5kZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB0aHJvd25EZXNjcmlwdGlvbiA9ICdcXG4nICsgZS5kYXRhLmRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgICAgICBuZXdNZXNzYWdlID0gbWVzc2FnZSArIHRocm93bkRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlLmRhdGEuZGVzY3JpcHRpb24gPSBuZXdNZXNzYWdlO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuZXdNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KGUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInKVxuICAgICAgICAuZmFjdG9yeSgnbG9nZ2VyJywgbG9nZ2VyKTtcblxuICAgIGxvZ2dlci4kaW5qZWN0ID0gWyckbG9nJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBsb2dnZXIoJGxvZywgdG9hc3RyKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgZXJyb3IgICA6IGVycm9yLFxuICAgICAgICAgICAgaW5mbyAgICA6IGluZm8sXG4gICAgICAgICAgICBzdWNjZXNzIDogc3VjY2VzcyxcbiAgICAgICAgICAgIHdhcm5pbmcgOiB3YXJuaW5nLFxuXG4gICAgICAgICAgICAvLyBzdHJhaWdodCB0byBjb25zb2xlOyBieXBhc3MgdG9hc3RyXG4gICAgICAgICAgICBsb2cgICAgIDogJGxvZy5sb2dcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gZXJyb3IobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5lcnJvcignRXJyb3I6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluZm8obWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLmluZm8oJ0luZm86ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuaW5mbygnU3VjY2VzczogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gd2FybmluZyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cud2FybignV2FybmluZzogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxufSgpKTtcblxuLyogSGVscCBjb25maWd1cmUgdGhlIHN0YXRlLWJhc2UgdWkucm91dGVyICovXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3Mucm91dGVyJylcbiAgICAgICAgLnByb3ZpZGVyKCdyb3V0ZXJIZWxwZXInLCByb3V0ZXJIZWxwZXJQcm92aWRlcik7XG5cbiAgICByb3V0ZXJIZWxwZXJQcm92aWRlci4kaW5qZWN0ID0gWyckbG9jYXRpb25Qcm92aWRlcicsICckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiByb3V0ZXJIZWxwZXJQcm92aWRlcigkbG9jYXRpb25Qcm92aWRlciwgJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgIGRvY1RpdGxlOiB1bmRlZmluZWQsXG4gICAgICAgICAgICByZXNvbHZlQWx3YXlzOiB7fVxuICAgICAgICB9O1xuXG4gICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh7XG4gICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgcmVxdWlyZUJhc2U6IGZhbHNlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuY29uZmlndXJlID0gZnVuY3Rpb24oY2ZnKSB7XG4gICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChjb25maWcsIGNmZyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy4kZ2V0ID0gUm91dGVySGVscGVyO1xuICAgICAgICBSb3V0ZXJIZWxwZXIuJGluamVjdCA9IFsnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCAnJHN0YXRlJywgJ2xvZ2dlciddO1xuICAgICAgICAvKiBAbmdJbmplY3QgKi9cbiAgICAgICAgZnVuY3Rpb24gUm91dGVySGVscGVyKCRsb2NhdGlvbiwgJHJvb3RTY29wZSwgJHN0YXRlLCBsb2dnZXIpIHtcbiAgICAgICAgICAgIHZhciBoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBoYXNPdGhlcndpc2UgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzdGF0ZUNvdW50cyA9IHtcbiAgICAgICAgICAgICAgICBlcnJvcnM6IDAsXG4gICAgICAgICAgICAgICAgY2hhbmdlczogMFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICAgICAgY29uZmlndXJlU3RhdGVzOiBjb25maWd1cmVTdGF0ZXMsXG4gICAgICAgICAgICAgICAgZ2V0U3RhdGVzOiBnZXRTdGF0ZXMsXG4gICAgICAgICAgICAgICAgc3RhdGVDb3VudHM6IHN0YXRlQ291bnRzXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlU3RhdGVzKHN0YXRlcywgb3RoZXJ3aXNlUGF0aCkge1xuICAgICAgICAgICAgICAgIHN0YXRlcy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmNvbmZpZy5yZXNvbHZlID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHN0YXRlLmNvbmZpZy5yZXNvbHZlIHx8IHt9LCBjb25maWcucmVzb2x2ZUFsd2F5cyk7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKHN0YXRlLnN0YXRlLCBzdGF0ZS5jb25maWcpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChvdGhlcndpc2VQYXRoICYmICFoYXNPdGhlcndpc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaGFzT3RoZXJ3aXNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZShvdGhlcndpc2VQYXRoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVJvdXRpbmdFcnJvcnMoKSB7XG4gICAgICAgICAgICAgICAgLy8gUm91dGUgY2FuY2VsbGF0aW9uOlxuICAgICAgICAgICAgICAgIC8vIE9uIHJvdXRpbmcgZXJyb3IsIGdvIHRvIHRoZSBkYXNoYm9hcmQuXG4gICAgICAgICAgICAgICAgLy8gUHJvdmlkZSBhbiBleGl0IGNsYXVzZSBpZiBpdCB0cmllcyB0byBkbyBpdCB0d2ljZS5cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlRXJyb3InLFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcywgZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50cy5lcnJvcnMrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVzdGluYXRpb24gPSAodG9TdGF0ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0b1N0YXRlLnRpdGxlIHx8IHRvU3RhdGUubmFtZSB8fCB0b1N0YXRlLmxvYWRlZFRlbXBsYXRlVXJsKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndW5rbm93biB0YXJnZXQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1zZyA9ICdFcnJvciByb3V0aW5nIHRvICcgKyBkZXN0aW5hdGlvbiArICcuICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChlcnJvci5kYXRhIHx8ICcnKSArICcuIDxici8+JyArIChlcnJvci5zdGF0dXNUZXh0IHx8ICcnKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzogJyArIChlcnJvci5zdGF0dXMgfHwgJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcobXNnLCBbdG9TdGF0ZV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlUm91dGluZ0Vycm9ycygpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZURvY1RpdGxlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHsgcmV0dXJuICRzdGF0ZS5nZXQoKTsgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVEb2NUaXRsZSgpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50cy5jaGFuZ2VzKys7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IGNvbmZpZy5kb2NUaXRsZSArICcgJyArICh0b1N0YXRlLnRpdGxlIHx8ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUudGl0bGUgPSB0aXRsZTsgLy8gZGF0YSBiaW5kIHRvIDx0aXRsZT5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJywgWydhcHAuY29yZSddKTtcblxufSkgKCk7XG5cbihmdW5jdGlvbiAoKSB7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnLCBbJ2FwcC5jb3JlJ10pO1xuXG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmhvbWVwYWdlJywgW1xuICAgICdhcHAuY29yZSdcbiAgXSk7XG5cbn0pICgpO1xuXG4oZnVuY3Rpb24gKCkge1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAubGFiJywgW1xuICAgICdhcHAuY29yZScsXG4gICAgJ2FwcC5sYWIucHJvZHVjdHMnLFxuICAgICdhcHAubGFiLmF0dHJpYnV0ZXMnXG4gIF0pO1xuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYXlvdXQnLCBbXG4gICAgICAnYXBwLmNvcmUnXG4gICAgXSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5ob21lcGFnZScpLmNvbnRyb2xsZXIoJ0hvbWVDb250cm9sbGVyJywgSG9tZUNvbnRyb2xsZXIpO1xuXG4gIGZ1bmN0aW9uIEhvbWVDb250cm9sbGVyKCnCoHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnRpdGxlID0gJ0hvbWVwYWdlJztcbiAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmhvbWVwYWdlJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnaG9tZXBhZ2UnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvaG9tZXBhZ2UvaG9tZXBhZ2Uudmlldy5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnaG9tZScsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5J1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0xhYkNvbnRyb2xsZXInLCBMYWJDb250cm9sbGVyKTtcblxuICAgIExhYkNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBMYWJDb250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5jaG9pY2VzID0ge307XG4gICAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGFiJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2xhYicsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2xhYi9sYWIudmlldy5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0xhYkNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsYWJWbScsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5IC0gTGFiJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYXlvdXQnKVxuICAgICAgICAgIC5jb250cm9sbGVyKCdIZWFkZXJDb250cm9sbGVyJywgSGVhZGVyQ29udHJvbGxlcik7XG5cbiAgICBIZWFkZXJDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gSGVhZGVyQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAuY29udHJvbGxlcignQXR0cmlidXRlc0NvbnRyb2xsZXInLCBBdHRyaWJ1dGVzQ29udHJvbGxlcik7XG5cbiAgICBBdHRyaWJ1dGVzQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHN0YXRlJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gQXR0cmlidXRlc0NvbnRyb2xsZXIoJHNjb3BlLCAkc3RhdGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uZ2V0Rm9ybSA9IGdldEZvcm07XG5cbiAgICAgICAgYWN0aXZhdGUoKTtcblxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICAgICBpZiAodHlwZW9mICRzY29wZS5sYWJWbS5jaG9pY2VzLnByb2R1Y3QgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnbGFiLnByb2R1Y3RzJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdm0uYXR0cmlidXRlcyA9ICRzY29wZS5sYWJWbS5jaG9pY2VzLnByb2R1Y3QuYXR0cmlidXRlcztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEZvcm0oYXR0cmlidXRlKSB7XG4gICAgICAgICAgcmV0dXJuIFwiYXBwL2xhYi9hdHRyaWJ1dGVzL2Zvcm1zL1wiICsgYXR0cmlidXRlLmZvcm0gKyBcIi9cIiArICBhdHRyaWJ1dGUuZm9ybSArIFwiLnZpZXcuaHRtbFwiO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAucnVuKGFwcFJ1bik7XG5cbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsYWIuYXR0cmlidXRlcycsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9hdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBhdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0F0dHJpYnV0ZXNDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnYXR0cmlidXRlc1ZtJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy52aWV3Lmh0bWwnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnKVxuICAgICAgICAuY29udHJvbGxlcignUHJvZHVjdHNDb250cm9sbGVyJywgUHJvZHVjdHNDb250cm9sbGVyKTtcblxuICAgIFByb2R1Y3RzQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHN0YXRlJywgJ2RhdGFzZXJ2aWNlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBQcm9kdWN0c0NvbnRyb2xsZXIoJHNjb3BlLCAkc3RhdGUsIGRhdGFzZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0uc2VsZWN0ID0gc2VsZWN0O1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgZGF0YXNlcnZpY2UucmVhZHkoKS50aGVuKGdldFByb2R1Y3RzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2R1Y3RzKCkge1xuICAgICAgICAgIHZtLnByb2R1Y3RzID0gZGF0YXNlcnZpY2UuZ2V0UHJvZHVjdHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdChwcm9kdWN0KSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXMucHJvZHVjdCA9IHByb2R1Y3Q7XG4gICAgICAgICAgJHN0YXRlLmdvKCdsYWIuYXR0cmlidXRlcycpO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLnByb2R1Y3RzJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGFiLnByb2R1Y3RzJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3Byb2R1Y3RzJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBwcm9kdWN0cycsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9kdWN0c0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdwcm9kdWN0c1ZtJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLnZpZXcuaHRtbCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0J0blJhZGlvQ29udHJvbGxlcicsIEJ0blJhZGlvQ29udHJvbGxlcik7XG5cbiAgICBCdG5SYWRpb0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBCdG5SYWRpb0NvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XG4gICAgICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcblxuXG4gICAgICAgIGZ1bmN0aW9uIHNldENob2ljZShhdHRyaWJ1dGVDaG9pY2VkKSB7XG4gICAgICAgICAgdm0uY2hvaWNlID0gYXR0cmlidXRlQ2hvaWNlZDtcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdDaGVja2JveENvbnRyb2xsZXInLCBDaGVja2JveENvbnRyb2xsZXIpO1xuXG4gICAgQ2hlY2tib3hDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gQ2hlY2tib3hDb250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5jaG9pY2VzID0gW107XG4gICAgICAgIHZtLmV4aXN0cyA9IGV4aXN0cztcbiAgICAgICAgdm0udG9nZ2xlID0gdG9nZ2xlO1xuICAgICAgICB2bS5zYXZlQ2hvaWNlcyA9IHNhdmVDaG9pY2VzO1xuXG4gICAgICAgIGZ1bmN0aW9uIGV4aXN0cyh2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiB2bS5jaG9pY2VzLmluZGV4T2YodmFsdWUpID4gLTE7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB0b2dnbGUodmFsdWUpIHtcbiAgICAgICAgICB2YXIgaWR4ID0gdm0uY2hvaWNlcy5pbmRleE9mKHZhbHVlKTtcbiAgICAgICAgICBpZiAoaWR4ID4gLTEpIHtcbiAgICAgICAgICAgIHZtLmNob2ljZXMuc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZtLmNob2ljZXMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVDaG9pY2VzKCkge1xuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IHZtLmNob2ljZXM7XG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgIC5jb250cm9sbGVyKCdJbWdSYWRpb0NvbnRyb2xsZXInLCBJbWdSYWRpb0NvbnRyb2xsZXIpO1xuXG4gIEltZ1JhZGlvQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gSW1nUmFkaW9Db250cm9sbGVyKCRzY29wZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY2hvaWNlID0gbnVsbDtcbiAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XG5cblxuICAgIGZ1bmN0aW9uIHNldENob2ljZShhdHRyaWJ1dGVDaG9pY2VkKSB7XG4gICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gYXR0cmlidXRlQ2hvaWNlZDtcbiAgICB9XG5cbiAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAuY29udHJvbGxlcignSW5wdXRUZXh0Q29udHJvbGxlcicsIElucHV0VGV4dENvbnRyb2xsZXIpO1xuXG4gICAgSW5wdXRUZXh0Q29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIElucHV0VGV4dENvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XG4gICAgICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcblxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoKSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gdm0uY2hvaWNlO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJylcbiAgICAgICAgLmZhY3RvcnkoJ2RhdGFzZXJ2aWNlJywgZGF0YXNlcnZpY2UpO1xuXG4gICAgZGF0YXNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCAnJHEnLCAnZXhjZXB0aW9uJywgJ2xvZ2dlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGRhdGFzZXJ2aWNlKCRodHRwLCAkcSwgZXhjZXB0aW9uLCBsb2dnZXIpIHtcbiAgICAgICAgdmFyIGpzb25VUkwgPSAnL3Jlc3NvdXJjZXMvcHJvZHVjdHMuanNvbic7XG4gICAgICAgIHZhciBwcm9taXNlID0gJGh0dHAuZ2V0KGpzb25VUkwpO1xuICAgICAgICB2YXIgZGF0YSA9IG51bGw7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgIHJlYWR5OiByZWFkeSxcbiAgICAgICAgICBnZXRQcm9kdWN0czogZ2V0UHJvZHVjdHNcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICBmdW5jdGlvbiBnZXRQcm9kdWN0cygpIHtcbiAgICAgICAgICByZXR1cm4gZGF0YS5wcm9kdWN0cztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlYWR5KCkge1xuICAgICAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICBkYXRhID0gcmVzdWx0LmRhdGE7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignSW1wb3NzaWJsZSBkZSByw6ljdXDDqXJlciBsZXMgZG9ubsOpZXMnKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicsIFsnYmxvY2tzLmxvZ2dlciddKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInLCBbXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdibG9ja3Mucm91dGVyJywgW1xuICAgICAgICAndWkucm91dGVyJyxcbiAgICAgICAgJ2Jsb2Nrcy5sb2dnZXInXG4gICAgXSk7XG59KSgpO1xuIiwiLy8gSW5jbHVkZSBpbiBpbmRleC5odG1sIHNvIHRoYXQgYXBwIGxldmVsIGV4Y2VwdGlvbnMgYXJlIGhhbmRsZWQuXG4vLyBFeGNsdWRlIGZyb20gdGVzdFJ1bm5lci5odG1sIHdoaWNoIHNob3VsZCBydW4gZXhhY3RseSB3aGF0IGl0IHdhbnRzIHRvIHJ1blxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicpXG4gICAgICAgIC5wcm92aWRlcignZXhjZXB0aW9uSGFuZGxlcicsIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcilcbiAgICAgICAgLmNvbmZpZyhjb25maWcpO1xuXG4gICAgLyoqXG4gICAgICogTXVzdCBjb25maWd1cmUgdGhlIGV4Y2VwdGlvbiBoYW5kbGluZ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcigpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgICAgICAgYXBwRXJyb3JQcmVmaXg6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuY29uZmlndXJlID0gZnVuY3Rpb24gKGFwcEVycm9yUHJlZml4KSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5hcHBFcnJvclByZWZpeCA9IGFwcEVycm9yUHJlZml4O1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuJGdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtjb25maWc6IHRoaXMuY29uZmlnfTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25maWcuJGluamVjdCA9IFsnJHByb3ZpZGUnXTtcblxuICAgIC8qKlxuICAgICAqIENvbmZpZ3VyZSBieSBzZXR0aW5nIGFuIG9wdGlvbmFsIHN0cmluZyB2YWx1ZSBmb3IgYXBwRXJyb3JQcmVmaXguXG4gICAgICogQWNjZXNzaWJsZSB2aWEgY29uZmlnLmFwcEVycm9yUHJlZml4ICh2aWEgY29uZmlnIHZhbHVlKS5cbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9ICRwcm92aWRlXG4gICAgICovXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gY29uZmlnKCRwcm92aWRlKSB7XG4gICAgICAgICRwcm92aWRlLmRlY29yYXRvcignJGV4Y2VwdGlvbkhhbmRsZXInLCBleHRlbmRFeGNlcHRpb25IYW5kbGVyKTtcbiAgICB9XG5cbiAgICBleHRlbmRFeGNlcHRpb25IYW5kbGVyLiRpbmplY3QgPSBbJyRkZWxlZ2F0ZScsICdleGNlcHRpb25IYW5kbGVyJywgJ2xvZ2dlciddO1xuXG4gICAgLyoqXG4gICAgICogRXh0ZW5kIHRoZSAkZXhjZXB0aW9uSGFuZGxlciBzZXJ2aWNlIHRvIGFsc28gZGlzcGxheSBhIHRvYXN0LlxuICAgICAqIEBwYXJhbSAge09iamVjdH0gJGRlbGVnYXRlXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBleGNlcHRpb25IYW5kbGVyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBsb2dnZXJcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gdGhlIGRlY29yYXRlZCAkZXhjZXB0aW9uSGFuZGxlciBzZXJ2aWNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXh0ZW5kRXhjZXB0aW9uSGFuZGxlcigkZGVsZWdhdGUsIGV4Y2VwdGlvbkhhbmRsZXIsIGxvZ2dlcikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZXhjZXB0aW9uLCBjYXVzZSkge1xuICAgICAgICAgICAgdmFyIGFwcEVycm9yUHJlZml4ID0gZXhjZXB0aW9uSGFuZGxlci5jb25maWcuYXBwRXJyb3JQcmVmaXggfHwgJyc7XG4gICAgICAgICAgICB2YXIgZXJyb3JEYXRhID0ge2V4Y2VwdGlvbjogZXhjZXB0aW9uLCBjYXVzZTogY2F1c2V9O1xuICAgICAgICAgICAgZXhjZXB0aW9uLm1lc3NhZ2UgPSBhcHBFcnJvclByZWZpeCArIGV4Y2VwdGlvbi5tZXNzYWdlO1xuICAgICAgICAgICAgJGRlbGVnYXRlKGV4Y2VwdGlvbiwgY2F1c2UpO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb3VsZCBhZGQgdGhlIGVycm9yIHRvIGEgc2VydmljZSdzIGNvbGxlY3Rpb24sXG4gICAgICAgICAgICAgKiBhZGQgZXJyb3JzIHRvICRyb290U2NvcGUsIGxvZyBlcnJvcnMgdG8gcmVtb3RlIHdlYiBzZXJ2ZXIsXG4gICAgICAgICAgICAgKiBvciBsb2cgbG9jYWxseS4gT3IgdGhyb3cgaGFyZC4gSXQgaXMgZW50aXJlbHkgdXAgdG8geW91LlxuICAgICAgICAgICAgICogdGhyb3cgZXhjZXB0aW9uO1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAgICAgKiAgICAgdGhyb3cgeyBtZXNzYWdlOiAnZXJyb3IgbWVzc2FnZSB3ZSBhZGRlZCcgfTtcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGV4Y2VwdGlvbi5tZXNzYWdlLCBlcnJvckRhdGEpO1xuICAgICAgICB9O1xuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJylcbiAgICAgICAgLmZhY3RvcnkoJ2V4Y2VwdGlvbicsIGV4Y2VwdGlvbik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBleGNlcHRpb24oJHEsIGxvZ2dlcikge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGNhdGNoZXI6IGNhdGNoZXJcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgZnVuY3Rpb24gY2F0Y2hlcihtZXNzYWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIHZhciB0aHJvd25EZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICB2YXIgbmV3TWVzc2FnZTtcbiAgICAgICAgICAgICAgICBpZiAoZS5kYXRhICYmIGUuZGF0YS5kZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB0aHJvd25EZXNjcmlwdGlvbiA9ICdcXG4nICsgZS5kYXRhLmRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgICAgICBuZXdNZXNzYWdlID0gbWVzc2FnZSArIHRocm93bkRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlLmRhdGEuZGVzY3JpcHRpb24gPSBuZXdNZXNzYWdlO1xuICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuZXdNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KGUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3MubG9nZ2VyJylcbiAgICAgICAgLmZhY3RvcnkoJ2xvZ2dlcicsIGxvZ2dlcik7XG5cbiAgICBsb2dnZXIuJGluamVjdCA9IFsnJGxvZyddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gbG9nZ2VyKCRsb2csIHRvYXN0cikge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGVycm9yICAgOiBlcnJvcixcbiAgICAgICAgICAgIGluZm8gICAgOiBpbmZvLFxuICAgICAgICAgICAgc3VjY2VzcyA6IHN1Y2Nlc3MsXG4gICAgICAgICAgICB3YXJuaW5nIDogd2FybmluZyxcblxuICAgICAgICAgICAgLy8gc3RyYWlnaHQgdG8gY29uc29sZTsgYnlwYXNzIHRvYXN0clxuICAgICAgICAgICAgbG9nICAgICA6ICRsb2cubG9nXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuZXJyb3IoJ0Vycm9yOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbmZvKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmluZm8obWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5pbmZvKCdJbmZvOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLmluZm8oJ1N1Y2Nlc3M6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLndhcm4oJ1dhcm5pbmc6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cbn0oKSk7XG4iLCIvKiBIZWxwIGNvbmZpZ3VyZSB0aGUgc3RhdGUtYmFzZSB1aS5yb3V0ZXIgKi9cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5yb3V0ZXInKVxuICAgICAgICAucHJvdmlkZXIoJ3JvdXRlckhlbHBlcicsIHJvdXRlckhlbHBlclByb3ZpZGVyKTtcblxuICAgIHJvdXRlckhlbHBlclByb3ZpZGVyLiRpbmplY3QgPSBbJyRsb2NhdGlvblByb3ZpZGVyJywgJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIHJvdXRlckhlbHBlclByb3ZpZGVyKCRsb2NhdGlvblByb3ZpZGVyLCAkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgZG9jVGl0bGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHJlc29sdmVBbHdheXM6IHt9XG4gICAgICAgIH07XG5cbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHtcbiAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgICAgICByZXF1aXJlQmFzZTogZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jb25maWd1cmUgPSBmdW5jdGlvbihjZmcpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGNvbmZpZywgY2ZnKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLiRnZXQgPSBSb3V0ZXJIZWxwZXI7XG4gICAgICAgIFJvdXRlckhlbHBlci4kaW5qZWN0ID0gWyckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsICckc3RhdGUnLCAnbG9nZ2VyJ107XG4gICAgICAgIC8qIEBuZ0luamVjdCAqL1xuICAgICAgICBmdW5jdGlvbiBSb3V0ZXJIZWxwZXIoJGxvY2F0aW9uLCAkcm9vdFNjb3BlLCAkc3RhdGUsIGxvZ2dlcikge1xuICAgICAgICAgICAgdmFyIGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGhhc090aGVyd2lzZSA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIHN0YXRlQ291bnRzID0ge1xuICAgICAgICAgICAgICAgIGVycm9yczogMCxcbiAgICAgICAgICAgICAgICBjaGFuZ2VzOiAwXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgICAgICBjb25maWd1cmVTdGF0ZXM6IGNvbmZpZ3VyZVN0YXRlcyxcbiAgICAgICAgICAgICAgICBnZXRTdGF0ZXM6IGdldFN0YXRlcyxcbiAgICAgICAgICAgICAgICBzdGF0ZUNvdW50czogc3RhdGVDb3VudHNcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGluaXQoKTtcblxuICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBjb25maWd1cmVTdGF0ZXMoc3RhdGVzLCBvdGhlcndpc2VQYXRoKSB7XG4gICAgICAgICAgICAgICAgc3RhdGVzLmZvckVhY2goZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuY29uZmlnLnJlc29sdmUgPVxuICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoc3RhdGUuY29uZmlnLnJlc29sdmUgfHwge30sIGNvbmZpZy5yZXNvbHZlQWx3YXlzKTtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoc3RhdGUuc3RhdGUsIHN0YXRlLmNvbmZpZyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKG90aGVyd2lzZVBhdGggJiYgIWhhc090aGVyd2lzZSkge1xuICAgICAgICAgICAgICAgICAgICBoYXNPdGhlcndpc2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKG90aGVyd2lzZVBhdGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlUm91dGluZ0Vycm9ycygpIHtcbiAgICAgICAgICAgICAgICAvLyBSb3V0ZSBjYW5jZWxsYXRpb246XG4gICAgICAgICAgICAgICAgLy8gT24gcm91dGluZyBlcnJvciwgZ28gdG8gdGhlIGRhc2hib2FyZC5cbiAgICAgICAgICAgICAgICAvLyBQcm92aWRlIGFuIGV4aXQgY2xhdXNlIGlmIGl0IHRyaWVzIHRvIGRvIGl0IHR3aWNlLlxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRzLmVycm9ycysrO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZXN0aW5hdGlvbiA9ICh0b1N0YXRlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRvU3RhdGUudGl0bGUgfHwgdG9TdGF0ZS5uYW1lIHx8IHRvU3RhdGUubG9hZGVkVGVtcGxhdGVVcmwpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd1bmtub3duIHRhcmdldCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbXNnID0gJ0Vycm9yIHJvdXRpbmcgdG8gJyArIGRlc3RpbmF0aW9uICsgJy4gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGVycm9yLmRhdGEgfHwgJycpICsgJy4gPGJyLz4nICsgKGVycm9yLnN0YXR1c1RleHQgfHwgJycpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnOiAnICsgKGVycm9yLnN0YXR1cyB8fCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyhtc2csIFt0b1N0YXRlXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVSb3V0aW5nRXJyb3JzKCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlRG9jVGl0bGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkgeyByZXR1cm4gJHN0YXRlLmdldCgpOyB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHVwZGF0ZURvY1RpdGxlKCkge1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRzLmNoYW5nZXMrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gY29uZmlnLmRvY1RpdGxlICsgJyAnICsgKHRvU3RhdGUudGl0bGUgfHwgJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50aXRsZSA9IHRpdGxlOyAvLyBkYXRhIGJpbmQgdG8gPHRpdGxlPlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJywgWydhcHAuY29yZSddKTtcblxufSkgKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAubGFiLnByb2R1Y3RzJywgWydhcHAuY29yZSddKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuaG9tZXBhZ2UnLCBbXG4gICAgJ2FwcC5jb3JlJ1xuICBdKTtcblxufSkgKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAubGFiJywgW1xuICAgICdhcHAuY29yZScsXG4gICAgJ2FwcC5sYWIucHJvZHVjdHMnLFxuICAgICdhcHAubGFiLmF0dHJpYnV0ZXMnXG4gIF0pO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAubGF5b3V0JywgW1xuICAgICAgJ2FwcC5jb3JlJ1xuICAgIF0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmhvbWVwYWdlJykuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBIb21lQ29udHJvbGxlcik7XG5cbiAgZnVuY3Rpb24gSG9tZUNvbnRyb2xsZXIoKcKge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0udGl0bGUgPSAnSG9tZXBhZ2UnO1xuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmhvbWVwYWdlJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnaG9tZXBhZ2UnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvaG9tZXBhZ2UvaG9tZXBhZ2Uudmlldy5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnaG9tZScsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5J1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYicpXG4gICAgICAgIC5jb250cm9sbGVyKCdMYWJDb250cm9sbGVyJywgTGFiQ29udHJvbGxlcik7XG5cbiAgICBMYWJDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gTGFiQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlcyA9IHt9O1xuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWInKVxuICAgICAgICAucnVuKGFwcFJ1bik7XG5cbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsYWInLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvbGFiJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL2xhYi52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTGFiQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2xhYlZtJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBMYWInXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYXlvdXQnKVxuICAgICAgICAgIC5jb250cm9sbGVyKCdIZWFkZXJDb250cm9sbGVyJywgSGVhZGVyQ29udHJvbGxlcik7XG5cbiAgICBIZWFkZXJDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gSGVhZGVyQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0F0dHJpYnV0ZXNDb250cm9sbGVyJywgQXR0cmlidXRlc0NvbnRyb2xsZXIpO1xuXG4gICAgQXR0cmlidXRlc0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJywgJyRzdGF0ZSddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEF0dHJpYnV0ZXNDb250cm9sbGVyKCRzY29wZSwgJHN0YXRlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmdldEZvcm0gPSBnZXRGb3JtO1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiAkc2NvcGUubGFiVm0uY2hvaWNlcy5wcm9kdWN0ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2xhYi5wcm9kdWN0cycpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZtLmF0dHJpYnV0ZXMgPSAkc2NvcGUubGFiVm0uY2hvaWNlcy5wcm9kdWN0LmF0dHJpYnV0ZXM7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRGb3JtKGF0dHJpYnV0ZSkge1xuICAgICAgICAgIHJldHVybiBcImFwcC9sYWIvYXR0cmlidXRlcy9mb3Jtcy9cIiArIGF0dHJpYnV0ZS5mb3JtICsgXCIvXCIgKyAgYXR0cmlidXRlLmZvcm0gKyBcIi52aWV3Lmh0bWxcIjtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcblxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xhYi5hdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2F0dHJpYnV0ZXMnLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSAtIGF0dHJpYnV0ZXMnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQXR0cmlidXRlc0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdhdHRyaWJ1dGVzVm0nLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9sYWIvYXR0cmlidXRlcy9hdHRyaWJ1dGVzLnZpZXcuaHRtbCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnKVxuICAgICAgICAuY29udHJvbGxlcignUHJvZHVjdHNDb250cm9sbGVyJywgUHJvZHVjdHNDb250cm9sbGVyKTtcblxuICAgIFByb2R1Y3RzQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHN0YXRlJywgJ2RhdGFzZXJ2aWNlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBQcm9kdWN0c0NvbnRyb2xsZXIoJHNjb3BlLCAkc3RhdGUsIGRhdGFzZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0uc2VsZWN0ID0gc2VsZWN0O1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgZGF0YXNlcnZpY2UucmVhZHkoKS50aGVuKGdldFByb2R1Y3RzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2R1Y3RzKCkge1xuICAgICAgICAgIHZtLnByb2R1Y3RzID0gZGF0YXNlcnZpY2UuZ2V0UHJvZHVjdHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdChwcm9kdWN0KSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXMucHJvZHVjdCA9IHByb2R1Y3Q7XG4gICAgICAgICAgJHN0YXRlLmdvKCdsYWIuYXR0cmlidXRlcycpO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5wcm9kdWN0cycpXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcblxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xhYi5wcm9kdWN0cycsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9wcm9kdWN0cycsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5IC0gcHJvZHVjdHMnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnUHJvZHVjdHNDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAncHJvZHVjdHNWbScsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2xhYi9wcm9kdWN0cy9wcm9kdWN0cy52aWV3Lmh0bWwnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAuY29udHJvbGxlcignQnRuUmFkaW9Db250cm9sbGVyJywgQnRuUmFkaW9Db250cm9sbGVyKTtcblxuICAgIEJ0blJhZGlvQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEJ0blJhZGlvQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xuXG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcbiAgICAgICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IGF0dHJpYnV0ZUNob2ljZWQ7XG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdDaGVja2JveENvbnRyb2xsZXInLCBDaGVja2JveENvbnRyb2xsZXIpO1xuXG4gICAgQ2hlY2tib3hDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gQ2hlY2tib3hDb250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5jaG9pY2VzID0gW107XG4gICAgICAgIHZtLmV4aXN0cyA9IGV4aXN0cztcbiAgICAgICAgdm0udG9nZ2xlID0gdG9nZ2xlO1xuICAgICAgICB2bS5zYXZlQ2hvaWNlcyA9IHNhdmVDaG9pY2VzO1xuXG4gICAgICAgIGZ1bmN0aW9uIGV4aXN0cyh2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiB2bS5jaG9pY2VzLmluZGV4T2YodmFsdWUpID4gLTE7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB0b2dnbGUodmFsdWUpIHtcbiAgICAgICAgICB2YXIgaWR4ID0gdm0uY2hvaWNlcy5pbmRleE9mKHZhbHVlKTtcbiAgICAgICAgICBpZiAoaWR4ID4gLTEpIHtcbiAgICAgICAgICAgIHZtLmNob2ljZXMuc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZtLmNob2ljZXMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVDaG9pY2VzKCkge1xuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IHZtLmNob2ljZXM7XG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAuY29udHJvbGxlcignSW1nUmFkaW9Db250cm9sbGVyJywgSW1nUmFkaW9Db250cm9sbGVyKTtcblxuICBJbWdSYWRpb0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIEltZ1JhZGlvQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNob2ljZSA9IG51bGw7XG4gICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xuXG5cbiAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xuICAgICAgdm0uY2hvaWNlID0gYXR0cmlidXRlQ2hvaWNlZDtcbiAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IGF0dHJpYnV0ZUNob2ljZWQ7XG4gICAgfVxuXG4gIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdJbnB1dFRleHRDb250cm9sbGVyJywgSW5wdXRUZXh0Q29udHJvbGxlcik7XG5cbiAgICBJbnB1dFRleHRDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gSW5wdXRUZXh0Q29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xuXG4gICAgICAgIGZ1bmN0aW9uIHNldENob2ljZSgpIHtcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB2bS5jaG9pY2U7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
