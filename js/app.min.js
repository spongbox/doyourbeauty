!function(){"use strict";angular.module("app",["app.core","app.lab","app.homepage","app.layout"])}(),function(){"use strict";angular.module("app.core",["ngAnimate","ngSanitize","blocks.exception","blocks.logger","blocks.router","ui.router","ngMaterial"])}(),function(){"use strict";function t(t,e,r){t.debugEnabled&&t.debugEnabled(!0),r.configure(o.appErrorPrefix),e.configure({docTitle:o.appTitle+": "})}var e=angular.module("app.core"),o={appErrorPrefix:"[<%= appName %> Error] ",appTitle:"<%= appName %>"};e.value("config",o),e.config(t),t.$inject=["$logProvider","routerHelperProvider","exceptionHandlerProvider"]}(),function(){"use strict";function t(t){var o="/404";t.configureStates(e(),o)}function e(){return[{state:"404",config:{url:"/404",templateUrl:"app/core/404.html",title:"404"}}]}t.$inject=["routerHelper"],angular.module("app.core").run(t)}(),function(){"use strict";function t(t,e,o,r){function n(){return a.products}function c(){return u.then(function(t){return a=t.data,!0},function(){return r.error("Impossible de récupérer les données"),!1})}var i="/ressources/products.json",u=t.get(i),a=null,l={ready:c,getProducts:n};return l}angular.module("app.core").factory("dataservice",t),t.$inject=["$http","$q","exception","logger"]}(),function(){"use strict";angular.module("blocks.exception",["blocks.logger"])}(),function(){"use strict";angular.module("blocks.logger",[])}(),function(){"use strict";angular.module("blocks.router",["ui.router","blocks.logger"])}(),function(){"use strict";function t(){this.config={appErrorPrefix:void 0},this.configure=function(t){this.config.appErrorPrefix=t},this.$get=function(){return{config:this.config}}}function e(t){t.decorator("$exceptionHandler",o)}function o(t,e,o){return function(r,n){var c=e.config.appErrorPrefix||"",i={exception:r,cause:n};r.message=c+r.message,t(r,n),o.error(r.message,i)}}angular.module("blocks.exception").provider("exceptionHandler",t).config(e),e.$inject=["$provide"],o.$inject=["$delegate","exceptionHandler","logger"]}(),function(){"use strict";function t(t,e){function o(o){return function(r){var n,c;return r.data&&r.data.description&&(n="\n"+r.data.description,c=o+n),r.data.description=c,e.error(c),t.reject(r)}}var r={catcher:o};return r}t.$inject=["$q","logger"],angular.module("blocks.exception").factory("exception",t)}(),function(){"use strict";function t(t,e){function o(e,o,r){console.error(e,r),t.error("Error: "+e,o)}function r(e,o,r){console.info(e,r),t.info("Info: "+e,o)}function n(e,o,r){console.log(e,r),t.info("Success: "+e,o)}function c(e,o,r){console.warn(e,r),t.warn("Warning: "+e,o)}var i={error:o,info:r,success:n,warning:c,log:t.log};return i}angular.module("blocks.logger").factory("logger",t),t.$inject=["$log"]}(),function(){"use strict";function t(t,e,o){function r(t,r,c,i){function u(t,r){t.forEach(function(t){t.config.resolve=angular.extend(t.config.resolve||{},n.resolveAlways),e.state(t.state,t.config)}),r&&!g&&(g=!0,o.otherwise(r))}function a(){r.$on("$stateChangeError",function(e,o,r,n,c,u){if(!f){d.errors++,f=!0;var a=o&&(o.title||o.name||o.loadedTemplateUrl)||"unknown target",l="Error routing to "+a+". "+(u.data||"")+". <br/>"+(u.statusText||"")+": "+(u.status||"");i.warning(l,[o]),t.path("/")}})}function l(){a(),p()}function s(){return c.get()}function p(){r.$on("$stateChangeSuccess",function(t,e,o,c,i){d.changes++,f=!1;var u=n.docTitle+" "+(e.title||"");r.title=u})}var f=!1,g=!1,d={errors:0,changes:0},m={configureStates:u,getStates:s,stateCounts:d};return l(),m}var n={docTitle:void 0,resolveAlways:{}};t.html5Mode({enabled:!1,requireBase:!1}),this.configure=function(t){angular.extend(n,t)},this.$get=r,r.$inject=["$location","$rootScope","$state","logger"]}angular.module("blocks.router").provider("routerHelper",t),t.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}(),function(){"use strict";angular.module("app.lab.attributes",["app.core"])}(),function(){angular.module("app.lab.products",["app.core"])}(),function(){"use strict";angular.module("app.homepage",["app.core"])}(),function(){angular.module("app.lab",["app.core","app.lab.products","app.lab.attributes"])}(),function(){"use strict";angular.module("app.layout",["app.core"])}(),function(){"use strict";function t(){var t=this;t.title="Homepage"}angular.module("app.homepage").controller("HomeController",t)}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"homepage",config:{url:"/",templateUrl:"app/homepage/homepage.view.html",controller:"HomeController",controllerAs:"home",title:"DoYourBeauty"}}]}angular.module("app.homepage").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){var e=this;e.choices={}}angular.module("app.lab").controller("LabController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab",config:{url:"/lab",templateUrl:"app/lab/lab.view.html",controller:"LabController",controllerAs:"labVm",title:"DoYourBeauty - Lab"}}]}angular.module("app.lab").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){}angular.module("app.layout").controller("HeaderController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t,e){function o(){return"undefined"==typeof t.labVm.choices.product?void e.go("lab.products"):void(c.attributes=t.labVm.choices.product.attributes)}function r(t){return"app/lab/attributes/forms/"+t.form+"/"+t.form+".view.html"}function n(e){return"undefined"!=typeof t.labVm.choices[e.name]}var c=this;c.getForm=r,c.choiceValidate=n,o()}angular.module("app.lab.attributes").controller("AttributesController",t),t.$inject=["$scope","$state"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab.attributes",config:{url:"/attributes",title:"DoYourBeauty - attributes",controller:"AttributesController",controllerAs:"attributesVm",templateUrl:"app/lab/attributes/attributes.view.html"}}]}angular.module("app.lab.attributes").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e,o){function r(){o.ready().then(n)}function n(){i.products=o.getProducts()}function c(e){t.labVm.choices.product=e}var i=this;i.select=c,r()}angular.module("app.lab.products").controller("ProductsController",t),t.$inject=["$scope","$state","dataservice"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab.products",config:{url:"/products",title:"DoYourBeauty - products",controller:"ProductsController",controllerAs:"productsVm",templateUrl:"app/lab/products/products.view.html"}}]}angular.module("app.lab.products").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){function e(e){o.choice=e,t.labVm.choices[o.attribute.name]=e}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("BtnRadioController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(t){return n.choices.indexOf(t)>-1}function o(t){var e=n.choices.indexOf(t);e>-1?n.choices.splice(e,1):n.choices.push(t)}function r(){t.labVm.choices[n.attribute.name]=n.choices}var n=this;n.choices=[],n.exists=e,n.toggle=o,n.saveChoices=r}angular.module("app.lab.attributes").controller("CheckboxController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(t){n.choice&&(document.getElementById("form-color-"+n.choice).style.opacity=1,n.percent=100),n.choice=t}function o(){t.labVm.choices[n.attribute.name]={value:n.choice,percent:n.percent}}function r(){document.getElementById("form-color-"+n.choice).style.opacity=n.percent/100}var n=this,n=this;n.choice=null,n.setChoice=e,n.setOpacity=r,n.saveChoice=o,n.percent=100}angular.module("app.lab.attributes").controller("ColorController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(e){o.choice=e,t.labVm.choices[o.attribute.name]=e}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("ImgRadioController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(){""!==o.choice&&null!==o.choice?t.labVm.choices[o.attribute.name]=o.choice:delete t.labVm.choices[o.attribute.name]}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("InputTextController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(t){r.choice&&(r.percent=100),r.choice=t}function o(){t.labVm.choices[r.attribute.name]={value:r.choice,percent:r.percent}}var r=this,r=this;r.choice=null,r.setChoice=e,r.saveChoice=o,r.percent=100}angular.module("app.lab.attributes").controller("RadioSliderController",t),t.$inject=["$scope"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjb3JlLm1vZHVsZS5qcyIsImNvbmZpZy5qcyIsImNvcmUucm91dGUuanMiLCJhcHAubWluLmpzIiwiZGF0YXNlcnZpY2UuanMiLCJleGNlcHRpb24vZXhjZXB0aW9uLm1vZHVsZS5qcyIsImxvZ2dlci9sb2dnZXIubW9kdWxlLmpzIiwicm91dGVyL3JvdXRlci5tb2R1bGUuanMiLCJleGNlcHRpb24vZXhjZXB0aW9uLWhhbmRsZXIucHJvdmlkZXIuanMiLCJleGNlcHRpb24vZXhjZXB0aW9uLmpzIiwibG9nZ2VyL2xvZ2dlci5qcyIsInJvdXRlci9yb3V0ZXItaGVscGVyLnByb3ZpZGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy5tb2R1bGUuanMiLCJsYWIvcHJvZHVjdHMvcHJvZHVjdHMubW9kdWxlLmpzIiwiaG9tZXBhZ2UvaG9tZXBhZ2UubW9kdWxlLmpzIiwibGFiL2xhYi5tb2R1bGUuanMiLCJsYXlvdXQvbGF5b3V0Lm1vZHVsZS5qcyIsImhvbWVwYWdlL2hvbWVwYWdlLmNvbnRyb2xsZXIuanMiLCJob21lcGFnZS9ob21lcGFnZS5yb3V0ZS5qcyIsImxhYi9sYWIuY29udHJvbGxlci5qcyIsImxhYi9sYWIucm91dGUuanMiLCJsYXlvdXQvaGVhZGVyLmNvbnRyb2xsZXIuanMiLCJsYWIvYXR0cmlidXRlcy9hdHRyaWJ1dGVzLmNvbnRyb2xsZXIuanMiLCJsYWIvYXR0cmlidXRlcy9hdHRyaWJ1dGVzLnJvdXRlLmpzIiwibGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLmNvbnRyb2xsZXIuanMiLCJsYWIvcHJvZHVjdHMvcHJvZHVjdHMucm91dGUuanMiLCJsYWIvYXR0cmlidXRlcy9mb3Jtcy9idG4tcmFkaW8vYnRuLXJhZGlvLmNvbnRyb2xsZXIuanMiLCJsYWIvYXR0cmlidXRlcy9mb3Jtcy9jaGVja2JveC9jaGVja2JveC5jb250cm9sbGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvZm9ybXMvY29sb3IvY29sb3IuY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2Zvcm1zL2ltZy1yYWRpby9pbWctcmFkaW8uY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2Zvcm1zL2lucHV0LXRleHQvaW5wdXQtdGV4dC5jb250cm9sbGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvZm9ybXMvcmFkaW8tc2xpZGVyL3JhZGlvLXNsaWRlci5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWd1cmUiLCIkbG9nUHJvdmlkZXIiLCJyb3V0ZXJIZWxwZXJQcm92aWRlciIsImV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlciIsImRlYnVnRW5hYmxlZCIsImNvbmZpZyIsImFwcEVycm9yUHJlZml4IiwiZG9jVGl0bGUiLCJhcHBUaXRsZSIsImNvcmUiLCJ2YWx1ZSIsIiRpbmplY3QiLCJhcHBSdW4iLCJyb3V0ZXJIZWxwZXIiLCJvdGhlcndpc2UiLCJjb25maWd1cmVTdGF0ZXMiLCJnZXRTdGF0ZXMiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwidGl0bGUiLCJydW4iLCJkYXRhc2VydmljZSIsIiRodHRwIiwiJHEiLCJleGNlcHRpb24iLCJsb2dnZXIiLCJnZXRQcm9kdWN0cyIsImRhdGEiLCJwcm9kdWN0cyIsInJlYWR5IiwicHJvbWlzZSIsInRoZW4iLCJyZXN1bHQiLCJlcnJvciIsImpzb25VUkwiLCJnZXQiLCJzZXJ2aWNlIiwiZmFjdG9yeSIsInRoaXMiLCJ1bmRlZmluZWQiLCIkZ2V0IiwiJHByb3ZpZGUiLCJkZWNvcmF0b3IiLCJleHRlbmRFeGNlcHRpb25IYW5kbGVyIiwiJGRlbGVnYXRlIiwiZXhjZXB0aW9uSGFuZGxlciIsImNhdXNlIiwiZXJyb3JEYXRhIiwibWVzc2FnZSIsInByb3ZpZGVyIiwiY2F0Y2hlciIsImUiLCJ0aHJvd25EZXNjcmlwdGlvbiIsIm5ld01lc3NhZ2UiLCJkZXNjcmlwdGlvbiIsInJlamVjdCIsIiRsb2ciLCJ0b2FzdHIiLCJjb25zb2xlIiwiaW5mbyIsInN1Y2Nlc3MiLCJsb2ciLCJ3YXJuaW5nIiwid2FybiIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJSb3V0ZXJIZWxwZXIiLCIkbG9jYXRpb24iLCIkcm9vdFNjb3BlIiwiJHN0YXRlIiwic3RhdGVzIiwib3RoZXJ3aXNlUGF0aCIsImZvckVhY2giLCJyZXNvbHZlIiwiZXh0ZW5kIiwicmVzb2x2ZUFsd2F5cyIsImhhc090aGVyd2lzZSIsImhhbmRsZVJvdXRpbmdFcnJvcnMiLCIkb24iLCJldmVudCIsInRvU3RhdGUiLCJ0b1BhcmFtcyIsImZyb21TdGF0ZSIsImZyb21QYXJhbXMiLCJoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IiLCJzdGF0ZUNvdW50cyIsImVycm9ycyIsImRlc3RpbmF0aW9uIiwibmFtZSIsImxvYWRlZFRlbXBsYXRlVXJsIiwibXNnIiwic3RhdHVzVGV4dCIsInN0YXR1cyIsInBhdGgiLCJpbml0IiwidXBkYXRlRG9jVGl0bGUiLCJjaGFuZ2VzIiwiaHRtbDVNb2RlIiwiZW5hYmxlZCIsInJlcXVpcmVCYXNlIiwiY2ZnIiwiSG9tZUNvbnRyb2xsZXIiLCJ2bSIsImNvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJMYWJDb250cm9sbGVyIiwiJHNjb3BlIiwiY2hvaWNlcyIsIkhlYWRlckNvbnRyb2xsZXIiLCJBdHRyaWJ1dGVzQ29udHJvbGxlciIsImFjdGl2YXRlIiwibGFiVm0iLCJwcm9kdWN0IiwiZ28iLCJhdHRyaWJ1dGVzIiwiZ2V0Rm9ybSIsImF0dHJpYnV0ZSIsImZvcm0iLCJjaG9pY2VWYWxpZGF0ZSIsIlByb2R1Y3RzQ29udHJvbGxlciIsInNlbGVjdCIsIkJ0blJhZGlvQ29udHJvbGxlciIsInNldENob2ljZSIsImF0dHJpYnV0ZUNob2ljZWQiLCJjaG9pY2UiLCJDaGVja2JveENvbnRyb2xsZXIiLCJleGlzdHMiLCJpbmRleE9mIiwidG9nZ2xlIiwiaWR4Iiwic3BsaWNlIiwicHVzaCIsInNhdmVDaG9pY2VzIiwiQ29sb3JDb250cm9sbGVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwib3BhY2l0eSIsInBlcmNlbnQiLCJzYXZlQ2hvaWNlIiwic2V0T3BhY2l0eSIsIkltZ1JhZGlvQ29udHJvbGxlciIsIklucHV0VGV4dENvbnRyb2xsZXIiLCJSYWRpb1NsaWRlckNvbnRyb2xsZXIiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0EsWUFFQUEsU0FBQUMsT0FBQSxPQUNBLFdBQ0EsVUFDQSxlQUNBLGtCQ1BBLFdBQ0EsWUFFQUQsU0FDQUMsT0FBQSxZQUNBLFlBQUEsYUFDQSxtQkFBQSxnQkFBQSxnQkFDQSxZQUFBLGtCQ1BBLFdBQ0EsWUFjQSxTQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxHQUNBRixFQUFBRyxjQUNBSCxFQUFBRyxjQUFBLEdBRUFELEVBQUFILFVBQUFLLEVBQUFDLGdCQUNBSixFQUFBRixXQUFBTyxTQUFBRixFQUFBRyxTQUFBLE9BakJBLEdBQUFDLEdBQUFYLFFBQUFDLE9BQUEsWUFDQU0sR0FDQUMsZUFBQSwwQkFDQUUsU0FBQSxpQkFHQUMsR0FBQUMsTUFBQSxTQUFBTCxHQUVBSSxFQUFBSixPQUFBTCxHQUVBQSxFQUFBVyxTQUFBLGVBQUEsdUJBQUEsK0JDYkEsV0FDQSxZQU9BLFNBQUFDLEdBQUFDLEdBQ0EsR0FBQUMsR0FBQSxNQUNBRCxHQUFBRSxnQkFBQUMsSUFBQUYsR0FHQSxRQUFBRSxLQUNBLFFBRUFDLE1BQUEsTUFDQVosUUFDQWEsSUFBQSxPQUNBQyxZQUFBLG9CQUNBQyxNQUFBLFNDK0JJUixFQUFPRCxTQUFXLGdCRGhEdEJiLFFBQ0FDLE9BQUEsWUFDQXNCLElBQUFULE1FTEEsV0FDQSxZQVFBLFNBQUFVLEdBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBV0EsUUFBQUMsS0FDQSxNQUFBQyxHQUFBQyxTQUdBLFFBQUFDLEtBQ0EsTUFBQUMsR0FBQUMsS0FBQSxTQUFBQyxHQUVBLE1BREFMLEdBQUFLLEVBQUFMLE1BQ0EsR0FDQSxXQUVBLE1BREFGLEdBQUFRLE1BQUEsd0NBQ0EsSUFwQkEsR0FBQUMsR0FBQSw0QkFDQUosRUFBQVIsRUFBQWEsSUFBQUQsR0FDQVAsRUFBQSxLQUNBUyxHQUNBUCxNQUFBQSxFQUNBSCxZQUFBQSxFQUdBLE9BQUFVLEdBZkF2QyxRQUNBQyxPQUFBLFlBQ0F1QyxRQUFBLGNBQUFoQixHQUVBQSxFQUFBWCxTQUFBLFFBQUEsS0FBQSxZQUFBLGFDUEEsV0FDQSxZQUVBYixTQUFBQyxPQUFBLG9CQUFBLHFCQ0hBLFdBQ0EsWUFFQUQsU0FBQUMsT0FBQSx1QkNIQSxXQUNBLFlBRUFELFNBQUFDLE9BQUEsaUJBQ0EsWUFDQSxxQkNIQSxXQUNBLFlBVUEsU0FBQUksS0FFQW9DLEtBQUFsQyxRQUNBQyxlQUFBa0MsUUFHQUQsS0FBQXZDLFVBQUEsU0FBQU0sR0FDQWlDLEtBQUFsQyxPQUFBQyxlQUFBQSxHQUdBaUMsS0FBQUUsS0FBQSxXQUNBLE9BQUFwQyxPQUFBa0MsS0FBQWxDLFNBWUEsUUFBQUEsR0FBQXFDLEdBQ0FBLEVBQUFDLFVBQUEsb0JBQUFDLEdBWUEsUUFBQUEsR0FBQUMsRUFBQUMsRUFBQXBCLEdBQ0EsTUFBQSxVQUFBRCxFQUFBc0IsR0FDQSxHQUFBekMsR0FBQXdDLEVBQUF6QyxPQUFBQyxnQkFBQSxHQUNBMEMsR0FBQXZCLFVBQUFBLEVBQUFzQixNQUFBQSxFQUNBdEIsR0FBQXdCLFFBQUEzQyxFQUFBbUIsRUFBQXdCLFFBQ0FKLEVBQUFwQixFQUFBc0IsR0FVQXJCLEVBQUFRLE1BQUFULEVBQUF3QixRQUFBRCxJQTNEQWxELFFBQ0FDLE9BQUEsb0JBQ0FtRCxTQUFBLG1CQUFBL0MsR0FDQUUsT0FBQUEsR0FvQkFBLEVBQUFNLFNBQUEsWUFZQWlDLEVBQUFqQyxTQUFBLFlBQUEsbUJBQUEsYUN4Q0EsV0FDQSxZQU9BLFNBQUFjLEdBQUFELEVBQUFFLEdBTUEsUUFBQXlCLEdBQUFGLEdBQ0EsTUFBQSxVQUFBRyxHQUNBLEdBQUFDLEdBQ0FDLENBT0EsT0FOQUYsR0FBQXhCLE1BQUF3QixFQUFBeEIsS0FBQTJCLGNBQ0FGLEVBQUEsS0FBQUQsRUFBQXhCLEtBQUEyQixZQUNBRCxFQUFBTCxFQUFBSSxHQUVBRCxFQUFBeEIsS0FBQTJCLFlBQUFELEVBQ0E1QixFQUFBUSxNQUFBb0IsR0FDQTlCLEVBQUFnQyxPQUFBSixJQWZBLEdBQUFmLElBQ0FjLFFBQUFBLEVBRUEsT0FBQWQsR05pTUlaLEVBQVVkLFNBQVcsS0FBTSxVTTFNL0JiLFFBQ0FDLE9BQUEsb0JBQ0F1QyxRQUFBLFlBQUFiLE1DTEEsV0FDQSxZQVNBLFNBQUFDLEdBQUErQixFQUFBQyxHQWNBLFFBQUF4QixHQUFBZSxFQUFBckIsRUFBQVIsR0FDQXVDLFFBQUF6QixNQUFBZSxFQUFBN0IsR0FDQXFDLEVBQUF2QixNQUFBLFVBQUFlLEVBQUFyQixHQUdBLFFBQUFnQyxHQUFBWCxFQUFBckIsRUFBQVIsR0FDQXVDLFFBQUFDLEtBQUFYLEVBQUE3QixHQUNBcUMsRUFBQUcsS0FBQSxTQUFBWCxFQUFBckIsR0FHQSxRQUFBaUMsR0FBQVosRUFBQXJCLEVBQUFSLEdBQ0F1QyxRQUFBRyxJQUFBYixFQUFBN0IsR0FDQXFDLEVBQUFHLEtBQUEsWUFBQVgsRUFBQXJCLEdBR0EsUUFBQW1DLEdBQUFkLEVBQUFyQixFQUFBUixHQUNBdUMsUUFBQUssS0FBQWYsRUFBQTdCLEdBQ0FxQyxFQUFBTyxLQUFBLFlBQUFmLEVBQUFyQixHQTlCQSxHQUFBUyxJQUNBSCxNQUFBQSxFQUNBMEIsS0FBQUEsRUFDQUMsUUFBQUEsRUFDQUUsUUFBQUEsRUFHQUQsSUFBQUwsRUFBQUssSUFHQSxPQUFBekIsR0FsQkF2QyxRQUNBQyxPQUFBLGlCQUNBdUMsUUFBQSxTQUFBWixHQUVBQSxFQUFBZixTQUFBLFdDTkEsV0FDQSxZQVFBLFNBQUFULEdBQUErRCxFQUFBQyxFQUFBQyxHQW1CQSxRQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxFQUFBN0MsR0FvQkEsUUFBQVgsR0FBQXlELEVBQUFDLEdBQ0FELEVBQUFFLFFBQUEsU0FBQXpELEdBQ0FBLEVBQUFaLE9BQUFzRSxRQUNBN0UsUUFBQThFLE9BQUEzRCxFQUFBWixPQUFBc0UsWUFBQXRFLEVBQUF3RSxlQUNBWCxFQUFBakQsTUFBQUEsRUFBQUEsTUFBQUEsRUFBQVosVUFFQW9FLElBQUFLLElBQ0FBLEdBQUEsRUFDQVgsRUFBQXJELFVBQUEyRCxJQUlBLFFBQUFNLEtBSUFULEVBQUFVLElBQUEsb0JBQ0EsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQW5ELEdBQ0EsSUFBQW9ELEVBQUEsQ0FHQUMsRUFBQUMsU0FDQUYsR0FBQSxDQUNBLElBQUFHLEdBQUFQLElBQ0FBLEVBQUE5RCxPQUFBOEQsRUFBQVEsTUFBQVIsRUFBQVMsb0JBQ0EsaUJBQ0FDLEVBQUEsb0JBQUFILEVBQUEsTUFDQXZELEVBQUFOLE1BQUEsSUFBQSxXQUFBTSxFQUFBMkQsWUFBQSxJQUNBLE1BQUEzRCxFQUFBNEQsUUFBQSxHQUNBcEUsR0FBQXFDLFFBQUE2QixHQUFBVixJQUNBYixFQUFBMEIsS0FBQSxRQUtBLFFBQUFDLEtBQ0FqQixJQUNBa0IsSUFHQSxRQUFBakYsS0FBQSxNQUFBdUQsR0FBQW5DLE1BRUEsUUFBQTZELEtBQ0EzQixFQUFBVSxJQUFBLHNCQUNBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0FFLEVBQUFXLFVBQ0FaLEdBQUEsQ0FDQSxJQUFBbEUsR0FBQWYsRUFBQUUsU0FBQSxLQUFBMkUsRUFBQTlELE9BQUEsR0FDQWtELEdBQUFsRCxNQUFBQSxJQW5FQSxHQUFBa0UsSUFBQSxFQUNBUixHQUFBLEVBQ0FTLEdBQ0FDLE9BQUEsRUFDQVUsUUFBQSxHQUdBN0QsR0FDQXRCLGdCQUFBQSxFQUNBQyxVQUFBQSxFQUNBdUUsWUFBQUEsRUFLQSxPQUZBUyxLQUVBM0QsRUFqQ0EsR0FBQWhDLElBQ0FFLFNBQUFpQyxPQUNBcUMsaUJBR0FaLEdBQUFrQyxXQUNBQyxTQUFBLEVBQ0FDLGFBQUEsSUFHQTlELEtBQUF2QyxVQUFBLFNBQUFzRyxHQUNBeEcsUUFBQThFLE9BQUF2RSxFQUFBaUcsSUFHQS9ELEtBQUFFLEtBQUEyQixFQUNBQSxFQUFBekQsU0FBQSxZQUFBLGFBQUEsU0FBQSxVQXZCQWIsUUFDQUMsT0FBQSxpQkFDQW1ELFNBQUEsZUFBQWhELEdBRUFBLEVBQUFTLFNBQUEsb0JBQUEsaUJBQUEseUJDUkEsV0FDQSxZQUVBYixTQUFBQyxPQUFBLHNCQUFBLGdCQ0hBLFdBRUFELFFBQUFDLE9BQUEsb0JBQUEsZ0JDRkEsV0FDQSxZQUdBRCxTQUFBQyxPQUFBLGdCQUNBLGdCQ0xBLFdBRUFELFFBQUFDLE9BQUEsV0FDQSxXQUNBLG1CQUNBLDBCQ0xBLFdBQ0EsWUFFQUQsU0FBQUMsT0FBQSxjQUNBLGdCQ0pBLFdBQ0EsWUFJQSxTQUFBd0csS0FDQSxHQUFBQyxHQUFBakUsSUFDQWlFLEdBQUFwRixNQUFBLFdBSkF0QixRQUFBQyxPQUFBLGdCQUFBMEcsV0FBQSxpQkFBQUYsTUNIQSxXQUNBLFlBUUEsU0FBQTNGLEdBQUFDLEdBQ0FBLEVBQUFFLGdCQUFBQyxLQUdBLFFBQUFBLEtBQ0EsUUFFQUMsTUFBQSxXQUNBWixRQUNBYSxJQUFBLElBQ0FDLFlBQUEsa0NBQ0FzRixXQUFBLGlCQUNBQyxhQUFBLE9BQ0F0RixNQUFBLGtCQW5CQXRCLFFBQ0FDLE9BQUEsZ0JBQ0FzQixJQUFBVCxHQUVBQSxFQUFBRCxTQUFBLG1CQ1BBLFdBQ0EsWUFTQSxTQUFBZ0csR0FBQUMsR0FDQSxHQUFBSixHQUFBakUsSUFDQWlFLEdBQUFLLFdBVEEvRyxRQUNBQyxPQUFBLFdBQ0EwRyxXQUFBLGdCQUFBRSxHQUVBQSxFQUFBaEcsU0FBQSxhQ1BBLFdBQ0EsWUFRQSxTQUFBQyxHQUFBQyxHQUNBQSxFQUFBRSxnQkFBQUMsS0FHQSxRQUFBQSxLQUNBLFFBRUFDLE1BQUEsTUFDQVosUUFDQWEsSUFBQSxPQUNBQyxZQUFBLHdCQUNBc0YsV0FBQSxnQkFDQUMsYUFBQSxRQUNBdEYsTUFBQSx3QkFuQkF0QixRQUNBQyxPQUFBLFdBQ0FzQixJQUFBVCxHQUVBQSxFQUFBRCxTQUFBLG1CQ1BBLFdBQ0EsWUFRQSxTQUFBbUcsR0FBQUYsSUFOQTlHLFFBQUFDLE9BQUEsY0FDQTBHLFdBQUEsbUJBQUFLLEdBRUFBLEVBQUFuRyxTQUFBLGFDTkEsV0FDQSxZQVFBLFNBQUFvRyxHQUFBSCxFQUFBckMsR0FPQSxRQUFBeUMsS0FDQSxNQUFBLG1CQUFBSixHQUFBSyxNQUFBSixRQUFBSyxZQUNBM0MsR0FBQTRDLEdBQUEscUJBSUFYLEVBQUFZLFdBQUFSLEVBQUFLLE1BQUFKLFFBQUFLLFFBQUFFLFlBR0EsUUFBQUMsR0FBQUMsR0FDQSxNQUFBLDRCQUFBQSxFQUFBQyxLQUFBLElBQUFELEVBQUFDLEtBQUEsYUFHQSxRQUFBQyxHQUFBRixHQUNBLE1BQUEsbUJBQUFWLEdBQUFLLE1BQUFKLFFBQUFTLEVBQUE1QixNQXBCQSxHQUFBYyxHQUFBakUsSUFDQWlFLEdBQUFhLFFBQUFBLEVBQ0FiLEVBQUFnQixlQUFBQSxFQUVBUixJQVhBbEgsUUFDQUMsT0FBQSxzQkFDQTBHLFdBQUEsdUJBQUFNLEdBRUFBLEVBQUFwRyxTQUFBLFNBQUEsYUNQQSxXQUNBLFlBUUEsU0FBQUMsR0FBQUMsR0FDQUEsRUFBQUUsZ0JBQUFDLEtBR0EsUUFBQUEsS0FDQSxRQUVBQyxNQUFBLGlCQUNBWixRQUNBYSxJQUFBLGNBQ0FFLE1BQUEsNEJBQ0FxRixXQUFBLHVCQUNBQyxhQUFBLGVBQ0F2RixZQUFBLDZDQW5CQXJCLFFBQ0FDLE9BQUEsc0JBQ0FzQixJQUFBVCxHQUVBQSxFQUFBRCxTQUFBLG1CQ1BBLFdBQ0EsWUFTQSxTQUFBOEcsR0FBQWIsRUFBQXJDLEVBQUFqRCxHQU9BLFFBQUEwRixLQUNBMUYsRUFBQVEsUUFBQUUsS0FBQUwsR0FHQSxRQUFBQSxLQUNBNkUsRUFBQTNFLFNBQUFQLEVBQUFLLGNBR0EsUUFBQStGLEdBQUFSLEdBQ0FOLEVBQUFLLE1BQUFKLFFBQUFLLFFBQUFBLEVBZkEsR0FBQVYsR0FBQWpFLElBRUFpRSxHQUFBa0IsT0FBQUEsRUFFQVYsSUFaQWxILFFBQ0FDLE9BQUEsb0JBQ0EwRyxXQUFBLHFCQUFBZ0IsR0FFQUEsRUFBQTlHLFNBQUEsU0FBQSxTQUFBLGtCQ1BBLFdBQ0EsWUFRQSxTQUFBQyxHQUFBQyxHQUNBQSxFQUFBRSxnQkFBQUMsS0FHQSxRQUFBQSxLQUNBLFFBRUFDLE1BQUEsZUFDQVosUUFDQWEsSUFBQSxZQUNBRSxNQUFBLDBCQUNBcUYsV0FBQSxxQkFDQUMsYUFBQSxhQUNBdkYsWUFBQSx5Q0FuQkFyQixRQUNBQyxPQUFBLG9CQUNBc0IsSUFBQVQsR0FFQUEsRUFBQUQsU0FBQSxtQkNQQSxXQUNBLFlBU0EsU0FBQWdILEdBQUFmLEdBTUEsUUFBQWdCLEdBQUFDLEdBQ0FyQixFQUFBc0IsT0FBQUQsRUFDQWpCLEVBQUFLLE1BQUFKLFFBQUFMLEVBQUFjLFVBQUE1QixNQUFBbUMsRUFQQSxHQUFBckIsR0FBQWpFLElBQ0FpRSxHQUFBc0IsT0FBQSxLQUNBdEIsRUFBQW9CLFVBQUFBLEVBVkE5SCxRQUNBQyxPQUFBLHNCQUNBMEcsV0FBQSxxQkFBQWtCLEdBRUFBLEVBQUFoSCxTQUFBLGFDUEEsV0FDQSxZQVNBLFNBQUFvSCxHQUFBbkIsR0FPQSxRQUFBb0IsR0FBQXRILEdBQ0EsTUFBQThGLEdBQUFLLFFBQUFvQixRQUFBdkgsR0FBQSxHQUdBLFFBQUF3SCxHQUFBeEgsR0FDQSxHQUFBeUgsR0FBQTNCLEVBQUFLLFFBQUFvQixRQUFBdkgsRUFDQXlILEdBQUEsR0FDQTNCLEVBQUFLLFFBQUF1QixPQUFBRCxFQUFBLEdBRUEzQixFQUFBSyxRQUFBd0IsS0FBQTNILEdBSUEsUUFBQTRILEtBQ0ExQixFQUFBSyxNQUFBSixRQUFBTCxFQUFBYyxVQUFBNUIsTUFBQWMsRUFBQUssUUFwQkEsR0FBQUwsR0FBQWpFLElBQ0FpRSxHQUFBSyxXQUNBTCxFQUFBd0IsT0FBQUEsRUFDQXhCLEVBQUEwQixPQUFBQSxFQUNBMUIsRUFBQThCLFlBQUFBLEVBWkF4SSxRQUNBQyxPQUFBLHNCQUNBMEcsV0FBQSxxQkFBQXNCLEdBRUFBLEVBQUFwSCxTQUFBLGFDUEEsV0FDQSxZQVNBLFNBQUE0SCxHQUFBM0IsR0FVQSxRQUFBZ0IsR0FBQUMsR0FDQXJCLEVBQUFzQixTQUNBVSxTQUFBQyxlQUFBLGNBQUFqQyxFQUFBc0IsUUFBQVksTUFBQUMsUUFBQSxFQUNBbkMsRUFBQW9DLFFBQUEsS0FFQXBDLEVBQUFzQixPQUFBRCxFQUdBLFFBQUFnQixLQUNBakMsRUFBQUssTUFBQUosUUFBQUwsRUFBQWMsVUFBQTVCLE9BQUFoRixNQUFBOEYsRUFBQXNCLE9BQUFjLFFBQUFwQyxFQUFBb0MsU0FHQSxRQUFBRSxLQUNBTixTQUFBQyxlQUFBLGNBQUFqQyxFQUFBc0IsUUFBQVksTUFBQUMsUUFBQW5DLEVBQUFvQyxRQUFBLElBdEJBLEdBQUFwQyxHQUFBakUsS0FDQWlFLEVBQUFqRSxJQUNBaUUsR0FBQXNCLE9BQUEsS0FDQXRCLEVBQUFvQixVQUFBQSxFQUNBcEIsRUFBQXNDLFdBQUFBLEVBQ0F0QyxFQUFBcUMsV0FBQUEsRUFDQXJDLEVBQUFvQyxRQUFBLElBZEE5SSxRQUNBQyxPQUFBLHNCQUNBMEcsV0FBQSxrQkFBQThCLEdBRUFBLEVBQUE1SCxTQUFBLGFDUEEsV0FDQSxZQVNBLFNBQUFvSSxHQUFBbkMsR0FNQSxRQUFBZ0IsR0FBQUMsR0FDQXJCLEVBQUFzQixPQUFBRCxFQUNBakIsRUFBQUssTUFBQUosUUFBQUwsRUFBQWMsVUFBQTVCLE1BQUFtQyxFQVBBLEdBQUFyQixHQUFBakUsSUFDQWlFLEdBQUFzQixPQUFBLEtBQ0F0QixFQUFBb0IsVUFBQUEsRUFWQTlILFFBQ0FDLE9BQUEsc0JBQ0EwRyxXQUFBLHFCQUFBc0MsR0FFQUEsRUFBQXBJLFNBQUEsYUNQQSxXQUNBLFlBU0EsU0FBQXFJLEdBQUFwQyxHQUtBLFFBQUFnQixLQUNBLEtBQUFwQixFQUFBc0IsUUFBQSxPQUFBdEIsRUFBQXNCLE9BQ0FsQixFQUFBSyxNQUFBSixRQUFBTCxFQUFBYyxVQUFBNUIsTUFBQWMsRUFBQXNCLGFBRUFsQixHQUFBSyxNQUFBSixRQUFBTCxFQUFBYyxVQUFBNUIsTUFSQSxHQUFBYyxHQUFBakUsSUFDQWlFLEdBQUFzQixPQUFBLEtBQ0F0QixFQUFBb0IsVUFBQUEsRUFWQTlILFFBQ0FDLE9BQUEsc0JBQ0EwRyxXQUFBLHNCQUFBdUMsR0FFQUEsRUFBQXJJLFNBQUEsYUNQQSxXQUNBLFlBU0EsU0FBQXNJLEdBQUFyQyxHQVNBLFFBQUFnQixHQUFBQyxHQUNBckIsRUFBQXNCLFNBQ0F0QixFQUFBb0MsUUFBQSxLQUVBcEMsRUFBQXNCLE9BQUFELEVBR0EsUUFBQWdCLEtBQ0FqQyxFQUFBSyxNQUFBSixRQUFBTCxFQUFBYyxVQUFBNUIsT0FBQWhGLE1BQUE4RixFQUFBc0IsT0FBQWMsUUFBQXBDLEVBQUFvQyxTQWhCQSxHQUFBcEMsR0FBQWpFLEtBQ0FpRSxFQUFBakUsSUFDQWlFLEdBQUFzQixPQUFBLEtBQ0F0QixFQUFBb0IsVUFBQUEsRUFDQXBCLEVBQUFxQyxXQUFBQSxFQUNBckMsRUFBQW9DLFFBQUEsSUFiQTlJLFFBQ0FDLE9BQUEsc0JBQ0EwRyxXQUFBLHdCQUFBd0MsR0FFQUEsRUFBQXRJLFNBQUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcbiAgICAgICAgJ2FwcC5jb3JlJyxcbiAgICAgICAgJ2FwcC5sYWInLFxuICAgICAgICAnYXBwLmhvbWVwYWdlJyxcbiAgICAgICAgJ2FwcC5sYXlvdXQnXG4gICAgXSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvcmUnLCBbXG4gICAgICAgICAgICAnbmdBbmltYXRlJywgJ25nU2FuaXRpemUnLFxuICAgICAgICAgICAgJ2Jsb2Nrcy5leGNlcHRpb24nLCAnYmxvY2tzLmxvZ2dlcicsICdibG9ja3Mucm91dGVyJyxcbiAgICAgICAgICAgICd1aS5yb3V0ZXInLCAnbmdNYXRlcmlhbCdcbiAgICAgICAgXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgY29yZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAuY29yZScpO1xuICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgIGFwcEVycm9yUHJlZml4OiAnWzwlPSBhcHBOYW1lICU+IEVycm9yXSAnLFxuICAgICAgICBhcHBUaXRsZTogJzwlPSBhcHBOYW1lICU+J1xuICAgIH07XG5cbiAgICBjb3JlLnZhbHVlKCdjb25maWcnLCBjb25maWcpO1xuXG4gICAgY29yZS5jb25maWcoY29uZmlndXJlKTtcblxuICAgIGNvbmZpZ3VyZS4kaW5qZWN0ID0gWyckbG9nUHJvdmlkZXInLCAncm91dGVySGVscGVyUHJvdmlkZXInLCAnZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gY29uZmlndXJlKCRsb2dQcm92aWRlciwgcm91dGVySGVscGVyUHJvdmlkZXIsIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcikge1xuICAgICAgICBpZiAoJGxvZ1Byb3ZpZGVyLmRlYnVnRW5hYmxlZCkge1xuICAgICAgICAgICAgJGxvZ1Byb3ZpZGVyLmRlYnVnRW5hYmxlZCh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIuY29uZmlndXJlKGNvbmZpZy5hcHBFcnJvclByZWZpeCk7XG4gICAgICAgIHJvdXRlckhlbHBlclByb3ZpZGVyLmNvbmZpZ3VyZSh7ZG9jVGl0bGU6IGNvbmZpZy5hcHBUaXRsZSArICc6ICd9KTtcbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuY29yZScpXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcbiAgICAgICAgdmFyIG90aGVyd2lzZSA9ICcvNDA0JztcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSwgb3RoZXJ3aXNlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICc0MDQnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvNDA0JyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvY29yZS80MDQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnNDA0J1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAgICAgICAnYXBwLmNvcmUnLFxuICAgICAgICAnYXBwLmxhYicsXG4gICAgICAgICdhcHAuaG9tZXBhZ2UnLFxuICAgICAgICAnYXBwLmxheW91dCdcbiAgICBdKTtcblxufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJywgW1xuICAgICAgICAgICAgJ25nQW5pbWF0ZScsICduZ1Nhbml0aXplJyxcbiAgICAgICAgICAgICdibG9ja3MuZXhjZXB0aW9uJywgJ2Jsb2Nrcy5sb2dnZXInLCAnYmxvY2tzLnJvdXRlcicsXG4gICAgICAgICAgICAndWkucm91dGVyJywgJ25nTWF0ZXJpYWwnXG4gICAgICAgIF0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgY29yZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAuY29yZScpO1xuICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgIGFwcEVycm9yUHJlZml4OiAnWzwlPSBhcHBOYW1lICU+IEVycm9yXSAnLFxuICAgICAgICBhcHBUaXRsZTogJzwlPSBhcHBOYW1lICU+J1xuICAgIH07XG5cbiAgICBjb3JlLnZhbHVlKCdjb25maWcnLCBjb25maWcpO1xuXG4gICAgY29yZS5jb25maWcoY29uZmlndXJlKTtcblxuICAgIGNvbmZpZ3VyZS4kaW5qZWN0ID0gWyckbG9nUHJvdmlkZXInLCAncm91dGVySGVscGVyUHJvdmlkZXInLCAnZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gY29uZmlndXJlKCRsb2dQcm92aWRlciwgcm91dGVySGVscGVyUHJvdmlkZXIsIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcikge1xuICAgICAgICBpZiAoJGxvZ1Byb3ZpZGVyLmRlYnVnRW5hYmxlZCkge1xuICAgICAgICAgICAgJGxvZ1Byb3ZpZGVyLmRlYnVnRW5hYmxlZCh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIuY29uZmlndXJlKGNvbmZpZy5hcHBFcnJvclByZWZpeCk7XG4gICAgICAgIHJvdXRlckhlbHBlclByb3ZpZGVyLmNvbmZpZ3VyZSh7ZG9jVGl0bGU6IGNvbmZpZy5hcHBUaXRsZSArICc6ICd9KTtcbiAgICB9XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhcHBSdW4uJGluamVjdCA9IFtcInJvdXRlckhlbHBlclwiXTtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xuICAgICAgICB2YXIgb3RoZXJ3aXNlID0gJy80MDQnO1xuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpLCBvdGhlcndpc2UpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJzQwNCcsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy80MDQnLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9jb3JlLzQwNC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICc0MDQnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuY29yZScpXG4gICAgICAgIC5mYWN0b3J5KCdkYXRhc2VydmljZScsIGRhdGFzZXJ2aWNlKTtcblxuICAgIGRhdGFzZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywgJyRxJywgJ2V4Y2VwdGlvbicsICdsb2dnZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBkYXRhc2VydmljZSgkaHR0cCwgJHEsIGV4Y2VwdGlvbiwgbG9nZ2VyKSB7XG4gICAgICAgIHZhciBqc29uVVJMID0gJy9yZXNzb3VyY2VzL3Byb2R1Y3RzLmpzb24nO1xuICAgICAgICB2YXIgcHJvbWlzZSA9ICRodHRwLmdldChqc29uVVJMKTtcbiAgICAgICAgdmFyIGRhdGEgPSBudWxsO1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICByZWFkeTogcmVhZHksXG4gICAgICAgICAgZ2V0UHJvZHVjdHM6IGdldFByb2R1Y3RzXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0UHJvZHVjdHMoKSB7XG4gICAgICAgICAgcmV0dXJuIGRhdGEucHJvZHVjdHM7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZWFkeSgpIHtcbiAgICAgICAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgZGF0YSA9IHJlc3VsdC5kYXRhO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0ltcG9zc2libGUgZGUgcsOpY3Vww6lyZXIgbGVzIGRvbm7DqWVzJyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicsIFsnYmxvY2tzLmxvZ2dlciddKTtcbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYmxvY2tzLmxvZ2dlcicsIFtdKTtcbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYmxvY2tzLnJvdXRlcicsIFtcbiAgICAgICAgJ3VpLnJvdXRlcicsXG4gICAgICAgICdibG9ja3MubG9nZ2VyJ1xuICAgIF0pO1xufSkoKTtcblxuLy8gSW5jbHVkZSBpbiBpbmRleC5odG1sIHNvIHRoYXQgYXBwIGxldmVsIGV4Y2VwdGlvbnMgYXJlIGhhbmRsZWQuXG4vLyBFeGNsdWRlIGZyb20gdGVzdFJ1bm5lci5odG1sIHdoaWNoIHNob3VsZCBydW4gZXhhY3RseSB3aGF0IGl0IHdhbnRzIHRvIHJ1blxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicpXG4gICAgICAgIC5wcm92aWRlcignZXhjZXB0aW9uSGFuZGxlcicsIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcilcbiAgICAgICAgLmNvbmZpZyhjb25maWcpO1xuXG4gICAgLyoqXG4gICAgICogTXVzdCBjb25maWd1cmUgdGhlIGV4Y2VwdGlvbiBoYW5kbGluZ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcigpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgICAgICAgYXBwRXJyb3JQcmVmaXg6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuY29uZmlndXJlID0gZnVuY3Rpb24gKGFwcEVycm9yUHJlZml4KSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5hcHBFcnJvclByZWZpeCA9IGFwcEVycm9yUHJlZml4O1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuJGdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtjb25maWc6IHRoaXMuY29uZmlnfTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25maWcuJGluamVjdCA9IFsnJHByb3ZpZGUnXTtcblxuICAgIC8qKlxuICAgICAqIENvbmZpZ3VyZSBieSBzZXR0aW5nIGFuIG9wdGlvbmFsIHN0cmluZyB2YWx1ZSBmb3IgYXBwRXJyb3JQcmVmaXguXG4gICAgICogQWNjZXNzaWJsZSB2aWEgY29uZmlnLmFwcEVycm9yUHJlZml4ICh2aWEgY29uZmlnIHZhbHVlKS5cbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9ICRwcm92aWRlXG4gICAgICovXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gY29uZmlnKCRwcm92aWRlKSB7XG4gICAgICAgICRwcm92aWRlLmRlY29yYXRvcignJGV4Y2VwdGlvbkhhbmRsZXInLCBleHRlbmRFeGNlcHRpb25IYW5kbGVyKTtcbiAgICB9XG5cbiAgICBleHRlbmRFeGNlcHRpb25IYW5kbGVyLiRpbmplY3QgPSBbJyRkZWxlZ2F0ZScsICdleGNlcHRpb25IYW5kbGVyJywgJ2xvZ2dlciddO1xuXG4gICAgLyoqXG4gICAgICogRXh0ZW5kIHRoZSAkZXhjZXB0aW9uSGFuZGxlciBzZXJ2aWNlIHRvIGFsc28gZGlzcGxheSBhIHRvYXN0LlxuICAgICAqIEBwYXJhbSAge09iamVjdH0gJGRlbGVnYXRlXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBleGNlcHRpb25IYW5kbGVyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBsb2dnZXJcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gdGhlIGRlY29yYXRlZCAkZXhjZXB0aW9uSGFuZGxlciBzZXJ2aWNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXh0ZW5kRXhjZXB0aW9uSGFuZGxlcigkZGVsZWdhdGUsIGV4Y2VwdGlvbkhhbmRsZXIsIGxvZ2dlcikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZXhjZXB0aW9uLCBjYXVzZSkge1xuICAgICAgICAgICAgdmFyIGFwcEVycm9yUHJlZml4ID0gZXhjZXB0aW9uSGFuZGxlci5jb25maWcuYXBwRXJyb3JQcmVmaXggfHwgJyc7XG4gICAgICAgICAgICB2YXIgZXJyb3JEYXRhID0ge2V4Y2VwdGlvbjogZXhjZXB0aW9uLCBjYXVzZTogY2F1c2V9O1xuICAgICAgICAgICAgZXhjZXB0aW9uLm1lc3NhZ2UgPSBhcHBFcnJvclByZWZpeCArIGV4Y2VwdGlvbi5tZXNzYWdlO1xuICAgICAgICAgICAgJGRlbGVnYXRlKGV4Y2VwdGlvbiwgY2F1c2UpO1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDb3VsZCBhZGQgdGhlIGVycm9yIHRvIGEgc2VydmljZSdzIGNvbGxlY3Rpb24sXG4gICAgICAgICAgICAgKiBhZGQgZXJyb3JzIHRvICRyb290U2NvcGUsIGxvZyBlcnJvcnMgdG8gcmVtb3RlIHdlYiBzZXJ2ZXIsXG4gICAgICAgICAgICAgKiBvciBsb2cgbG9jYWxseS4gT3IgdGhyb3cgaGFyZC4gSXQgaXMgZW50aXJlbHkgdXAgdG8geW91LlxuICAgICAgICAgICAgICogdGhyb3cgZXhjZXB0aW9uO1xuICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAgICAgKiAgICAgdGhyb3cgeyBtZXNzYWdlOiAnZXJyb3IgbWVzc2FnZSB3ZSBhZGRlZCcgfTtcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGV4Y2VwdGlvbi5tZXNzYWdlLCBlcnJvckRhdGEpO1xuICAgICAgICB9O1xuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBleGNlcHRpb24uJGluamVjdCA9IFtcIiRxXCIsIFwibG9nZ2VyXCJdO1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicpXG4gICAgICAgIC5mYWN0b3J5KCdleGNlcHRpb24nLCBleGNlcHRpb24pO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gZXhjZXB0aW9uKCRxLCBsb2dnZXIpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBjYXRjaGVyOiBjYXRjaGVyXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGNhdGNoZXIobWVzc2FnZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhyb3duRGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgdmFyIG5ld01lc3NhZ2U7XG4gICAgICAgICAgICAgICAgaWYgKGUuZGF0YSAmJiBlLmRhdGEuZGVzY3JpcHRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3duRGVzY3JpcHRpb24gPSAnXFxuJyArIGUuZGF0YS5kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgbmV3TWVzc2FnZSA9IG1lc3NhZ2UgKyB0aHJvd25EZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZS5kYXRhLmRlc2NyaXB0aW9uID0gbmV3TWVzc2FnZTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IobmV3TWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3MubG9nZ2VyJylcbiAgICAgICAgLmZhY3RvcnkoJ2xvZ2dlcicsIGxvZ2dlcik7XG5cbiAgICBsb2dnZXIuJGluamVjdCA9IFsnJGxvZyddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gbG9nZ2VyKCRsb2csIHRvYXN0cikge1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGVycm9yICAgOiBlcnJvcixcbiAgICAgICAgICAgIGluZm8gICAgOiBpbmZvLFxuICAgICAgICAgICAgc3VjY2VzcyA6IHN1Y2Nlc3MsXG4gICAgICAgICAgICB3YXJuaW5nIDogd2FybmluZyxcblxuICAgICAgICAgICAgLy8gc3RyYWlnaHQgdG8gY29uc29sZTsgYnlwYXNzIHRvYXN0clxuICAgICAgICAgICAgbG9nICAgICA6ICRsb2cubG9nXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuZXJyb3IoJ0Vycm9yOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbmZvKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmluZm8obWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5pbmZvKCdJbmZvOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLmluZm8oJ1N1Y2Nlc3M6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLndhcm4oJ1dhcm5pbmc6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cbn0oKSk7XG5cbi8qIEhlbHAgY29uZmlndXJlIHRoZSBzdGF0ZS1iYXNlIHVpLnJvdXRlciAqL1xuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLnJvdXRlcicpXG4gICAgICAgIC5wcm92aWRlcigncm91dGVySGVscGVyJywgcm91dGVySGVscGVyUHJvdmlkZXIpO1xuXG4gICAgcm91dGVySGVscGVyUHJvdmlkZXIuJGluamVjdCA9IFsnJGxvY2F0aW9uUHJvdmlkZXInLCAnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gcm91dGVySGVscGVyUHJvdmlkZXIoJGxvY2F0aW9uUHJvdmlkZXIsICRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICBkb2NUaXRsZTogdW5kZWZpbmVkLFxuICAgICAgICAgICAgcmVzb2x2ZUFsd2F5czoge31cbiAgICAgICAgfTtcblxuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUoe1xuICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgIHJlcXVpcmVCYXNlOiBmYWxzZVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uKGNmZykge1xuICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoY29uZmlnLCBjZmcpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuJGdldCA9IFJvdXRlckhlbHBlcjtcbiAgICAgICAgUm91dGVySGVscGVyLiRpbmplY3QgPSBbJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgJyRzdGF0ZScsICdsb2dnZXInXTtcbiAgICAgICAgLyogQG5nSW5qZWN0ICovXG4gICAgICAgIGZ1bmN0aW9uIFJvdXRlckhlbHBlcigkbG9jYXRpb24sICRyb290U2NvcGUsICRzdGF0ZSwgbG9nZ2VyKSB7XG4gICAgICAgICAgICB2YXIgaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgaGFzT3RoZXJ3aXNlID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgc3RhdGVDb3VudHMgPSB7XG4gICAgICAgICAgICAgICAgZXJyb3JzOiAwLFxuICAgICAgICAgICAgICAgIGNoYW5nZXM6IDBcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgICAgIGNvbmZpZ3VyZVN0YXRlczogY29uZmlndXJlU3RhdGVzLFxuICAgICAgICAgICAgICAgIGdldFN0YXRlczogZ2V0U3RhdGVzLFxuICAgICAgICAgICAgICAgIHN0YXRlQ291bnRzOiBzdGF0ZUNvdW50c1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZVN0YXRlcyhzdGF0ZXMsIG90aGVyd2lzZVBhdGgpIHtcbiAgICAgICAgICAgICAgICBzdGF0ZXMuZm9yRWFjaChmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5jb25maWcucmVzb2x2ZSA9XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChzdGF0ZS5jb25maWcucmVzb2x2ZSB8fCB7fSwgY29uZmlnLnJlc29sdmVBbHdheXMpO1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZShzdGF0ZS5zdGF0ZSwgc3RhdGUuY29uZmlnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAob3RoZXJ3aXNlUGF0aCAmJiAhaGFzT3RoZXJ3aXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhc090aGVyd2lzZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2Uob3RoZXJ3aXNlUGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVSb3V0aW5nRXJyb3JzKCkge1xuICAgICAgICAgICAgICAgIC8vIFJvdXRlIGNhbmNlbGxhdGlvbjpcbiAgICAgICAgICAgICAgICAvLyBPbiByb3V0aW5nIGVycm9yLCBnbyB0byB0aGUgZGFzaGJvYXJkLlxuICAgICAgICAgICAgICAgIC8vIFByb3ZpZGUgYW4gZXhpdCBjbGF1c2UgaWYgaXQgdHJpZXMgdG8gZG8gaXQgdHdpY2UuXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZUVycm9yJyxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMsIGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudHMuZXJyb3JzKys7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlc3RpbmF0aW9uID0gKHRvU3RhdGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodG9TdGF0ZS50aXRsZSB8fCB0b1N0YXRlLm5hbWUgfHwgdG9TdGF0ZS5sb2FkZWRUZW1wbGF0ZVVybCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Vua25vd24gdGFyZ2V0JztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtc2cgPSAnRXJyb3Igcm91dGluZyB0byAnICsgZGVzdGluYXRpb24gKyAnLiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZXJyb3IuZGF0YSB8fCAnJykgKyAnLiA8YnIvPicgKyAoZXJyb3Iuc3RhdHVzVGV4dCB8fCAnJykgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6ICcgKyAoZXJyb3Iuc3RhdHVzIHx8ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKG1zZywgW3RvU3RhdGVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgICAgIGhhbmRsZVJvdXRpbmdFcnJvcnMoKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVEb2NUaXRsZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7IHJldHVybiAkc3RhdGUuZ2V0KCk7IH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlRG9jVGl0bGUoKSB7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudHMuY2hhbmdlcysrO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBjb25maWcuZG9jVGl0bGUgKyAnICcgKyAodG9TdGF0ZS50aXRsZSB8fCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnRpdGxlID0gdGl0bGU7IC8vIGRhdGEgYmluZCB0byA8dGl0bGU+XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycsIFsnYXBwLmNvcmUnXSk7XG5cbn0pICgpO1xuXG4oZnVuY3Rpb24gKCkge1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAubGFiLnByb2R1Y3RzJywgWydhcHAuY29yZSddKTtcblxufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5ob21lcGFnZScsIFtcbiAgICAnYXBwLmNvcmUnXG4gIF0pO1xuXG59KSAoKTtcblxuKGZ1bmN0aW9uICgpIHtcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxhYicsIFtcbiAgICAnYXBwLmNvcmUnLFxuICAgICdhcHAubGFiLnByb2R1Y3RzJyxcbiAgICAnYXBwLmxhYi5hdHRyaWJ1dGVzJ1xuICBdKTtcblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAubGF5b3V0JywgW1xuICAgICAgJ2FwcC5jb3JlJ1xuICAgIF0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuaG9tZXBhZ2UnKS5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIEhvbWVDb250cm9sbGVyKTtcblxuICBmdW5jdGlvbiBIb21lQ29udHJvbGxlcigpwqB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS50aXRsZSA9ICdIb21lcGFnZSc7XG4gIH1cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5ob21lcGFnZScpXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcblxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2hvbWVwYWdlJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnLycsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2hvbWVwYWdlL2hvbWVwYWdlLnZpZXcuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2hvbWUnLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYicpXG4gICAgICAgIC5jb250cm9sbGVyKCdMYWJDb250cm9sbGVyJywgTGFiQ29udHJvbGxlcik7XG5cbiAgICBMYWJDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gTGFiQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlcyA9IHt9O1xuICAgIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYicpXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcblxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xhYicsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9sYWInLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9sYWIvbGFiLnZpZXcuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMYWJDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnbGFiVm0nLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSAtIExhYidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAubGF5b3V0JylcbiAgICAgICAgICAuY29udHJvbGxlcignSGVhZGVyQ29udHJvbGxlcicsIEhlYWRlckNvbnRyb2xsZXIpO1xuXG4gICAgSGVhZGVyQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEhlYWRlckNvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICB2YXIgdm0gPSB0aGlzO1xuICAgIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0F0dHJpYnV0ZXNDb250cm9sbGVyJywgQXR0cmlidXRlc0NvbnRyb2xsZXIpO1xuXG4gICAgQXR0cmlidXRlc0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJywgJyRzdGF0ZSddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEF0dHJpYnV0ZXNDb250cm9sbGVyKCRzY29wZSwgJHN0YXRlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmdldEZvcm0gPSBnZXRGb3JtO1xuICAgICAgICB2bS5jaG9pY2VWYWxpZGF0ZSA9IGNob2ljZVZhbGlkYXRlO1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiAkc2NvcGUubGFiVm0uY2hvaWNlcy5wcm9kdWN0ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2xhYi5wcm9kdWN0cycpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZtLmF0dHJpYnV0ZXMgPSAkc2NvcGUubGFiVm0uY2hvaWNlcy5wcm9kdWN0LmF0dHJpYnV0ZXM7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRGb3JtKGF0dHJpYnV0ZSkge1xuICAgICAgICAgIHJldHVybiBcImFwcC9sYWIvYXR0cmlidXRlcy9mb3Jtcy9cIiArIGF0dHJpYnV0ZS5mb3JtICsgXCIvXCIgKyAgYXR0cmlidXRlLmZvcm0gKyBcIi52aWV3Lmh0bWxcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNob2ljZVZhbGlkYXRlKGF0dHJpYnV0ZSkge1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgJHNjb3BlLmxhYlZtLmNob2ljZXNbYXR0cmlidXRlLm5hbWVdICE9PSBcInVuZGVmaW5lZFwiO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAucnVuKGFwcFJ1bik7XG5cbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsYWIuYXR0cmlidXRlcycsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9hdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBhdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0F0dHJpYnV0ZXNDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnYXR0cmlidXRlc1ZtJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy52aWV3Lmh0bWwnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnKVxuICAgICAgICAuY29udHJvbGxlcignUHJvZHVjdHNDb250cm9sbGVyJywgUHJvZHVjdHNDb250cm9sbGVyKTtcblxuICAgIFByb2R1Y3RzQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHN0YXRlJywgJ2RhdGFzZXJ2aWNlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBQcm9kdWN0c0NvbnRyb2xsZXIoJHNjb3BlLCAkc3RhdGUsIGRhdGFzZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0uc2VsZWN0ID0gc2VsZWN0O1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgZGF0YXNlcnZpY2UucmVhZHkoKS50aGVuKGdldFByb2R1Y3RzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2R1Y3RzKCkge1xuICAgICAgICAgIHZtLnByb2R1Y3RzID0gZGF0YXNlcnZpY2UuZ2V0UHJvZHVjdHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdChwcm9kdWN0KSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXMucHJvZHVjdCA9IHByb2R1Y3Q7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnKVxuICAgICAgICAucnVuKGFwcFJ1bik7XG5cbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsYWIucHJvZHVjdHMnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvcHJvZHVjdHMnLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSAtIHByb2R1Y3RzJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2R1Y3RzQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3Byb2R1Y3RzVm0nLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9sYWIvcHJvZHVjdHMvcHJvZHVjdHMudmlldy5odG1sJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAuY29udHJvbGxlcignQnRuUmFkaW9Db250cm9sbGVyJywgQnRuUmFkaW9Db250cm9sbGVyKTtcblxuICAgIEJ0blJhZGlvQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEJ0blJhZGlvQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xuXG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcbiAgICAgICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IGF0dHJpYnV0ZUNob2ljZWQ7XG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0NoZWNrYm94Q29udHJvbGxlcicsIENoZWNrYm94Q29udHJvbGxlcik7XG5cbiAgICBDaGVja2JveENvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBDaGVja2JveENvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNob2ljZXMgPSBbXTtcbiAgICAgICAgdm0uZXhpc3RzID0gZXhpc3RzO1xuICAgICAgICB2bS50b2dnbGUgPSB0b2dnbGU7XG4gICAgICAgIHZtLnNhdmVDaG9pY2VzID0gc2F2ZUNob2ljZXM7XG5cbiAgICAgICAgZnVuY3Rpb24gZXhpc3RzKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHZtLmNob2ljZXMuaW5kZXhPZih2YWx1ZSkgPiAtMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHRvZ2dsZSh2YWx1ZSkge1xuICAgICAgICAgIHZhciBpZHggPSB2bS5jaG9pY2VzLmluZGV4T2YodmFsdWUpO1xuICAgICAgICAgIGlmIChpZHggPiAtMSkge1xuICAgICAgICAgICAgdm0uY2hvaWNlcy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdm0uY2hvaWNlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZUNob2ljZXMoKSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gdm0uY2hvaWNlcztcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAuY29udHJvbGxlcignQ29sb3JDb250cm9sbGVyJywgQ29sb3JDb250cm9sbGVyKTtcblxuICAgIENvbG9yQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIENvbG9yQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xuICAgICAgICB2bS5zZXRPcGFjaXR5ID0gc2V0T3BhY2l0eTtcbiAgICAgICAgdm0uc2F2ZUNob2ljZSA9IHNhdmVDaG9pY2U7XG4gICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XG5cblxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xuICAgICAgICAgIGlmICh2bS5jaG9pY2UpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb3JtLWNvbG9yLScgKyB2bS5jaG9pY2UpLnN0eWxlLm9wYWNpdHkgPSAxO1xuICAgICAgICAgICAgdm0ucGVyY2VudCA9IDEwMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgdm0uY2hvaWNlID0gYXR0cmlidXRlQ2hvaWNlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVDaG9pY2UoKSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0ge3ZhbHVlOiB2bS5jaG9pY2UsIHBlcmNlbnQ6IHZtLnBlcmNlbnR9O1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0T3BhY2l0eSgpIHtcbiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9ybS1jb2xvci0nICsgdm0uY2hvaWNlKS5zdHlsZS5vcGFjaXR5ID0gdm0ucGVyY2VudCAvIDEwMDtcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgLmNvbnRyb2xsZXIoJ0ltZ1JhZGlvQ29udHJvbGxlcicsIEltZ1JhZGlvQ29udHJvbGxlcik7XG5cbiAgSW1nUmFkaW9Db250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBJbWdSYWRpb0NvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jaG9pY2UgPSBudWxsO1xuICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcblxuXG4gICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcbiAgICAgIHZtLmNob2ljZSA9IGF0dHJpYnV0ZUNob2ljZWQ7XG4gICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgIH1cblxuICB9XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdJbnB1dFRleHRDb250cm9sbGVyJywgSW5wdXRUZXh0Q29udHJvbGxlcik7XG5cbiAgICBJbnB1dFRleHRDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gSW5wdXRUZXh0Q29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xuXG4gICAgICAgIGZ1bmN0aW9uIHNldENob2ljZSgpIHtcbiAgICAgICAgICBpZiAodm0uY2hvaWNlICE9PSBcIlwiICYmIHZtLmNob2ljZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gdm0uY2hvaWNlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1JhZGlvU2xpZGVyQ29udHJvbGxlcicsIFJhZGlvU2xpZGVyQ29udHJvbGxlcik7XG5cbiAgICBSYWRpb1NsaWRlckNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBSYWRpb1NsaWRlckNvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XG4gICAgICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcbiAgICAgICAgdm0uc2F2ZUNob2ljZSA9IHNhdmVDaG9pY2U7XG4gICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XG5cblxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xuICAgICAgICAgIGlmICh2bS5jaG9pY2UpIHtcbiAgICAgICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZtLmNob2ljZSA9IGF0dHJpYnV0ZUNob2ljZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzYXZlQ2hvaWNlKCkge1xuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IHt2YWx1ZTogdm0uY2hvaWNlLCBwZXJjZW50OiB2bS5wZXJjZW50fTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuY29yZScpXG4gICAgICAgIC5mYWN0b3J5KCdkYXRhc2VydmljZScsIGRhdGFzZXJ2aWNlKTtcblxuICAgIGRhdGFzZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywgJyRxJywgJ2V4Y2VwdGlvbicsICdsb2dnZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBkYXRhc2VydmljZSgkaHR0cCwgJHEsIGV4Y2VwdGlvbiwgbG9nZ2VyKSB7XG4gICAgICAgIHZhciBqc29uVVJMID0gJy9yZXNzb3VyY2VzL3Byb2R1Y3RzLmpzb24nO1xuICAgICAgICB2YXIgcHJvbWlzZSA9ICRodHRwLmdldChqc29uVVJMKTtcbiAgICAgICAgdmFyIGRhdGEgPSBudWxsO1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICByZWFkeTogcmVhZHksXG4gICAgICAgICAgZ2V0UHJvZHVjdHM6IGdldFByb2R1Y3RzXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0UHJvZHVjdHMoKSB7XG4gICAgICAgICAgcmV0dXJuIGRhdGEucHJvZHVjdHM7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZWFkeSgpIHtcbiAgICAgICAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgZGF0YSA9IHJlc3VsdC5kYXRhO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoJ0ltcG9zc2libGUgZGUgcsOpY3Vww6lyZXIgbGVzIGRvbm7DqWVzJyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nLCBbJ2Jsb2Nrcy5sb2dnZXInXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdibG9ja3MubG9nZ2VyJywgW10pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYmxvY2tzLnJvdXRlcicsIFtcbiAgICAgICAgJ3VpLnJvdXRlcicsXG4gICAgICAgICdibG9ja3MubG9nZ2VyJ1xuICAgIF0pO1xufSkoKTtcbiIsIi8vIEluY2x1ZGUgaW4gaW5kZXguaHRtbCBzbyB0aGF0IGFwcCBsZXZlbCBleGNlcHRpb25zIGFyZSBoYW5kbGVkLlxuLy8gRXhjbHVkZSBmcm9tIHRlc3RSdW5uZXIuaHRtbCB3aGljaCBzaG91bGQgcnVuIGV4YWN0bHkgd2hhdCBpdCB3YW50cyB0byBydW5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nKVxuICAgICAgICAucHJvdmlkZXIoJ2V4Y2VwdGlvbkhhbmRsZXInLCBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIpXG4gICAgICAgIC5jb25maWcoY29uZmlnKTtcblxuICAgIC8qKlxuICAgICAqIE11c3QgY29uZmlndXJlIHRoZSBleGNlcHRpb24gaGFuZGxpbmdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIoKSB7XG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICAgICAgICB0aGlzLmNvbmZpZyA9IHtcbiAgICAgICAgICAgIGFwcEVycm9yUHJlZml4OiB1bmRlZmluZWRcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uIChhcHBFcnJvclByZWZpeCkge1xuICAgICAgICAgICAgdGhpcy5jb25maWcuYXBwRXJyb3JQcmVmaXggPSBhcHBFcnJvclByZWZpeDtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLiRnZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB7Y29uZmlnOiB0aGlzLmNvbmZpZ307XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgY29uZmlnLiRpbmplY3QgPSBbJyRwcm92aWRlJ107XG5cbiAgICAvKipcbiAgICAgKiBDb25maWd1cmUgYnkgc2V0dGluZyBhbiBvcHRpb25hbCBzdHJpbmcgdmFsdWUgZm9yIGFwcEVycm9yUHJlZml4LlxuICAgICAqIEFjY2Vzc2libGUgdmlhIGNvbmZpZy5hcHBFcnJvclByZWZpeCAodmlhIGNvbmZpZyB2YWx1ZSkuXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSAkcHJvdmlkZVxuICAgICAqL1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpZygkcHJvdmlkZSkge1xuICAgICAgICAkcHJvdmlkZS5kZWNvcmF0b3IoJyRleGNlcHRpb25IYW5kbGVyJywgZXh0ZW5kRXhjZXB0aW9uSGFuZGxlcik7XG4gICAgfVxuXG4gICAgZXh0ZW5kRXhjZXB0aW9uSGFuZGxlci4kaW5qZWN0ID0gWyckZGVsZWdhdGUnLCAnZXhjZXB0aW9uSGFuZGxlcicsICdsb2dnZXInXTtcblxuICAgIC8qKlxuICAgICAqIEV4dGVuZCB0aGUgJGV4Y2VwdGlvbkhhbmRsZXIgc2VydmljZSB0byBhbHNvIGRpc3BsYXkgYSB0b2FzdC5cbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9ICRkZWxlZ2F0ZVxuICAgICAqIEBwYXJhbSAge09iamVjdH0gZXhjZXB0aW9uSGFuZGxlclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gbG9nZ2VyXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IHRoZSBkZWNvcmF0ZWQgJGV4Y2VwdGlvbkhhbmRsZXIgc2VydmljZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIoJGRlbGVnYXRlLCBleGNlcHRpb25IYW5kbGVyLCBsb2dnZXIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGV4Y2VwdGlvbiwgY2F1c2UpIHtcbiAgICAgICAgICAgIHZhciBhcHBFcnJvclByZWZpeCA9IGV4Y2VwdGlvbkhhbmRsZXIuY29uZmlnLmFwcEVycm9yUHJlZml4IHx8ICcnO1xuICAgICAgICAgICAgdmFyIGVycm9yRGF0YSA9IHtleGNlcHRpb246IGV4Y2VwdGlvbiwgY2F1c2U6IGNhdXNlfTtcbiAgICAgICAgICAgIGV4Y2VwdGlvbi5tZXNzYWdlID0gYXBwRXJyb3JQcmVmaXggKyBleGNlcHRpb24ubWVzc2FnZTtcbiAgICAgICAgICAgICRkZWxlZ2F0ZShleGNlcHRpb24sIGNhdXNlKTtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ291bGQgYWRkIHRoZSBlcnJvciB0byBhIHNlcnZpY2UncyBjb2xsZWN0aW9uLFxuICAgICAgICAgICAgICogYWRkIGVycm9ycyB0byAkcm9vdFNjb3BlLCBsb2cgZXJyb3JzIHRvIHJlbW90ZSB3ZWIgc2VydmVyLFxuICAgICAgICAgICAgICogb3IgbG9nIGxvY2FsbHkuIE9yIHRocm93IGhhcmQuIEl0IGlzIGVudGlyZWx5IHVwIHRvIHlvdS5cbiAgICAgICAgICAgICAqIHRocm93IGV4Y2VwdGlvbjtcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgICAgICogICAgIHRocm93IHsgbWVzc2FnZTogJ2Vycm9yIG1lc3NhZ2Ugd2UgYWRkZWQnIH07XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihleGNlcHRpb24ubWVzc2FnZSwgZXJyb3JEYXRhKTtcbiAgICAgICAgfTtcbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicpXG4gICAgICAgIC5mYWN0b3J5KCdleGNlcHRpb24nLCBleGNlcHRpb24pO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gZXhjZXB0aW9uKCRxLCBsb2dnZXIpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBjYXRjaGVyOiBjYXRjaGVyXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGNhdGNoZXIobWVzc2FnZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhyb3duRGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgdmFyIG5ld01lc3NhZ2U7XG4gICAgICAgICAgICAgICAgaWYgKGUuZGF0YSAmJiBlLmRhdGEuZGVzY3JpcHRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3duRGVzY3JpcHRpb24gPSAnXFxuJyArIGUuZGF0YS5kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgbmV3TWVzc2FnZSA9IG1lc3NhZ2UgKyB0aHJvd25EZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZS5kYXRhLmRlc2NyaXB0aW9uID0gbmV3TWVzc2FnZTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IobmV3TWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmxvZ2dlcicpXG4gICAgICAgIC5mYWN0b3J5KCdsb2dnZXInLCBsb2dnZXIpO1xuXG4gICAgbG9nZ2VyLiRpbmplY3QgPSBbJyRsb2cnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGxvZ2dlcigkbG9nLCB0b2FzdHIpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBlcnJvciAgIDogZXJyb3IsXG4gICAgICAgICAgICBpbmZvICAgIDogaW5mbyxcbiAgICAgICAgICAgIHN1Y2Nlc3MgOiBzdWNjZXNzLFxuICAgICAgICAgICAgd2FybmluZyA6IHdhcm5pbmcsXG5cbiAgICAgICAgICAgIC8vIHN0cmFpZ2h0IHRvIGNvbnNvbGU7IGJ5cGFzcyB0b2FzdHJcbiAgICAgICAgICAgIGxvZyAgICAgOiAkbG9nLmxvZ1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLmVycm9yKCdFcnJvcjogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaW5mbyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgY29uc29sZS5pbmZvKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuaW5mbygnSW5mbzogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5pbmZvKCdTdWNjZXNzOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB3YXJuaW5nKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4obWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy53YXJuKCdXYXJuaW5nOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cbiAgICB9XG59KCkpO1xuIiwiLyogSGVscCBjb25maWd1cmUgdGhlIHN0YXRlLWJhc2UgdWkucm91dGVyICovXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3Mucm91dGVyJylcbiAgICAgICAgLnByb3ZpZGVyKCdyb3V0ZXJIZWxwZXInLCByb3V0ZXJIZWxwZXJQcm92aWRlcik7XG5cbiAgICByb3V0ZXJIZWxwZXJQcm92aWRlci4kaW5qZWN0ID0gWyckbG9jYXRpb25Qcm92aWRlcicsICckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiByb3V0ZXJIZWxwZXJQcm92aWRlcigkbG9jYXRpb25Qcm92aWRlciwgJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgIGRvY1RpdGxlOiB1bmRlZmluZWQsXG4gICAgICAgICAgICByZXNvbHZlQWx3YXlzOiB7fVxuICAgICAgICB9O1xuXG4gICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh7XG4gICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgcmVxdWlyZUJhc2U6IGZhbHNlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuY29uZmlndXJlID0gZnVuY3Rpb24oY2ZnKSB7XG4gICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChjb25maWcsIGNmZyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy4kZ2V0ID0gUm91dGVySGVscGVyO1xuICAgICAgICBSb3V0ZXJIZWxwZXIuJGluamVjdCA9IFsnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCAnJHN0YXRlJywgJ2xvZ2dlciddO1xuICAgICAgICAvKiBAbmdJbmplY3QgKi9cbiAgICAgICAgZnVuY3Rpb24gUm91dGVySGVscGVyKCRsb2NhdGlvbiwgJHJvb3RTY29wZSwgJHN0YXRlLCBsb2dnZXIpIHtcbiAgICAgICAgICAgIHZhciBoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBoYXNPdGhlcndpc2UgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzdGF0ZUNvdW50cyA9IHtcbiAgICAgICAgICAgICAgICBlcnJvcnM6IDAsXG4gICAgICAgICAgICAgICAgY2hhbmdlczogMFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICAgICAgY29uZmlndXJlU3RhdGVzOiBjb25maWd1cmVTdGF0ZXMsXG4gICAgICAgICAgICAgICAgZ2V0U3RhdGVzOiBnZXRTdGF0ZXMsXG4gICAgICAgICAgICAgICAgc3RhdGVDb3VudHM6IHN0YXRlQ291bnRzXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlU3RhdGVzKHN0YXRlcywgb3RoZXJ3aXNlUGF0aCkge1xuICAgICAgICAgICAgICAgIHN0YXRlcy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmNvbmZpZy5yZXNvbHZlID1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHN0YXRlLmNvbmZpZy5yZXNvbHZlIHx8IHt9LCBjb25maWcucmVzb2x2ZUFsd2F5cyk7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKHN0YXRlLnN0YXRlLCBzdGF0ZS5jb25maWcpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChvdGhlcndpc2VQYXRoICYmICFoYXNPdGhlcndpc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaGFzT3RoZXJ3aXNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZShvdGhlcndpc2VQYXRoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVJvdXRpbmdFcnJvcnMoKSB7XG4gICAgICAgICAgICAgICAgLy8gUm91dGUgY2FuY2VsbGF0aW9uOlxuICAgICAgICAgICAgICAgIC8vIE9uIHJvdXRpbmcgZXJyb3IsIGdvIHRvIHRoZSBkYXNoYm9hcmQuXG4gICAgICAgICAgICAgICAgLy8gUHJvdmlkZSBhbiBleGl0IGNsYXVzZSBpZiBpdCB0cmllcyB0byBkbyBpdCB0d2ljZS5cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlRXJyb3InLFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcywgZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50cy5lcnJvcnMrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVzdGluYXRpb24gPSAodG9TdGF0ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0b1N0YXRlLnRpdGxlIHx8IHRvU3RhdGUubmFtZSB8fCB0b1N0YXRlLmxvYWRlZFRlbXBsYXRlVXJsKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndW5rbm93biB0YXJnZXQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1zZyA9ICdFcnJvciByb3V0aW5nIHRvICcgKyBkZXN0aW5hdGlvbiArICcuICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChlcnJvci5kYXRhIHx8ICcnKSArICcuIDxici8+JyArIChlcnJvci5zdGF0dXNUZXh0IHx8ICcnKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzogJyArIChlcnJvci5zdGF0dXMgfHwgJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcobXNnLCBbdG9TdGF0ZV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlUm91dGluZ0Vycm9ycygpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZURvY1RpdGxlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHsgcmV0dXJuICRzdGF0ZS5nZXQoKTsgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVEb2NUaXRsZSgpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50cy5jaGFuZ2VzKys7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IGNvbmZpZy5kb2NUaXRsZSArICcgJyArICh0b1N0YXRlLnRpdGxlIHx8ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUudGl0bGUgPSB0aXRsZTsgLy8gZGF0YSBiaW5kIHRvIDx0aXRsZT5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycsIFsnYXBwLmNvcmUnXSk7XG5cbn0pICgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxhYi5wcm9kdWN0cycsIFsnYXBwLmNvcmUnXSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmhvbWVwYWdlJywgW1xuICAgICdhcHAuY29yZSdcbiAgXSk7XG5cbn0pICgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxhYicsIFtcbiAgICAnYXBwLmNvcmUnLFxuICAgICdhcHAubGFiLnByb2R1Y3RzJyxcbiAgICAnYXBwLmxhYi5hdHRyaWJ1dGVzJ1xuICBdKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxheW91dCcsIFtcbiAgICAgICdhcHAuY29yZSdcbiAgICBdKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5ob21lcGFnZScpLmNvbnRyb2xsZXIoJ0hvbWVDb250cm9sbGVyJywgSG9tZUNvbnRyb2xsZXIpO1xuXG4gIGZ1bmN0aW9uIEhvbWVDb250cm9sbGVyKCnCoHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLnRpdGxlID0gJ0hvbWVwYWdlJztcbiAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5ob21lcGFnZScpXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcblxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2hvbWVwYWdlJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnLycsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2hvbWVwYWdlL2hvbWVwYWdlLnZpZXcuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2hvbWUnLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWInKVxuICAgICAgICAuY29udHJvbGxlcignTGFiQ29udHJvbGxlcicsIExhYkNvbnRyb2xsZXIpO1xuXG4gICAgTGFiQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIExhYkNvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNob2ljZXMgPSB7fTtcbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGFiJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2xhYicsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2xhYi9sYWIudmlldy5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0xhYkNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsYWJWbScsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5IC0gTGFiJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAubGF5b3V0JylcbiAgICAgICAgICAuY29udHJvbGxlcignSGVhZGVyQ29udHJvbGxlcicsIEhlYWRlckNvbnRyb2xsZXIpO1xuXG4gICAgSGVhZGVyQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEhlYWRlckNvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICB2YXIgdm0gPSB0aGlzO1xuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdBdHRyaWJ1dGVzQ29udHJvbGxlcicsIEF0dHJpYnV0ZXNDb250cm9sbGVyKTtcblxuICAgIEF0dHJpYnV0ZXNDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICckc3RhdGUnXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBBdHRyaWJ1dGVzQ29udHJvbGxlcigkc2NvcGUsICRzdGF0ZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5nZXRGb3JtID0gZ2V0Rm9ybTtcbiAgICAgICAgdm0uY2hvaWNlVmFsaWRhdGUgPSBjaG9pY2VWYWxpZGF0ZTtcblxuICAgICAgICBhY3RpdmF0ZSgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICAgIGlmICh0eXBlb2YgJHNjb3BlLmxhYlZtLmNob2ljZXMucHJvZHVjdCA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdsYWIucHJvZHVjdHMnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2bS5hdHRyaWJ1dGVzID0gJHNjb3BlLmxhYlZtLmNob2ljZXMucHJvZHVjdC5hdHRyaWJ1dGVzO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0Rm9ybShhdHRyaWJ1dGUpIHtcbiAgICAgICAgICByZXR1cm4gXCJhcHAvbGFiL2F0dHJpYnV0ZXMvZm9ybXMvXCIgKyBhdHRyaWJ1dGUuZm9ybSArIFwiL1wiICsgIGF0dHJpYnV0ZS5mb3JtICsgXCIudmlldy5odG1sXCI7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjaG9pY2VWYWxpZGF0ZShhdHRyaWJ1dGUpIHtcbiAgICAgICAgICByZXR1cm4gdHlwZW9mICRzY29wZS5sYWJWbS5jaG9pY2VzW2F0dHJpYnV0ZS5uYW1lXSAhPT0gXCJ1bmRlZmluZWRcIjtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcblxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xhYi5hdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2F0dHJpYnV0ZXMnLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSAtIGF0dHJpYnV0ZXMnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQXR0cmlidXRlc0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdhdHRyaWJ1dGVzVm0nLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9sYWIvYXR0cmlidXRlcy9hdHRyaWJ1dGVzLnZpZXcuaHRtbCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnKVxuICAgICAgICAuY29udHJvbGxlcignUHJvZHVjdHNDb250cm9sbGVyJywgUHJvZHVjdHNDb250cm9sbGVyKTtcblxuICAgIFByb2R1Y3RzQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHN0YXRlJywgJ2RhdGFzZXJ2aWNlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBQcm9kdWN0c0NvbnRyb2xsZXIoJHNjb3BlLCAkc3RhdGUsIGRhdGFzZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0uc2VsZWN0ID0gc2VsZWN0O1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgZGF0YXNlcnZpY2UucmVhZHkoKS50aGVuKGdldFByb2R1Y3RzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2R1Y3RzKCkge1xuICAgICAgICAgIHZtLnByb2R1Y3RzID0gZGF0YXNlcnZpY2UuZ2V0UHJvZHVjdHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdChwcm9kdWN0KSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXMucHJvZHVjdCA9IHByb2R1Y3Q7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLnByb2R1Y3RzJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGFiLnByb2R1Y3RzJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3Byb2R1Y3RzJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBwcm9kdWN0cycsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9kdWN0c0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdwcm9kdWN0c1ZtJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLnZpZXcuaHRtbCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdCdG5SYWRpb0NvbnRyb2xsZXInLCBCdG5SYWRpb0NvbnRyb2xsZXIpO1xuXG4gICAgQnRuUmFkaW9Db250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gQnRuUmFkaW9Db250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5jaG9pY2UgPSBudWxsO1xuICAgICAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XG5cblxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xuICAgICAgICAgIHZtLmNob2ljZSA9IGF0dHJpYnV0ZUNob2ljZWQ7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gYXR0cmlidXRlQ2hvaWNlZDtcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0NoZWNrYm94Q29udHJvbGxlcicsIENoZWNrYm94Q29udHJvbGxlcik7XG5cbiAgICBDaGVja2JveENvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBDaGVja2JveENvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNob2ljZXMgPSBbXTtcbiAgICAgICAgdm0uZXhpc3RzID0gZXhpc3RzO1xuICAgICAgICB2bS50b2dnbGUgPSB0b2dnbGU7XG4gICAgICAgIHZtLnNhdmVDaG9pY2VzID0gc2F2ZUNob2ljZXM7XG5cbiAgICAgICAgZnVuY3Rpb24gZXhpc3RzKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHZtLmNob2ljZXMuaW5kZXhPZih2YWx1ZSkgPiAtMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHRvZ2dsZSh2YWx1ZSkge1xuICAgICAgICAgIHZhciBpZHggPSB2bS5jaG9pY2VzLmluZGV4T2YodmFsdWUpO1xuICAgICAgICAgIGlmIChpZHggPiAtMSkge1xuICAgICAgICAgICAgdm0uY2hvaWNlcy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdm0uY2hvaWNlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZUNob2ljZXMoKSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gdm0uY2hvaWNlcztcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0NvbG9yQ29udHJvbGxlcicsIENvbG9yQ29udHJvbGxlcik7XG5cbiAgICBDb2xvckNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBDb2xvckNvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XG4gICAgICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcbiAgICAgICAgdm0uc2V0T3BhY2l0eSA9IHNldE9wYWNpdHk7XG4gICAgICAgIHZtLnNhdmVDaG9pY2UgPSBzYXZlQ2hvaWNlO1xuICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xuXG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcbiAgICAgICAgICBpZiAodm0uY2hvaWNlKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9ybS1jb2xvci0nICsgdm0uY2hvaWNlKS5zdHlsZS5vcGFjaXR5ID0gMTtcbiAgICAgICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZtLmNob2ljZSA9IGF0dHJpYnV0ZUNob2ljZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzYXZlQ2hvaWNlKCkge1xuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IHt2YWx1ZTogdm0uY2hvaWNlLCBwZXJjZW50OiB2bS5wZXJjZW50fTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldE9wYWNpdHkoKSB7XG4gICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvcm0tY29sb3ItJyArIHZtLmNob2ljZSkuc3R5bGUub3BhY2l0eSA9IHZtLnBlcmNlbnQgLyAxMDA7XG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAuY29udHJvbGxlcignSW1nUmFkaW9Db250cm9sbGVyJywgSW1nUmFkaW9Db250cm9sbGVyKTtcblxuICBJbWdSYWRpb0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgLyogQG5nSW5qZWN0ICovXG4gIGZ1bmN0aW9uIEltZ1JhZGlvQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICB2YXIgdm0gPSB0aGlzO1xuICAgIHZtLmNob2ljZSA9IG51bGw7XG4gICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xuXG5cbiAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xuICAgICAgdm0uY2hvaWNlID0gYXR0cmlidXRlQ2hvaWNlZDtcbiAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IGF0dHJpYnV0ZUNob2ljZWQ7XG4gICAgfVxuXG4gIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdJbnB1dFRleHRDb250cm9sbGVyJywgSW5wdXRUZXh0Q29udHJvbGxlcik7XG5cbiAgICBJbnB1dFRleHRDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gSW5wdXRUZXh0Q29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xuXG4gICAgICAgIGZ1bmN0aW9uIHNldENob2ljZSgpIHtcbiAgICAgICAgICBpZiAodm0uY2hvaWNlICE9PSBcIlwiICYmIHZtLmNob2ljZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gdm0uY2hvaWNlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdSYWRpb1NsaWRlckNvbnRyb2xsZXInLCBSYWRpb1NsaWRlckNvbnRyb2xsZXIpO1xuXG4gICAgUmFkaW9TbGlkZXJDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gUmFkaW9TbGlkZXJDb250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5jaG9pY2UgPSBudWxsO1xuICAgICAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XG4gICAgICAgIHZtLnNhdmVDaG9pY2UgPSBzYXZlQ2hvaWNlO1xuICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xuXG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcbiAgICAgICAgICBpZiAodm0uY2hvaWNlKSB7XG4gICAgICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZUNob2ljZSgpIHtcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB7dmFsdWU6IHZtLmNob2ljZSwgcGVyY2VudDogdm0ucGVyY2VudH07XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
