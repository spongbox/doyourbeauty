!function(){"use strict";angular.module("app",["app.core","app.lab","app.homepage","app.layout"])}(),function(){"use strict";angular.module("app.core",["ngAnimate","ngSanitize","blocks.exception","blocks.logger","blocks.router","ui.router","ngMaterial","duScroll"])}(),function(){"use strict";function t(t,e,r){t.debugEnabled&&t.debugEnabled(!0),r.configure(o.appErrorPrefix),e.configure({docTitle:o.appTitle+": "})}var e=angular.module("app.core"),o={appErrorPrefix:"[<%= appName %> Error] ",appTitle:"<%= appName %>"};e.value("config",o),e.config(t),t.$inject=["$logProvider","routerHelperProvider","exceptionHandlerProvider"]}(),function(){"use strict";function t(t){var o="/404";t.configureStates(e(),o)}function e(){return[{state:"404",config:{url:"/404",templateUrl:"app/core/404.html",title:"404"}}]}t.$inject=["routerHelper"],angular.module("app.core").run(t)}(),function(){"use strict";function t(t,e,o,r){function n(){return a.products}function c(){return i.then(function(t){return a=t.data,!0},function(){return r.error("Impossible de récupérer les données"),!1})}var u="/ressources/products.json",i=t.get(u),a=null,l={ready:c,getProducts:n};return l}angular.module("app.core").factory("dataservice",t),t.$inject=["$http","$q","exception","logger"]}(),function(){"use strict";function t(){return function(t,e){for(var o=0,r=t.length;r>o;o++)if(t[o].value==e||t[o].name==e)return t[o];return null}}angular.module("app.core").filter("getByName",t)}(),function(){"use strict";angular.module("blocks.exception",["blocks.logger"])}(),function(){"use strict";angular.module("blocks.logger",[])}(),function(){"use strict";angular.module("blocks.router",["ui.router","blocks.logger"])}(),function(){"use strict";function t(){this.config={appErrorPrefix:void 0},this.configure=function(t){this.config.appErrorPrefix=t},this.$get=function(){return{config:this.config}}}function e(t){t.decorator("$exceptionHandler",o)}function o(t,e,o){return function(r,n){var c=e.config.appErrorPrefix||"",u={exception:r,cause:n};r.message=c+r.message,t(r,n),o.error(r.message,u)}}angular.module("blocks.exception").provider("exceptionHandler",t).config(e),e.$inject=["$provide"],o.$inject=["$delegate","exceptionHandler","logger"]}(),function(){"use strict";function t(t,e){function o(o){return function(r){var n,c;return r.data&&r.data.description&&(n="\n"+r.data.description,c=o+n),r.data.description=c,e.error(c),t.reject(r)}}var r={catcher:o};return r}t.$inject=["$q","logger"],angular.module("blocks.exception").factory("exception",t)}(),function(){"use strict";function t(t,e){function o(e,o,r){console.error(e,r),t.error("Error: "+e,o)}function r(e,o,r){console.info(e,r),t.info("Info: "+e,o)}function n(e,o,r){console.log(e,r),t.info("Success: "+e,o)}function c(e,o,r){console.warn(e,r),t.warn("Warning: "+e,o)}var u={error:o,info:r,success:n,warning:c,log:t.log};return u}angular.module("blocks.logger").factory("logger",t),t.$inject=["$log"]}(),function(){"use strict";function t(t,e,o){function r(t,r,c,u){function i(t,r){t.forEach(function(t){t.config.resolve=angular.extend(t.config.resolve||{},n.resolveAlways),e.state(t.state,t.config)}),r&&!g&&(g=!0,o.otherwise(r))}function a(){r.$on("$stateChangeError",function(e,o,r,n,c,i){if(!f){m.errors++,f=!0;var a=o&&(o.title||o.name||o.loadedTemplateUrl)||"unknown target",l="Error routing to "+a+". "+(i.data||"")+". <br/>"+(i.statusText||"")+": "+(i.status||"");u.warning(l,[o]),t.path("/")}})}function l(){a(),p()}function s(){return c.get()}function p(){r.$on("$stateChangeSuccess",function(t,e,o,c,u){m.changes++,f=!1;var i=n.docTitle+" "+(e.title||"");r.title=i})}var f=!1,g=!1,m={errors:0,changes:0},d={configureStates:i,getStates:s,stateCounts:m};return l(),d}var n={docTitle:void 0,resolveAlways:{}};t.html5Mode({enabled:!1,requireBase:!1}),this.configure=function(t){angular.extend(n,t)},this.$get=r,r.$inject=["$location","$rootScope","$state","logger"]}angular.module("blocks.router").provider("routerHelper",t),t.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}(),function(){"use strict";angular.module("app.lab.attributes",["app.core"])}(),function(){angular.module("app.lab.products",["app.core"])}(),function(){"use strict";angular.module("app.homepage",["app.core"])}(),function(){angular.module("app.lab",["app.core","app.lab.products","app.lab.attributes"])}(),function(){"use strict";angular.module("app.layout",["app.core"])}(),function(){"use strict";function t(){var t=this;t.title="Homepage"}angular.module("app.homepage").controller("HomeController",t)}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"homepage",config:{url:"/",templateUrl:"app/homepage/homepage.view.html",controller:"HomeController",controllerAs:"home",title:"DoYourBeauty"}}]}angular.module("app.homepage").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){var e=this;e.choices={}}angular.module("app.lab").controller("LabController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab",config:{url:"/lab",templateUrl:"app/lab/lab.view.html",controller:"LabController",controllerAs:"labVm",title:"DoYourBeauty - Lab"}}]}angular.module("app.lab").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e,o,r,n,c){function u(){return"undefined"==typeof t.labVm.choices.product?void e.go("lab.products"):(r.smallHeader=!0,m.product=t.labVm.choices.product,m.attributes=o("orderBy")(m.product.attributes,"order"),void(m.current=m.attributes[0]))}function i(t){return"app/lab/attributes/forms/"+t.form+"/"+t.form+".view.html"}function a(t){return"app/lab/attributes/results/"+t.name+"/"+t.name+".view.html"}function l(e){return"undefined"!=typeof t.labVm.choices[e.name]}function s(e){for(var o=0,r=!0,n=m.attributes[0];o<m.attributes.length&&r;){var u=angular.element(document.getElementById(m.attributes[o].name)),i=u.prop("offsetTop")-m.offset-5,a=u.prop("offsetTop")+u[0].offsetHeight-m.offset-5;c.scrollTop()>=i&&(c.scrollTop()<=a?(m.current=m.attributes[o],r=!1):n=m.attributes[o+1]),o++}r&&(m.current=n),t.$apply()}function p(t){t.name!==m.current.name&&g(document.querySelector("#"+t.name))}function f(t){var e=angular.element(t).next();g(e[0])}function g(t){c.scrollToElement(t,m.offset,1e3)}var m=this;m.product=null,m.attributes=[],m.offset=218,m.getForm=i,m.getResultView=a,m.choiceValidate=l,m.render=p,m.goToNext=f,n.addEventListener("scroll",s),u(),t.$on("$destroy",function(){n.removeEventListener("scroll",s)})}angular.module("app.lab.attributes").controller("AttributesController",t),t.$inject=["$scope","$state","$filter","$rootScope","$window","$document"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab.attributes",config:{url:"/attributes",title:"DoYourBeauty - attributes",controller:"AttributesController",controllerAs:"attributesVm",templateUrl:"app/lab/attributes/attributes.view.html"}}]}angular.module("app.lab.attributes").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e,o){function r(){o.ready().then(n)}function n(){u.products=o.getProducts()}function c(e){t.labVm.choices.product=e}var u=this;u.select=c,r()}angular.module("app.lab.products").controller("ProductsController",t),t.$inject=["$scope","$state","dataservice"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab.products",config:{url:"/products",title:"DoYourBeauty - products",controller:"ProductsController",controllerAs:"productsVm",templateUrl:"app/lab/products/products.view.html"}}]}angular.module("app.lab.products").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e){function o(e){n.choice=e,t.labVm.choices[n.attribute.name]=e,r(n.choice.img),t.attributesVm.goToNext(document.querySelector("#"+n.attribute.name))}function r(t){n.attribute.haveImgPreview&&(n.imgPreview=t)}var n=this;n.choice=null,n.imgPreview=null,n.setChoice=o,n.setImgPreview=r}angular.module("app.lab.attributes").controller("BtnRadioController",t),t.$inject=["$scope","$filter"]}(),function(){"use strict";function t(t){function e(t){return n.choices.indexOf(t)>-1}function o(t){var e=n.choices.indexOf(t);e>-1?n.choices.splice(e,1):n.choices.push(t)}function r(){t.labVm.choices[n.attribute.name]=n.choices,t.attributesVm.goToNext(document.querySelector("#"+n.attribute.name))}var n=this;n.choices=[],n.exists=e,n.toggle=o,n.saveChoices=r}angular.module("app.lab.attributes").controller("CheckboxController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(t){n.choice&&(document.getElementById("form-color-"+n.choice).style.opacity=1,n.percent=100),n.choice=t}function o(){t.labVm.choices[n.attribute.name]={value:n.choice,percent:n.percent},t.attributesVm.goToNext(document.querySelector("#"+n.attribute.name))}function r(){document.getElementById("form-color-"+n.choice).style.opacity=n.percent/100}var n=this,n=this;n.choice=null,n.setChoice=e,n.setOpacity=r,n.saveChoice=o,n.percent=100}angular.module("app.lab.attributes").controller("ColorController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(){""!==o.choice&&null!==o.choice?(t.labVm.choices[o.attribute.name]=o.choice,t.attributesVm.goToNext(document.querySelector("#"+o.attribute.name))):delete t.labVm.choices[o.attribute.name]}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("InputTextController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(t){r.choice&&(r.percent=100),r.choice=t}function o(){t.labVm.choices[r.attribute.name]={value:r.choice,percent:r.percent},t.attributesVm.goToNext(document.querySelector("#"+r.attribute.name))}var r=this,r=this;r.choice=null,r.setChoice=e,r.saveChoice=o,r.percent=100}angular.module("app.lab.attributes").controller("RadioSliderController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(e){o.choice=e,t.labVm.choices[o.attribute.name]=e,t.attributesVm.goToNext(document.querySelector("#"+o.attribute.name))}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("ImgRadioController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){}angular.module("app.lab.attributes").controller("CreamController",t),t.$inject=["$scope"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjb3JlLm1vZHVsZS5qcyIsImNvbmZpZy5qcyIsImNvcmUucm91dGUuanMiLCJhcHAubWluLmpzIiwiZGF0YXNlcnZpY2UuanMiLCJnZXRieW5hbWUuZmlsdGVyLmpzIiwiZXhjZXB0aW9uL2V4Y2VwdGlvbi5tb2R1bGUuanMiLCJsb2dnZXIvbG9nZ2VyLm1vZHVsZS5qcyIsInJvdXRlci9yb3V0ZXIubW9kdWxlLmpzIiwiZXhjZXB0aW9uL2V4Y2VwdGlvbi1oYW5kbGVyLnByb3ZpZGVyLmpzIiwiZXhjZXB0aW9uL2V4Y2VwdGlvbi5qcyIsImxvZ2dlci9sb2dnZXIuanMiLCJyb3V0ZXIvcm91dGVyLWhlbHBlci5wcm92aWRlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2F0dHJpYnV0ZXMubW9kdWxlLmpzIiwibGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLm1vZHVsZS5qcyIsImhvbWVwYWdlL2hvbWVwYWdlLm1vZHVsZS5qcyIsImxhYi9sYWIubW9kdWxlLmpzIiwibGF5b3V0L2xheW91dC5tb2R1bGUuanMiLCJob21lcGFnZS9ob21lcGFnZS5jb250cm9sbGVyLmpzIiwiaG9tZXBhZ2UvaG9tZXBhZ2Uucm91dGUuanMiLCJsYWIvbGFiLmNvbnRyb2xsZXIuanMiLCJsYWIvbGFiLnJvdXRlLmpzIiwibGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy5jb250cm9sbGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy5yb3V0ZS5qcyIsImxhYi9wcm9kdWN0cy9wcm9kdWN0cy5jb250cm9sbGVyLmpzIiwibGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLnJvdXRlLmpzIiwibGFiL2F0dHJpYnV0ZXMvZm9ybXMvYnRuLXJhZGlvL2J0bi1yYWRpby5jb250cm9sbGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvZm9ybXMvY2hlY2tib3gvY2hlY2tib3guY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2Zvcm1zL2NvbG9yL2NvbG9yLmNvbnRyb2xsZXIuanMiLCJsYWIvYXR0cmlidXRlcy9mb3Jtcy9pbnB1dC10ZXh0L2lucHV0LXRleHQuY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2Zvcm1zL3JhZGlvLXNsaWRlci9yYWRpby1zbGlkZXIuY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2Zvcm1zL2ltZy1yYWRpby9pbWctcmFkaW8uY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL3Jlc3VsdHMvY3JlYW0vY3JlYW0uY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlndXJlIiwiJGxvZ1Byb3ZpZGVyIiwicm91dGVySGVscGVyUHJvdmlkZXIiLCJleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIiLCJkZWJ1Z0VuYWJsZWQiLCJjb25maWciLCJhcHBFcnJvclByZWZpeCIsImRvY1RpdGxlIiwiYXBwVGl0bGUiLCJjb3JlIiwidmFsdWUiLCIkaW5qZWN0IiwiYXBwUnVuIiwicm91dGVySGVscGVyIiwib3RoZXJ3aXNlIiwiY29uZmlndXJlU3RhdGVzIiwiZ2V0U3RhdGVzIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsInRpdGxlIiwicnVuIiwiZGF0YXNlcnZpY2UiLCIkaHR0cCIsIiRxIiwiZXhjZXB0aW9uIiwibG9nZ2VyIiwiZ2V0UHJvZHVjdHMiLCJkYXRhIiwicHJvZHVjdHMiLCJyZWFkeSIsInByb21pc2UiLCJ0aGVuIiwicmVzdWx0IiwiZXJyb3IiLCJqc29uVVJMIiwiZ2V0Iiwic2VydmljZSIsImZhY3RvcnkiLCJnZXRCeU5hbWUiLCJpbnB1dCIsIm5hbWUiLCJpIiwibGVuZ3RoIiwiZmlsdGVyIiwidGhpcyIsInVuZGVmaW5lZCIsIiRnZXQiLCIkcHJvdmlkZSIsImRlY29yYXRvciIsImV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIiLCIkZGVsZWdhdGUiLCJleGNlcHRpb25IYW5kbGVyIiwiY2F1c2UiLCJlcnJvckRhdGEiLCJtZXNzYWdlIiwicHJvdmlkZXIiLCJjYXRjaGVyIiwiZSIsInRocm93bkRlc2NyaXB0aW9uIiwibmV3TWVzc2FnZSIsImRlc2NyaXB0aW9uIiwicmVqZWN0IiwiJGxvZyIsInRvYXN0ciIsImNvbnNvbGUiLCJpbmZvIiwic3VjY2VzcyIsImxvZyIsIndhcm5pbmciLCJ3YXJuIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIlJvdXRlckhlbHBlciIsIiRsb2NhdGlvbiIsIiRyb290U2NvcGUiLCIkc3RhdGUiLCJzdGF0ZXMiLCJvdGhlcndpc2VQYXRoIiwiZm9yRWFjaCIsInJlc29sdmUiLCJleHRlbmQiLCJyZXNvbHZlQWx3YXlzIiwiaGFzT3RoZXJ3aXNlIiwiaGFuZGxlUm91dGluZ0Vycm9ycyIsIiRvbiIsImV2ZW50IiwidG9TdGF0ZSIsInRvUGFyYW1zIiwiZnJvbVN0YXRlIiwiZnJvbVBhcmFtcyIsImhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciIsInN0YXRlQ291bnRzIiwiZXJyb3JzIiwiZGVzdGluYXRpb24iLCJsb2FkZWRUZW1wbGF0ZVVybCIsIm1zZyIsInN0YXR1c1RleHQiLCJzdGF0dXMiLCJwYXRoIiwiaW5pdCIsInVwZGF0ZURvY1RpdGxlIiwiY2hhbmdlcyIsImh0bWw1TW9kZSIsImVuYWJsZWQiLCJyZXF1aXJlQmFzZSIsImNmZyIsIkhvbWVDb250cm9sbGVyIiwidm0iLCJjb250cm9sbGVyIiwiY29udHJvbGxlckFzIiwiTGFiQ29udHJvbGxlciIsIiRzY29wZSIsImNob2ljZXMiLCJBdHRyaWJ1dGVzQ29udHJvbGxlciIsIiRmaWx0ZXIiLCIkd2luZG93IiwiJGRvY3VtZW50IiwiYWN0aXZhdGUiLCJsYWJWbSIsInByb2R1Y3QiLCJnbyIsInNtYWxsSGVhZGVyIiwiYXR0cmlidXRlcyIsImN1cnJlbnQiLCJnZXRGb3JtIiwiYXR0cmlidXRlIiwiZm9ybSIsImdldFJlc3VsdFZpZXciLCJjaG9pY2VWYWxpZGF0ZSIsImNoZWNrUG9zIiwibm90Rm91bmQiLCJsYXN0QXR0cmlidXRlIiwiZWxlbW50IiwiZWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJwb3NTdGFydCIsInByb3AiLCJvZmZzZXQiLCJwb3NFbmQiLCJvZmZzZXRIZWlnaHQiLCJzY3JvbGxUb3AiLCIkYXBwbHkiLCJyZW5kZXIiLCJnb1RvIiwicXVlcnlTZWxlY3RvciIsImdvVG9OZXh0IiwibmV4dEVsbW50IiwibmV4dCIsImVsbW50Iiwic2Nyb2xsVG9FbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJQcm9kdWN0c0NvbnRyb2xsZXIiLCJzZWxlY3QiLCJCdG5SYWRpb0NvbnRyb2xsZXIiLCJzZXRDaG9pY2UiLCJhdHRyaWJ1dGVDaG9pY2VkIiwiY2hvaWNlIiwic2V0SW1nUHJldmlldyIsImltZyIsImF0dHJpYnV0ZXNWbSIsImhhdmVJbWdQcmV2aWV3IiwiaW1nUHJldmlldyIsIkNoZWNrYm94Q29udHJvbGxlciIsImV4aXN0cyIsImluZGV4T2YiLCJ0b2dnbGUiLCJpZHgiLCJzcGxpY2UiLCJwdXNoIiwic2F2ZUNob2ljZXMiLCJDb2xvckNvbnRyb2xsZXIiLCJzdHlsZSIsIm9wYWNpdHkiLCJwZXJjZW50Iiwic2F2ZUNob2ljZSIsInNldE9wYWNpdHkiLCJJbnB1dFRleHRDb250cm9sbGVyIiwiUmFkaW9TbGlkZXJDb250cm9sbGVyIiwiSW1nUmFkaW9Db250cm9sbGVyIiwiQ3JlYW1Db250cm9sbGVyIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUNBLFlBRUFBLFNBQUFDLE9BQUEsT0FDQSxXQUNBLFVBQ0EsZUFDQSxrQkNQQSxXQUNBLFlBRUFELFNBQ0FDLE9BQUEsWUFDQSxZQUFBLGFBQ0EsbUJBQUEsZ0JBQUEsZ0JBQ0EsWUFBQSxhQUFBLGdCQ1BBLFdBQ0EsWUFjQSxTQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxHQUNBRixFQUFBRyxjQUNBSCxFQUFBRyxjQUFBLEdBRUFELEVBQUFILFVBQUFLLEVBQUFDLGdCQUNBSixFQUFBRixXQUFBTyxT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OiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xyXG4gICAgICAgICdhcHAuY29yZScsXHJcbiAgICAgICAgJ2FwcC5sYWInLFxyXG4gICAgICAgICdhcHAuaG9tZXBhZ2UnLFxyXG4gICAgICAgICdhcHAubGF5b3V0J1xyXG4gICAgXSk7XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuY29yZScsIFtcclxuICAgICAgICAgICAgJ25nQW5pbWF0ZScsICduZ1Nhbml0aXplJyxcclxuICAgICAgICAgICAgJ2Jsb2Nrcy5leGNlcHRpb24nLCAnYmxvY2tzLmxvZ2dlcicsICdibG9ja3Mucm91dGVyJyxcclxuICAgICAgICAgICAgJ3VpLnJvdXRlcicsICduZ01hdGVyaWFsJywgJ2R1U2Nyb2xsJ1xyXG4gICAgICAgIF0pO1xyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBjb3JlID0gYW5ndWxhci5tb2R1bGUoJ2FwcC5jb3JlJyk7XHJcbiAgICB2YXIgY29uZmlnID0ge1xyXG4gICAgICAgIGFwcEVycm9yUHJlZml4OiAnWzwlPSBhcHBOYW1lICU+IEVycm9yXSAnLFxyXG4gICAgICAgIGFwcFRpdGxlOiAnPCU9IGFwcE5hbWUgJT4nXHJcbiAgICB9O1xyXG5cclxuICAgIGNvcmUudmFsdWUoJ2NvbmZpZycsIGNvbmZpZyk7XHJcblxyXG4gICAgY29yZS5jb25maWcoY29uZmlndXJlKTtcclxuXHJcbiAgICBjb25maWd1cmUuJGluamVjdCA9IFsnJGxvZ1Byb3ZpZGVyJywgJ3JvdXRlckhlbHBlclByb3ZpZGVyJywgJ2V4Y2VwdGlvbkhhbmRsZXJQcm92aWRlciddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBjb25maWd1cmUoJGxvZ1Byb3ZpZGVyLCByb3V0ZXJIZWxwZXJQcm92aWRlciwgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKSB7XHJcbiAgICAgICAgaWYgKCRsb2dQcm92aWRlci5kZWJ1Z0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgJGxvZ1Byb3ZpZGVyLmRlYnVnRW5hYmxlZCh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyLmNvbmZpZ3VyZShjb25maWcuYXBwRXJyb3JQcmVmaXgpO1xyXG4gICAgICAgIHJvdXRlckhlbHBlclByb3ZpZGVyLmNvbmZpZ3VyZSh7ZG9jVGl0bGU6IGNvbmZpZy5hcHBUaXRsZSArICc6ICd9KTtcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvcmUnKVxyXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcclxuICAgICAgICB2YXIgb3RoZXJ3aXNlID0gJy80MDQnO1xyXG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCksIG90aGVyd2lzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlOiAnNDA0JyxcclxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy80MDQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2NvcmUvNDA0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnNDA0J1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuICAgIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xyXG4gICAgICAgICdhcHAuY29yZScsXHJcbiAgICAgICAgJ2FwcC5sYWInLFxyXG4gICAgICAgICdhcHAuaG9tZXBhZ2UnLFxyXG4gICAgICAgICdhcHAubGF5b3V0J1xyXG4gICAgXSk7XHJcblxyXG59KSgpO1xyXG5cbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJywgW1xyXG4gICAgICAgICAgICAnbmdBbmltYXRlJywgJ25nU2FuaXRpemUnLFxyXG4gICAgICAgICAgICAnYmxvY2tzLmV4Y2VwdGlvbicsICdibG9ja3MubG9nZ2VyJywgJ2Jsb2Nrcy5yb3V0ZXInLFxyXG4gICAgICAgICAgICAndWkucm91dGVyJywgJ25nTWF0ZXJpYWwnLCAnZHVTY3JvbGwnXHJcbiAgICAgICAgXSk7XHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgY29yZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAuY29yZScpO1xyXG4gICAgdmFyIGNvbmZpZyA9IHtcclxuICAgICAgICBhcHBFcnJvclByZWZpeDogJ1s8JT0gYXBwTmFtZSAlPiBFcnJvcl0gJyxcclxuICAgICAgICBhcHBUaXRsZTogJzwlPSBhcHBOYW1lICU+J1xyXG4gICAgfTtcclxuXHJcbiAgICBjb3JlLnZhbHVlKCdjb25maWcnLCBjb25maWcpO1xyXG5cclxuICAgIGNvcmUuY29uZmlnKGNvbmZpZ3VyZSk7XHJcblxyXG4gICAgY29uZmlndXJlLiRpbmplY3QgPSBbJyRsb2dQcm92aWRlcicsICdyb3V0ZXJIZWxwZXJQcm92aWRlcicsICdleGNlcHRpb25IYW5kbGVyUHJvdmlkZXInXTtcclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gY29uZmlndXJlKCRsb2dQcm92aWRlciwgcm91dGVySGVscGVyUHJvdmlkZXIsIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcikge1xyXG4gICAgICAgIGlmICgkbG9nUHJvdmlkZXIuZGVidWdFbmFibGVkKSB7XHJcbiAgICAgICAgICAgICRsb2dQcm92aWRlci5kZWJ1Z0VuYWJsZWQodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlci5jb25maWd1cmUoY29uZmlnLmFwcEVycm9yUHJlZml4KTtcclxuICAgICAgICByb3V0ZXJIZWxwZXJQcm92aWRlci5jb25maWd1cmUoe2RvY1RpdGxlOiBjb25maWcuYXBwVGl0bGUgKyAnOiAnfSk7XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhcHBSdW4uJGluamVjdCA9IFtcInJvdXRlckhlbHBlclwiXTtcclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuY29yZScpXHJcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xyXG4gICAgICAgIHZhciBvdGhlcndpc2UgPSAnLzQwNCc7XHJcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSwgb3RoZXJ3aXNlKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6ICc0MDQnLFxyXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnLzQwNCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvY29yZS80MDQuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICc0MDQnXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgfVxyXG59KSgpO1xyXG5cbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJylcclxuICAgICAgICAuZmFjdG9yeSgnZGF0YXNlcnZpY2UnLCBkYXRhc2VydmljZSk7XHJcblxyXG4gICAgZGF0YXNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCAnJHEnLCAnZXhjZXB0aW9uJywgJ2xvZ2dlciddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBkYXRhc2VydmljZSgkaHR0cCwgJHEsIGV4Y2VwdGlvbiwgbG9nZ2VyKSB7XHJcbiAgICAgICAgdmFyIGpzb25VUkwgPSAnL3Jlc3NvdXJjZXMvcHJvZHVjdHMuanNvbic7XHJcbiAgICAgICAgdmFyIHByb21pc2UgPSAkaHR0cC5nZXQoanNvblVSTCk7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBudWxsO1xyXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgcmVhZHk6IHJlYWR5LFxyXG4gICAgICAgICAgZ2V0UHJvZHVjdHM6IGdldFByb2R1Y3RzXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2R1Y3RzKCkge1xyXG4gICAgICAgICAgcmV0dXJuIGRhdGEucHJvZHVjdHM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZWFkeSgpIHtcclxuICAgICAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSByZXN1bHQuZGF0YTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdJbXBvc3NpYmxlIGRlIHLDqWN1cMOpcmVyIGxlcyBkb25uw6llcycpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoKTtcclxuXG4oZnVuY3Rpb24gKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmNvcmUnKVxyXG4gICAgLmZpbHRlcignZ2V0QnlOYW1lJywgZ2V0QnlOYW1lKTtcclxuXHJcbiAgZnVuY3Rpb24gZ2V0QnlOYW1lKCkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0LCBuYW1lKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBpbnB1dC5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmIChpbnB1dFtpXS52YWx1ZSA9PSBuYW1lIHx8IGlucHV0W2ldLm5hbWUgPT0gbmFtZSkge1xyXG4gICAgICAgICAgcmV0dXJuIGlucHV0W2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9XHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJywgWydibG9ja3MubG9nZ2VyJ10pO1xyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYmxvY2tzLmxvZ2dlcicsIFtdKTtcclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Jsb2Nrcy5yb3V0ZXInLCBbXHJcbiAgICAgICAgJ3VpLnJvdXRlcicsXHJcbiAgICAgICAgJ2Jsb2Nrcy5sb2dnZXInXHJcbiAgICBdKTtcclxufSkoKTtcclxuXG4vLyBJbmNsdWRlIGluIGluZGV4Lmh0bWwgc28gdGhhdCBhcHAgbGV2ZWwgZXhjZXB0aW9ucyBhcmUgaGFuZGxlZC5cclxuLy8gRXhjbHVkZSBmcm9tIHRlc3RSdW5uZXIuaHRtbCB3aGljaCBzaG91bGQgcnVuIGV4YWN0bHkgd2hhdCBpdCB3YW50cyB0byBydW5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJylcclxuICAgICAgICAucHJvdmlkZXIoJ2V4Y2VwdGlvbkhhbmRsZXInLCBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIpXHJcbiAgICAgICAgLmNvbmZpZyhjb25maWcpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTXVzdCBjb25maWd1cmUgdGhlIGV4Y2VwdGlvbiBoYW5kbGluZ1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIoKSB7XHJcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXHJcbiAgICAgICAgdGhpcy5jb25maWcgPSB7XHJcbiAgICAgICAgICAgIGFwcEVycm9yUHJlZml4OiB1bmRlZmluZWRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uIChhcHBFcnJvclByZWZpeCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5hcHBFcnJvclByZWZpeCA9IGFwcEVycm9yUHJlZml4O1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuJGdldCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge2NvbmZpZzogdGhpcy5jb25maWd9O1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlnLiRpbmplY3QgPSBbJyRwcm92aWRlJ107XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25maWd1cmUgYnkgc2V0dGluZyBhbiBvcHRpb25hbCBzdHJpbmcgdmFsdWUgZm9yIGFwcEVycm9yUHJlZml4LlxyXG4gICAgICogQWNjZXNzaWJsZSB2aWEgY29uZmlnLmFwcEVycm9yUHJlZml4ICh2aWEgY29uZmlnIHZhbHVlKS5cclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gJHByb3ZpZGVcclxuICAgICAqL1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBjb25maWcoJHByb3ZpZGUpIHtcclxuICAgICAgICAkcHJvdmlkZS5kZWNvcmF0b3IoJyRleGNlcHRpb25IYW5kbGVyJywgZXh0ZW5kRXhjZXB0aW9uSGFuZGxlcik7XHJcbiAgICB9XHJcblxyXG4gICAgZXh0ZW5kRXhjZXB0aW9uSGFuZGxlci4kaW5qZWN0ID0gWyckZGVsZWdhdGUnLCAnZXhjZXB0aW9uSGFuZGxlcicsICdsb2dnZXInXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4dGVuZCB0aGUgJGV4Y2VwdGlvbkhhbmRsZXIgc2VydmljZSB0byBhbHNvIGRpc3BsYXkgYSB0b2FzdC5cclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gJGRlbGVnYXRlXHJcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGV4Y2VwdGlvbkhhbmRsZXJcclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gbG9nZ2VyXHJcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gdGhlIGRlY29yYXRlZCAkZXhjZXB0aW9uSGFuZGxlciBzZXJ2aWNlXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIoJGRlbGVnYXRlLCBleGNlcHRpb25IYW5kbGVyLCBsb2dnZXIpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZXhjZXB0aW9uLCBjYXVzZSkge1xyXG4gICAgICAgICAgICB2YXIgYXBwRXJyb3JQcmVmaXggPSBleGNlcHRpb25IYW5kbGVyLmNvbmZpZy5hcHBFcnJvclByZWZpeCB8fCAnJztcclxuICAgICAgICAgICAgdmFyIGVycm9yRGF0YSA9IHtleGNlcHRpb246IGV4Y2VwdGlvbiwgY2F1c2U6IGNhdXNlfTtcclxuICAgICAgICAgICAgZXhjZXB0aW9uLm1lc3NhZ2UgPSBhcHBFcnJvclByZWZpeCArIGV4Y2VwdGlvbi5tZXNzYWdlO1xyXG4gICAgICAgICAgICAkZGVsZWdhdGUoZXhjZXB0aW9uLCBjYXVzZSk7XHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBDb3VsZCBhZGQgdGhlIGVycm9yIHRvIGEgc2VydmljZSdzIGNvbGxlY3Rpb24sXHJcbiAgICAgICAgICAgICAqIGFkZCBlcnJvcnMgdG8gJHJvb3RTY29wZSwgbG9nIGVycm9ycyB0byByZW1vdGUgd2ViIHNlcnZlcixcclxuICAgICAgICAgICAgICogb3IgbG9nIGxvY2FsbHkuIE9yIHRocm93IGhhcmQuIEl0IGlzIGVudGlyZWx5IHVwIHRvIHlvdS5cclxuICAgICAgICAgICAgICogdGhyb3cgZXhjZXB0aW9uO1xyXG4gICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgKiBAZXhhbXBsZVxyXG4gICAgICAgICAgICAgKiAgICAgdGhyb3cgeyBtZXNzYWdlOiAnZXJyb3IgbWVzc2FnZSB3ZSBhZGRlZCcgfTtcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihleGNlcHRpb24ubWVzc2FnZSwgZXJyb3JEYXRhKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBleGNlcHRpb24uJGluamVjdCA9IFtcIiRxXCIsIFwibG9nZ2VyXCJdO1xyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nKVxyXG4gICAgICAgIC5mYWN0b3J5KCdleGNlcHRpb24nLCBleGNlcHRpb24pO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gZXhjZXB0aW9uKCRxLCBsb2dnZXIpIHtcclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgY2F0Y2hlcjogY2F0Y2hlclxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNhdGNoZXIobWVzc2FnZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRocm93bkRlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5ld01lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5kYXRhICYmIGUuZGF0YS5kZXNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93bkRlc2NyaXB0aW9uID0gJ1xcbicgKyBlLmRhdGEuZGVzY3JpcHRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3TWVzc2FnZSA9IG1lc3NhZ2UgKyB0aHJvd25EZXNjcmlwdGlvbjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGUuZGF0YS5kZXNjcmlwdGlvbiA9IG5ld01lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IobmV3TWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KGUpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInKVxyXG4gICAgICAgIC5mYWN0b3J5KCdsb2dnZXInLCBsb2dnZXIpO1xyXG5cclxuICAgIGxvZ2dlci4kaW5qZWN0ID0gWyckbG9nJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBsb2dnZXIoJGxvZywgdG9hc3RyKSB7XHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIGVycm9yICAgOiBlcnJvcixcclxuICAgICAgICAgICAgaW5mbyAgICA6IGluZm8sXHJcbiAgICAgICAgICAgIHN1Y2Nlc3MgOiBzdWNjZXNzLFxyXG4gICAgICAgICAgICB3YXJuaW5nIDogd2FybmluZyxcclxuXHJcbiAgICAgICAgICAgIC8vIHN0cmFpZ2h0IHRvIGNvbnNvbGU7IGJ5cGFzcyB0b2FzdHJcclxuICAgICAgICAgICAgbG9nICAgICA6ICRsb2cubG9nXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSwgdGl0bGUpO1xyXG4gICAgICAgICAgICAkbG9nLmVycm9yKCdFcnJvcjogJyArIG1lc3NhZ2UsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaW5mbyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmluZm8obWVzc2FnZSwgdGl0bGUpO1xyXG4gICAgICAgICAgICAkbG9nLmluZm8oJ0luZm86ICcgKyBtZXNzYWdlLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSwgdGl0bGUpO1xyXG4gICAgICAgICAgICAkbG9nLmluZm8oJ1N1Y2Nlc3M6ICcgKyBtZXNzYWdlLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKG1lc3NhZ2UsIHRpdGxlKTtcclxuICAgICAgICAgICAgJGxvZy53YXJuKCdXYXJuaW5nOiAnICsgbWVzc2FnZSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KCkpO1xyXG5cbi8qIEhlbHAgY29uZmlndXJlIHRoZSBzdGF0ZS1iYXNlIHVpLnJvdXRlciAqL1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5yb3V0ZXInKVxyXG4gICAgICAgIC5wcm92aWRlcigncm91dGVySGVscGVyJywgcm91dGVySGVscGVyUHJvdmlkZXIpO1xyXG5cclxuICAgIHJvdXRlckhlbHBlclByb3ZpZGVyLiRpbmplY3QgPSBbJyRsb2NhdGlvblByb3ZpZGVyJywgJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlciddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiByb3V0ZXJIZWxwZXJQcm92aWRlcigkbG9jYXRpb25Qcm92aWRlciwgJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xyXG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xyXG4gICAgICAgIHZhciBjb25maWcgPSB7XHJcbiAgICAgICAgICAgIGRvY1RpdGxlOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIHJlc29sdmVBbHdheXM6IHt9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHtcclxuICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgcmVxdWlyZUJhc2U6IGZhbHNlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlndXJlID0gZnVuY3Rpb24oY2ZnKSB7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGNvbmZpZywgY2ZnKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLiRnZXQgPSBSb3V0ZXJIZWxwZXI7XHJcbiAgICAgICAgUm91dGVySGVscGVyLiRpbmplY3QgPSBbJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgJyRzdGF0ZScsICdsb2dnZXInXTtcclxuICAgICAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgICAgICBmdW5jdGlvbiBSb3V0ZXJIZWxwZXIoJGxvY2F0aW9uLCAkcm9vdFNjb3BlLCAkc3RhdGUsIGxvZ2dlcikge1xyXG4gICAgICAgICAgICB2YXIgaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciBoYXNPdGhlcndpc2UgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIHN0YXRlQ291bnRzID0ge1xyXG4gICAgICAgICAgICAgICAgZXJyb3JzOiAwLFxyXG4gICAgICAgICAgICAgICAgY2hhbmdlczogMFxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgICAgICBjb25maWd1cmVTdGF0ZXM6IGNvbmZpZ3VyZVN0YXRlcyxcclxuICAgICAgICAgICAgICAgIGdldFN0YXRlczogZ2V0U3RhdGVzLFxyXG4gICAgICAgICAgICAgICAgc3RhdGVDb3VudHM6IHN0YXRlQ291bnRzXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBpbml0KCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlU3RhdGVzKHN0YXRlcywgb3RoZXJ3aXNlUGF0aCkge1xyXG4gICAgICAgICAgICAgICAgc3RhdGVzLmZvckVhY2goZnVuY3Rpb24oc3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5jb25maWcucmVzb2x2ZSA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHN0YXRlLmNvbmZpZy5yZXNvbHZlIHx8IHt9LCBjb25maWcucmVzb2x2ZUFsd2F5cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoc3RhdGUuc3RhdGUsIHN0YXRlLmNvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChvdGhlcndpc2VQYXRoICYmICFoYXNPdGhlcndpc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBoYXNPdGhlcndpc2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2Uob3RoZXJ3aXNlUGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZVJvdXRpbmdFcnJvcnMoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSb3V0ZSBjYW5jZWxsYXRpb246XHJcbiAgICAgICAgICAgICAgICAvLyBPbiByb3V0aW5nIGVycm9yLCBnbyB0byB0aGUgZGFzaGJvYXJkLlxyXG4gICAgICAgICAgICAgICAgLy8gUHJvdmlkZSBhbiBleGl0IGNsYXVzZSBpZiBpdCB0cmllcyB0byBkbyBpdCB0d2ljZS5cclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMsIGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50cy5lcnJvcnMrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlc3RpbmF0aW9uID0gKHRvU3RhdGUgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0b1N0YXRlLnRpdGxlIHx8IHRvU3RhdGUubmFtZSB8fCB0b1N0YXRlLmxvYWRlZFRlbXBsYXRlVXJsKSkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd1bmtub3duIHRhcmdldCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtc2cgPSAnRXJyb3Igcm91dGluZyB0byAnICsgZGVzdGluYXRpb24gKyAnLiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChlcnJvci5kYXRhIHx8ICcnKSArICcuIDxici8+JyArIChlcnJvci5zdGF0dXNUZXh0IHx8ICcnKSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnOiAnICsgKGVycm9yLnN0YXR1cyB8fCAnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKG1zZywgW3RvU3RhdGVdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlUm91dGluZ0Vycm9ycygpO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlRG9jVGl0bGUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkgeyByZXR1cm4gJHN0YXRlLmdldCgpOyB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiB1cGRhdGVEb2NUaXRsZSgpIHtcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJyxcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50cy5jaGFuZ2VzKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBjb25maWcuZG9jVGl0bGUgKyAnICcgKyAodG9TdGF0ZS50aXRsZSB8fCAnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUudGl0bGUgPSB0aXRsZTsgLy8gZGF0YSBiaW5kIHRvIDx0aXRsZT5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnLCBbJ2FwcC5jb3JlJ10pO1xyXG5cclxufSkgKCk7XHJcblxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnLCBbJ2FwcC5jb3JlJ10pO1xyXG5cclxufSkoKTtcclxuXG4oZnVuY3Rpb24gKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcblxyXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuaG9tZXBhZ2UnLCBbXHJcbiAgICAnYXBwLmNvcmUnXHJcbiAgXSk7XHJcblxyXG59KSAoKTtcclxuXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxhYicsIFtcclxuICAgICdhcHAuY29yZScsXHJcbiAgICAnYXBwLmxhYi5wcm9kdWN0cycsXHJcbiAgICAnYXBwLmxhYi5hdHRyaWJ1dGVzJ1xyXG4gIF0pO1xyXG5cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYXlvdXQnLCBbXHJcbiAgICAgICdhcHAuY29yZSdcclxuICAgIF0pO1xyXG59KSgpO1xyXG5cbihmdW5jdGlvbiAoKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmhvbWVwYWdlJykuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBIb21lQ29udHJvbGxlcik7XHJcblxyXG4gIGZ1bmN0aW9uIEhvbWVDb250cm9sbGVyKCnCoHtcclxuICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICB2bS50aXRsZSA9ICdIb21lcGFnZSc7XHJcbiAgfVxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmhvbWVwYWdlJylcclxuICAgICAgICAucnVuKGFwcFJ1bik7XHJcblxyXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XHJcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlOiAnaG9tZXBhZ2UnLFxyXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnLycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvaG9tZXBhZ2UvaG9tZXBhZ2Uudmlldy5odG1sJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUNvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2hvbWUnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5J1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuICAgIH1cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWInKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdMYWJDb250cm9sbGVyJywgTGFiQ29udHJvbGxlcik7XHJcblxyXG4gICAgTGFiQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIExhYkNvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5jaG9pY2VzID0ge307XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYicpXHJcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xyXG5cclxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xyXG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xhYicsXHJcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvbGFiJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9sYWIvbGFiLnZpZXcuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0xhYkNvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2xhYlZtJyxcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSAtIExhYidcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdBdHRyaWJ1dGVzQ29udHJvbGxlcicsIEF0dHJpYnV0ZXNDb250cm9sbGVyKTtcclxuXHJcbiAgICBBdHRyaWJ1dGVzQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHN0YXRlJywgJyRmaWx0ZXInLCAnJHJvb3RTY29wZScsJyR3aW5kb3cnLCAnJGRvY3VtZW50J107XHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIEF0dHJpYnV0ZXNDb250cm9sbGVyKCRzY29wZSwgJHN0YXRlLCAkZmlsdGVyLCAkcm9vdFNjb3BlLCAkd2luZG93LCAkZG9jdW1lbnQpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLnByb2R1Y3QgPSBudWxsO1xyXG4gICAgICAgIHZtLmF0dHJpYnV0ZXMgPSBbXTtcclxuICAgICAgICB2bS5vZmZzZXQgPSAyMTg7XHJcbiAgICAgICAgdm0uZ2V0Rm9ybSA9IGdldEZvcm07XHJcbiAgICAgICAgdm0uZ2V0UmVzdWx0VmlldyA9IGdldFJlc3VsdFZpZXc7XHJcbiAgICAgICAgdm0uY2hvaWNlVmFsaWRhdGUgPSBjaG9pY2VWYWxpZGF0ZTtcclxuICAgICAgICB2bS5yZW5kZXIgPSByZW5kZXI7XHJcbiAgICAgICAgdm0uZ29Ub05leHQgPSBnb1RvTmV4dDtcclxuXHJcblxyXG4gICAgICAgICR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBjaGVja1Bvcyk7XHJcblxyXG4gICAgICAgIGFjdGl2YXRlKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xyXG4gICAgICAgICAgaWYgKHR5cGVvZiAkc2NvcGUubGFiVm0uY2hvaWNlcy5wcm9kdWN0ID09PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICRzdGF0ZS5nbygnbGFiLnByb2R1Y3RzJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgICRyb290U2NvcGUuc21hbGxIZWFkZXIgPSB0cnVlO1xyXG4gICAgICAgICAgdm0ucHJvZHVjdCA9ICRzY29wZS5sYWJWbS5jaG9pY2VzLnByb2R1Y3Q7XHJcbiAgICAgICAgICB2bS5hdHRyaWJ1dGVzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLnByb2R1Y3QuYXR0cmlidXRlcywgJ29yZGVyJyk7XHJcbiAgICAgICAgICB2bS5jdXJyZW50ID0gdm0uYXR0cmlidXRlc1swXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEZvcm0oYXR0cmlidXRlKSB7XHJcbiAgICAgICAgICByZXR1cm4gXCJhcHAvbGFiL2F0dHJpYnV0ZXMvZm9ybXMvXCIgKyBhdHRyaWJ1dGUuZm9ybSArIFwiL1wiICsgIGF0dHJpYnV0ZS5mb3JtICsgXCIudmlldy5odG1sXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRSZXN1bHRWaWV3KHByb2R1Y3QpIHtcclxuICAgICAgICAgIHJldHVybiBcImFwcC9sYWIvYXR0cmlidXRlcy9yZXN1bHRzL1wiICsgcHJvZHVjdC5uYW1lICsgXCIvXCIgKyBwcm9kdWN0Lm5hbWUgKyBcIi52aWV3Lmh0bWxcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNob2ljZVZhbGlkYXRlKGF0dHJpYnV0ZSkge1xyXG4gICAgICAgICAgcmV0dXJuIHR5cGVvZiAkc2NvcGUubGFiVm0uY2hvaWNlc1thdHRyaWJ1dGUubmFtZV0gIT09IFwidW5kZWZpbmVkXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjaGVja1BvcyhlKSB7XHJcbiAgICAgICAgICB2YXIgaSA9IDA7XHJcbiAgICAgICAgICB2YXIgbm90Rm91bmQgPSB0cnVlO1xyXG4gICAgICAgICAgdmFyIGxhc3RBdHRyaWJ1dGUgPSAgdm0uYXR0cmlidXRlc1swXTtcclxuICAgICAgICAgIHdoaWxlIChpIDwgdm0uYXR0cmlidXRlcy5sZW5ndGggJiYgbm90Rm91bmQpIHtcclxuICAgICAgICAgICAgdmFyIGVsZW1udCA9IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh2bS5hdHRyaWJ1dGVzW2ldLm5hbWUpKTtcclxuICAgICAgICAgICAgdmFyIHBvc1N0YXJ0ID0gZWxlbW50LnByb3AoJ29mZnNldFRvcCcpIC0gdm0ub2Zmc2V0IC0gNTtcclxuICAgICAgICAgICAgdmFyIHBvc0VuZCA9IGVsZW1udC5wcm9wKCdvZmZzZXRUb3AnKSArIGVsZW1udFswXS5vZmZzZXRIZWlnaHQgLSB2bS5vZmZzZXQgLSA1O1xyXG4gICAgICAgICAgICBpZiAoJGRvY3VtZW50LnNjcm9sbFRvcCgpID49IHBvc1N0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgaWYgKCRkb2N1bWVudC5zY3JvbGxUb3AoKSA8PSBwb3NFbmQpIHtcclxuICAgICAgICAgICAgICAgIHZtLmN1cnJlbnQgPSB2bS5hdHRyaWJ1dGVzW2ldO1xyXG4gICAgICAgICAgICAgICAgbm90Rm91bmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGFzdEF0dHJpYnV0ZSA9IHZtLmF0dHJpYnV0ZXNbaSArIDFdO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAobm90Rm91bmQpIHtcclxuICAgICAgICAgICAgICB2bS5jdXJyZW50ID0gbGFzdEF0dHJpYnV0ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZW5kZXIoYXR0cmlidXRlKSB7XHJcbiAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgIT09IHZtLmN1cnJlbnQubmFtZSkge1xyXG4gICAgICAgICAgICBnb1RvKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgYXR0cmlidXRlLm5hbWUpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdvVG9OZXh0KGN1cnJlbnQpIHtcclxuICAgICAgICAgIHZhciBuZXh0RWxtbnQgPSBhbmd1bGFyLmVsZW1lbnQoY3VycmVudCkubmV4dCgpO1xyXG4gICAgICAgICAgZ29UbyhuZXh0RWxtbnRbMF0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ29UbyhlbG1udCkge1xyXG4gICAgICAgICAgJGRvY3VtZW50LnNjcm9sbFRvRWxlbWVudChlbG1udCwgdm0ub2Zmc2V0LCAxMDAwKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oXCIkZGVzdHJveVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBjaGVja1Bvcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAucnVuKGFwcFJ1bik7XHJcblxyXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XHJcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGFiLmF0dHJpYnV0ZXMnLFxyXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2F0dHJpYnV0ZXMnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5IC0gYXR0cmlidXRlcycsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0F0dHJpYnV0ZXNDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdhdHRyaWJ1dGVzVm0nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2xhYi9hdHRyaWJ1dGVzL2F0dHJpYnV0ZXMudmlldy5odG1sJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuICAgIH1cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdQcm9kdWN0c0NvbnRyb2xsZXInLCBQcm9kdWN0c0NvbnRyb2xsZXIpO1xyXG5cclxuICAgIFByb2R1Y3RzQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHN0YXRlJywgJ2RhdGFzZXJ2aWNlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBQcm9kdWN0c0NvbnRyb2xsZXIoJHNjb3BlLCAkc3RhdGUsIGRhdGFzZXJ2aWNlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuXHJcbiAgICAgICAgdm0uc2VsZWN0ID0gc2VsZWN0O1xyXG5cclxuICAgICAgICBhY3RpdmF0ZSgpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcclxuICAgICAgICAgIGRhdGFzZXJ2aWNlLnJlYWR5KCkudGhlbihnZXRQcm9kdWN0cyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRQcm9kdWN0cygpIHtcclxuICAgICAgICAgIHZtLnByb2R1Y3RzID0gZGF0YXNlcnZpY2UuZ2V0UHJvZHVjdHMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdChwcm9kdWN0KSB7XHJcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlcy5wcm9kdWN0ID0gcHJvZHVjdDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5wcm9kdWN0cycpXHJcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xyXG5cclxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xyXG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xhYi5wcm9kdWN0cycsXHJcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvcHJvZHVjdHMnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5IC0gcHJvZHVjdHMnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9kdWN0c0NvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3Byb2R1Y3RzVm0nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2xhYi9wcm9kdWN0cy9wcm9kdWN0cy52aWV3Lmh0bWwnXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgfVxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAuY29udHJvbGxlcignQnRuUmFkaW9Db250cm9sbGVyJywgQnRuUmFkaW9Db250cm9sbGVyKTtcclxuXHJcbiAgICBCdG5SYWRpb0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJywgJyRmaWx0ZXInXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIEJ0blJhZGlvQ29udHJvbGxlcigkc2NvcGUsICRmaWx0ZXIpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XHJcbiAgICAgICAgdm0uaW1nUHJldmlldyA9IG51bGw7XHJcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xyXG4gICAgICAgIHZtLnNldEltZ1ByZXZpZXcgPSBzZXRJbWdQcmV2aWV3O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xyXG4gICAgICAgICAgdm0uY2hvaWNlID0gYXR0cmlidXRlQ2hvaWNlZDtcclxuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IGF0dHJpYnV0ZUNob2ljZWQ7XHJcbiAgICAgICAgICBzZXRJbWdQcmV2aWV3KHZtLmNob2ljZS5pbWcpO1xyXG5cclxuICAgICAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0SW1nUHJldmlldyhpbWcpIHtcclxuICAgICAgICAgIGlmICh2bS5hdHRyaWJ1dGUuaGF2ZUltZ1ByZXZpZXcpIHtcclxuICAgICAgICAgICAgdm0uaW1nUHJldmlldyA9IGltZztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAuY29udHJvbGxlcignQ2hlY2tib3hDb250cm9sbGVyJywgQ2hlY2tib3hDb250cm9sbGVyKTtcclxuXHJcbiAgICBDaGVja2JveENvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBDaGVja2JveENvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5jaG9pY2VzID0gW107XHJcbiAgICAgICAgdm0uZXhpc3RzID0gZXhpc3RzO1xyXG4gICAgICAgIHZtLnRvZ2dsZSA9IHRvZ2dsZTtcclxuICAgICAgICB2bS5zYXZlQ2hvaWNlcyA9IHNhdmVDaG9pY2VzO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGlzdHModmFsdWUpIHtcclxuICAgICAgICAgIHJldHVybiB2bS5jaG9pY2VzLmluZGV4T2YodmFsdWUpID4gLTE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB0b2dnbGUodmFsdWUpIHtcclxuICAgICAgICAgIHZhciBpZHggPSB2bS5jaG9pY2VzLmluZGV4T2YodmFsdWUpO1xyXG4gICAgICAgICAgaWYgKGlkeCA+IC0xKSB7XHJcbiAgICAgICAgICAgIHZtLmNob2ljZXMuc3BsaWNlKGlkeCwgMSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2bS5jaG9pY2VzLnB1c2godmFsdWUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVDaG9pY2VzKCkge1xyXG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gdm0uY2hvaWNlcztcclxuICAgICAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAuY29udHJvbGxlcignQ29sb3JDb250cm9sbGVyJywgQ29sb3JDb250cm9sbGVyKTtcclxuXHJcbiAgICBDb2xvckNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBDb2xvckNvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XHJcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xyXG4gICAgICAgIHZtLnNldE9wYWNpdHkgPSBzZXRPcGFjaXR5O1xyXG4gICAgICAgIHZtLnNhdmVDaG9pY2UgPSBzYXZlQ2hvaWNlO1xyXG4gICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xyXG4gICAgICAgICAgaWYgKHZtLmNob2ljZSkge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9ybS1jb2xvci0nICsgdm0uY2hvaWNlKS5zdHlsZS5vcGFjaXR5ID0gMTtcclxuICAgICAgICAgICAgdm0ucGVyY2VudCA9IDEwMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHZtLmNob2ljZSA9IGF0dHJpYnV0ZUNob2ljZWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzYXZlQ2hvaWNlKCkge1xyXG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0ge3ZhbHVlOiB2bS5jaG9pY2UsIHBlcmNlbnQ6IHZtLnBlcmNlbnR9O1xyXG4gICAgICAgICAgJHNjb3BlLmF0dHJpYnV0ZXNWbS5nb1RvTmV4dChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHZtLmF0dHJpYnV0ZS5uYW1lKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRPcGFjaXR5KCkge1xyXG4gICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvcm0tY29sb3ItJyArIHZtLmNob2ljZSkuc3R5bGUub3BhY2l0eSA9IHZtLnBlcmNlbnQgLyAxMDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdJbnB1dFRleHRDb250cm9sbGVyJywgSW5wdXRUZXh0Q29udHJvbGxlcik7XHJcblxyXG4gICAgSW5wdXRUZXh0Q29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIElucHV0VGV4dENvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5jaG9pY2UgPSBudWxsO1xyXG4gICAgICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKCkge1xyXG4gICAgICAgICAgaWYgKHZtLmNob2ljZSAhPT0gXCJcIiAmJiB2bS5jaG9pY2UgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gdm0uY2hvaWNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1JhZGlvU2xpZGVyQ29udHJvbGxlcicsIFJhZGlvU2xpZGVyQ29udHJvbGxlcik7XHJcblxyXG4gICAgUmFkaW9TbGlkZXJDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gUmFkaW9TbGlkZXJDb250cm9sbGVyKCRzY29wZSkge1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5jaG9pY2UgPSBudWxsO1xyXG4gICAgICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcclxuICAgICAgICB2bS5zYXZlQ2hvaWNlID0gc2F2ZUNob2ljZTtcclxuICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xyXG5cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcclxuICAgICAgICAgIGlmICh2bS5jaG9pY2UpIHtcclxuICAgICAgICAgICAgdm0ucGVyY2VudCA9IDEwMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHZtLmNob2ljZSA9IGF0dHJpYnV0ZUNob2ljZWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzYXZlQ2hvaWNlKCkge1xyXG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0ge3ZhbHVlOiB2bS5jaG9pY2UsIHBlcmNlbnQ6IHZtLnBlcmNlbnR9O1xyXG4gICAgICAgICAgJHNjb3BlLmF0dHJpYnV0ZXNWbS5nb1RvTmV4dChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHZtLmF0dHJpYnV0ZS5uYW1lKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICBhbmd1bGFyXHJcbiAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXHJcbiAgICAgIC5jb250cm9sbGVyKCdJbWdSYWRpb0NvbnRyb2xsZXInLCBJbWdSYWRpb0NvbnRyb2xsZXIpO1xyXG5cclxuICBJbWdSYWRpb0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIEltZ1JhZGlvQ29udHJvbGxlcigkc2NvcGUpIHtcclxuICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICB2bS5jaG9pY2UgPSBudWxsO1xyXG4gICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xyXG4gICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0NyZWFtQ29udHJvbGxlcicsIENyZWFtQ29udHJvbGxlcik7XHJcblxyXG4gICAgQ3JlYW1Db250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gQ3JlYW1Db250cm9sbGVyKCRzY29wZSkge1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuY29yZScpXHJcbiAgICAgICAgLmZhY3RvcnkoJ2RhdGFzZXJ2aWNlJywgZGF0YXNlcnZpY2UpO1xyXG5cclxuICAgIGRhdGFzZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywgJyRxJywgJ2V4Y2VwdGlvbicsICdsb2dnZXInXTtcclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gZGF0YXNlcnZpY2UoJGh0dHAsICRxLCBleGNlcHRpb24sIGxvZ2dlcikge1xyXG4gICAgICAgIHZhciBqc29uVVJMID0gJy9yZXNzb3VyY2VzL3Byb2R1Y3RzLmpzb24nO1xyXG4gICAgICAgIHZhciBwcm9taXNlID0gJGh0dHAuZ2V0KGpzb25VUkwpO1xyXG4gICAgICAgIHZhciBkYXRhID0gbnVsbDtcclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgIHJlYWR5OiByZWFkeSxcclxuICAgICAgICAgIGdldFByb2R1Y3RzOiBnZXRQcm9kdWN0c1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRQcm9kdWN0cygpIHtcclxuICAgICAgICAgIHJldHVybiBkYXRhLnByb2R1Y3RzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVhZHkoKSB7XHJcbiAgICAgICAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBkYXRhID0gcmVzdWx0LmRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignSW1wb3NzaWJsZSBkZSByw6ljdXDDqXJlciBsZXMgZG9ubsOpZXMnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuY29yZScpXHJcbiAgICAuZmlsdGVyKCdnZXRCeU5hbWUnLCBnZXRCeU5hbWUpO1xyXG5cclxuICBmdW5jdGlvbiBnZXRCeU5hbWUoKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oaW5wdXQsIG5hbWUpIHtcclxuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGlucHV0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKGlucHV0W2ldLnZhbHVlID09IG5hbWUgfHwgaW5wdXRbaV0ubmFtZSA9PSBuYW1lKSB7XHJcbiAgICAgICAgICByZXR1cm4gaW5wdXRbaV07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJywgWydibG9ja3MubG9nZ2VyJ10pO1xyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInLCBbXSk7XHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYmxvY2tzLnJvdXRlcicsIFtcclxuICAgICAgICAndWkucm91dGVyJyxcclxuICAgICAgICAnYmxvY2tzLmxvZ2dlcidcclxuICAgIF0pO1xyXG59KSgpO1xyXG4iLCIvLyBJbmNsdWRlIGluIGluZGV4Lmh0bWwgc28gdGhhdCBhcHAgbGV2ZWwgZXhjZXB0aW9ucyBhcmUgaGFuZGxlZC5cclxuLy8gRXhjbHVkZSBmcm9tIHRlc3RSdW5uZXIuaHRtbCB3aGljaCBzaG91bGQgcnVuIGV4YWN0bHkgd2hhdCBpdCB3YW50cyB0byBydW5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJylcclxuICAgICAgICAucHJvdmlkZXIoJ2V4Y2VwdGlvbkhhbmRsZXInLCBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIpXHJcbiAgICAgICAgLmNvbmZpZyhjb25maWcpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogTXVzdCBjb25maWd1cmUgdGhlIGV4Y2VwdGlvbiBoYW5kbGluZ1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIoKSB7XHJcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXHJcbiAgICAgICAgdGhpcy5jb25maWcgPSB7XHJcbiAgICAgICAgICAgIGFwcEVycm9yUHJlZml4OiB1bmRlZmluZWRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uIChhcHBFcnJvclByZWZpeCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5hcHBFcnJvclByZWZpeCA9IGFwcEVycm9yUHJlZml4O1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuJGdldCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge2NvbmZpZzogdGhpcy5jb25maWd9O1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlnLiRpbmplY3QgPSBbJyRwcm92aWRlJ107XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25maWd1cmUgYnkgc2V0dGluZyBhbiBvcHRpb25hbCBzdHJpbmcgdmFsdWUgZm9yIGFwcEVycm9yUHJlZml4LlxyXG4gICAgICogQWNjZXNzaWJsZSB2aWEgY29uZmlnLmFwcEVycm9yUHJlZml4ICh2aWEgY29uZmlnIHZhbHVlKS5cclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gJHByb3ZpZGVcclxuICAgICAqL1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBjb25maWcoJHByb3ZpZGUpIHtcclxuICAgICAgICAkcHJvdmlkZS5kZWNvcmF0b3IoJyRleGNlcHRpb25IYW5kbGVyJywgZXh0ZW5kRXhjZXB0aW9uSGFuZGxlcik7XHJcbiAgICB9XHJcblxyXG4gICAgZXh0ZW5kRXhjZXB0aW9uSGFuZGxlci4kaW5qZWN0ID0gWyckZGVsZWdhdGUnLCAnZXhjZXB0aW9uSGFuZGxlcicsICdsb2dnZXInXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4dGVuZCB0aGUgJGV4Y2VwdGlvbkhhbmRsZXIgc2VydmljZSB0byBhbHNvIGRpc3BsYXkgYSB0b2FzdC5cclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gJGRlbGVnYXRlXHJcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGV4Y2VwdGlvbkhhbmRsZXJcclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gbG9nZ2VyXHJcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gdGhlIGRlY29yYXRlZCAkZXhjZXB0aW9uSGFuZGxlciBzZXJ2aWNlXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIoJGRlbGVnYXRlLCBleGNlcHRpb25IYW5kbGVyLCBsb2dnZXIpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZXhjZXB0aW9uLCBjYXVzZSkge1xyXG4gICAgICAgICAgICB2YXIgYXBwRXJyb3JQcmVmaXggPSBleGNlcHRpb25IYW5kbGVyLmNvbmZpZy5hcHBFcnJvclByZWZpeCB8fCAnJztcclxuICAgICAgICAgICAgdmFyIGVycm9yRGF0YSA9IHtleGNlcHRpb246IGV4Y2VwdGlvbiwgY2F1c2U6IGNhdXNlfTtcclxuICAgICAgICAgICAgZXhjZXB0aW9uLm1lc3NhZ2UgPSBhcHBFcnJvclByZWZpeCArIGV4Y2VwdGlvbi5tZXNzYWdlO1xyXG4gICAgICAgICAgICAkZGVsZWdhdGUoZXhjZXB0aW9uLCBjYXVzZSk7XHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBDb3VsZCBhZGQgdGhlIGVycm9yIHRvIGEgc2VydmljZSdzIGNvbGxlY3Rpb24sXHJcbiAgICAgICAgICAgICAqIGFkZCBlcnJvcnMgdG8gJHJvb3RTY29wZSwgbG9nIGVycm9ycyB0byByZW1vdGUgd2ViIHNlcnZlcixcclxuICAgICAgICAgICAgICogb3IgbG9nIGxvY2FsbHkuIE9yIHRocm93IGhhcmQuIEl0IGlzIGVudGlyZWx5IHVwIHRvIHlvdS5cclxuICAgICAgICAgICAgICogdGhyb3cgZXhjZXB0aW9uO1xyXG4gICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgKiBAZXhhbXBsZVxyXG4gICAgICAgICAgICAgKiAgICAgdGhyb3cgeyBtZXNzYWdlOiAnZXJyb3IgbWVzc2FnZSB3ZSBhZGRlZCcgfTtcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihleGNlcHRpb24ubWVzc2FnZSwgZXJyb3JEYXRhKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nKVxyXG4gICAgICAgIC5mYWN0b3J5KCdleGNlcHRpb24nLCBleGNlcHRpb24pO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gZXhjZXB0aW9uKCRxLCBsb2dnZXIpIHtcclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgY2F0Y2hlcjogY2F0Y2hlclxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNhdGNoZXIobWVzc2FnZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRocm93bkRlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5ld01lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5kYXRhICYmIGUuZGF0YS5kZXNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93bkRlc2NyaXB0aW9uID0gJ1xcbicgKyBlLmRhdGEuZGVzY3JpcHRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3TWVzc2FnZSA9IG1lc3NhZ2UgKyB0aHJvd25EZXNjcmlwdGlvbjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGUuZGF0YS5kZXNjcmlwdGlvbiA9IG5ld01lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IobmV3TWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KGUpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdibG9ja3MubG9nZ2VyJylcclxuICAgICAgICAuZmFjdG9yeSgnbG9nZ2VyJywgbG9nZ2VyKTtcclxuXHJcbiAgICBsb2dnZXIuJGluamVjdCA9IFsnJGxvZyddO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gbG9nZ2VyKCRsb2csIHRvYXN0cikge1xyXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgICBlcnJvciAgIDogZXJyb3IsXHJcbiAgICAgICAgICAgIGluZm8gICAgOiBpbmZvLFxyXG4gICAgICAgICAgICBzdWNjZXNzIDogc3VjY2VzcyxcclxuICAgICAgICAgICAgd2FybmluZyA6IHdhcm5pbmcsXHJcblxyXG4gICAgICAgICAgICAvLyBzdHJhaWdodCB0byBjb25zb2xlOyBieXBhc3MgdG9hc3RyXHJcbiAgICAgICAgICAgIGxvZyAgICAgOiAkbG9nLmxvZ1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKG1lc3NhZ2UsIHRpdGxlKTtcclxuICAgICAgICAgICAgJGxvZy5lcnJvcignRXJyb3I6ICcgKyBtZXNzYWdlLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGluZm8obWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5pbmZvKG1lc3NhZ2UsIHRpdGxlKTtcclxuICAgICAgICAgICAgJGxvZy5pbmZvKCdJbmZvOiAnICsgbWVzc2FnZSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UsIHRpdGxlKTtcclxuICAgICAgICAgICAgJGxvZy5pbmZvKCdTdWNjZXNzOiAnICsgbWVzc2FnZSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB3YXJuaW5nKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlLCB0aXRsZSk7XHJcbiAgICAgICAgICAgICRsb2cud2FybignV2FybmluZzogJyArIG1lc3NhZ2UsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSgpKTtcclxuIiwiLyogSGVscCBjb25maWd1cmUgdGhlIHN0YXRlLWJhc2UgdWkucm91dGVyICovXHJcbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLnJvdXRlcicpXHJcbiAgICAgICAgLnByb3ZpZGVyKCdyb3V0ZXJIZWxwZXInLCByb3V0ZXJIZWxwZXJQcm92aWRlcik7XHJcblxyXG4gICAgcm91dGVySGVscGVyUHJvdmlkZXIuJGluamVjdCA9IFsnJGxvY2F0aW9uUHJvdmlkZXInLCAnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJ107XHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIHJvdXRlckhlbHBlclByb3ZpZGVyKCRsb2NhdGlvblByb3ZpZGVyLCAkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XHJcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXHJcbiAgICAgICAgdmFyIGNvbmZpZyA9IHtcclxuICAgICAgICAgICAgZG9jVGl0bGU6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgcmVzb2x2ZUFsd2F5czoge31cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUoe1xyXG4gICAgICAgICAgZW5hYmxlZDogZmFsc2UsXHJcbiAgICAgICAgICByZXF1aXJlQmFzZTogZmFsc2VcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5jb25maWd1cmUgPSBmdW5jdGlvbihjZmcpIHtcclxuICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoY29uZmlnLCBjZmcpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuJGdldCA9IFJvdXRlckhlbHBlcjtcclxuICAgICAgICBSb3V0ZXJIZWxwZXIuJGluamVjdCA9IFsnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCAnJHN0YXRlJywgJ2xvZ2dlciddO1xyXG4gICAgICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIFJvdXRlckhlbHBlcigkbG9jYXRpb24sICRyb290U2NvcGUsICRzdGF0ZSwgbG9nZ2VyKSB7XHJcbiAgICAgICAgICAgIHZhciBoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIGhhc090aGVyd2lzZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgc3RhdGVDb3VudHMgPSB7XHJcbiAgICAgICAgICAgICAgICBlcnJvcnM6IDAsXHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VzOiAwXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyZVN0YXRlczogY29uZmlndXJlU3RhdGVzLFxyXG4gICAgICAgICAgICAgICAgZ2V0U3RhdGVzOiBnZXRTdGF0ZXMsXHJcbiAgICAgICAgICAgICAgICBzdGF0ZUNvdW50czogc3RhdGVDb3VudHNcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGluaXQoKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBjb25maWd1cmVTdGF0ZXMoc3RhdGVzLCBvdGhlcndpc2VQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZXMuZm9yRWFjaChmdW5jdGlvbihzdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmNvbmZpZy5yZXNvbHZlID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoc3RhdGUuY29uZmlnLnJlc29sdmUgfHwge30sIGNvbmZpZy5yZXNvbHZlQWx3YXlzKTtcclxuICAgICAgICAgICAgICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZShzdGF0ZS5zdGF0ZSwgc3RhdGUuY29uZmlnKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKG90aGVyd2lzZVBhdGggJiYgIWhhc090aGVyd2lzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc090aGVyd2lzZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZShvdGhlcndpc2VQYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlUm91dGluZ0Vycm9ycygpIHtcclxuICAgICAgICAgICAgICAgIC8vIFJvdXRlIGNhbmNlbGxhdGlvbjpcclxuICAgICAgICAgICAgICAgIC8vIE9uIHJvdXRpbmcgZXJyb3IsIGdvIHRvIHRoZSBkYXNoYm9hcmQuXHJcbiAgICAgICAgICAgICAgICAvLyBQcm92aWRlIGFuIGV4aXQgY2xhdXNlIGlmIGl0IHRyaWVzIHRvIGRvIGl0IHR3aWNlLlxyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZUVycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcywgZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRzLmVycm9ycysrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVzdGluYXRpb24gPSAodG9TdGF0ZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRvU3RhdGUudGl0bGUgfHwgdG9TdGF0ZS5uYW1lIHx8IHRvU3RhdGUubG9hZGVkVGVtcGxhdGVVcmwpKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Vua25vd24gdGFyZ2V0JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1zZyA9ICdFcnJvciByb3V0aW5nIHRvICcgKyBkZXN0aW5hdGlvbiArICcuICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGVycm9yLmRhdGEgfHwgJycpICsgJy4gPGJyLz4nICsgKGVycm9yLnN0YXR1c1RleHQgfHwgJycpICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6ICcgKyAoZXJyb3Iuc3RhdHVzIHx8ICcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcobXNnLCBbdG9TdGF0ZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVSb3V0aW5nRXJyb3JzKCk7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVEb2NUaXRsZSgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7IHJldHVybiAkc3RhdGUuZ2V0KCk7IH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHVwZGF0ZURvY1RpdGxlKCkge1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRzLmNoYW5nZXMrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IGNvbmZpZy5kb2NUaXRsZSArICcgJyArICh0b1N0YXRlLnRpdGxlIHx8ICcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50aXRsZSA9IHRpdGxlOyAvLyBkYXRhIGJpbmQgdG8gPHRpdGxlPlxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnLCBbJ2FwcC5jb3JlJ10pO1xyXG5cclxufSkgKCk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcblxyXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAubGFiLnByb2R1Y3RzJywgWydhcHAuY29yZSddKTtcclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuXHJcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5ob21lcGFnZScsIFtcclxuICAgICdhcHAuY29yZSdcclxuICBdKTtcclxuXHJcbn0pICgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG5cclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxhYicsIFtcclxuICAgICdhcHAuY29yZScsXHJcbiAgICAnYXBwLmxhYi5wcm9kdWN0cycsXHJcbiAgICAnYXBwLmxhYi5hdHRyaWJ1dGVzJ1xyXG4gIF0pO1xyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAubGF5b3V0JywgW1xyXG4gICAgICAnYXBwLmNvcmUnXHJcbiAgICBdKTtcclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uICgpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuaG9tZXBhZ2UnKS5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIEhvbWVDb250cm9sbGVyKTtcclxuXHJcbiAgZnVuY3Rpb24gSG9tZUNvbnRyb2xsZXIoKcKge1xyXG4gICAgdmFyIHZtID0gdGhpcztcclxuICAgIHZtLnRpdGxlID0gJ0hvbWVwYWdlJztcclxuICB9XHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmhvbWVwYWdlJylcclxuICAgICAgICAucnVuKGFwcFJ1bik7XHJcblxyXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XHJcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlOiAnaG9tZXBhZ2UnLFxyXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnLycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvaG9tZXBhZ2UvaG9tZXBhZ2Uudmlldy5odG1sJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUNvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2hvbWUnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5J1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuICAgIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiJylcclxuICAgICAgICAuY29udHJvbGxlcignTGFiQ29udHJvbGxlcicsIExhYkNvbnRyb2xsZXIpO1xyXG5cclxuICAgIExhYkNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBMYWJDb250cm9sbGVyKCRzY29wZSkge1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgdm0uY2hvaWNlcyA9IHt9O1xyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiJylcclxuICAgICAgICAucnVuKGFwcFJ1bik7XHJcblxyXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XHJcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGFiJyxcclxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9sYWInLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2xhYi9sYWIudmlldy5odG1sJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTGFiQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnbGFiVm0nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5IC0gTGFiJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuICAgIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdBdHRyaWJ1dGVzQ29udHJvbGxlcicsIEF0dHJpYnV0ZXNDb250cm9sbGVyKTtcclxuXHJcbiAgICBBdHRyaWJ1dGVzQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHN0YXRlJywgJyRmaWx0ZXInLCAnJHJvb3RTY29wZScsJyR3aW5kb3cnLCAnJGRvY3VtZW50J107XHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIEF0dHJpYnV0ZXNDb250cm9sbGVyKCRzY29wZSwgJHN0YXRlLCAkZmlsdGVyLCAkcm9vdFNjb3BlLCAkd2luZG93LCAkZG9jdW1lbnQpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLnByb2R1Y3QgPSBudWxsO1xyXG4gICAgICAgIHZtLmF0dHJpYnV0ZXMgPSBbXTtcclxuICAgICAgICB2bS5vZmZzZXQgPSAyMTg7XHJcbiAgICAgICAgdm0uZ2V0Rm9ybSA9IGdldEZvcm07XHJcbiAgICAgICAgdm0uZ2V0UmVzdWx0VmlldyA9IGdldFJlc3VsdFZpZXc7XHJcbiAgICAgICAgdm0uY2hvaWNlVmFsaWRhdGUgPSBjaG9pY2VWYWxpZGF0ZTtcclxuICAgICAgICB2bS5yZW5kZXIgPSByZW5kZXI7XHJcbiAgICAgICAgdm0uZ29Ub05leHQgPSBnb1RvTmV4dDtcclxuXHJcblxyXG4gICAgICAgICR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBjaGVja1Bvcyk7XHJcblxyXG4gICAgICAgIGFjdGl2YXRlKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xyXG4gICAgICAgICAgaWYgKHR5cGVvZiAkc2NvcGUubGFiVm0uY2hvaWNlcy5wcm9kdWN0ID09PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICRzdGF0ZS5nbygnbGFiLnByb2R1Y3RzJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgICRyb290U2NvcGUuc21hbGxIZWFkZXIgPSB0cnVlO1xyXG4gICAgICAgICAgdm0ucHJvZHVjdCA9ICRzY29wZS5sYWJWbS5jaG9pY2VzLnByb2R1Y3Q7XHJcbiAgICAgICAgICB2bS5hdHRyaWJ1dGVzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLnByb2R1Y3QuYXR0cmlidXRlcywgJ29yZGVyJyk7XHJcbiAgICAgICAgICB2bS5jdXJyZW50ID0gdm0uYXR0cmlidXRlc1swXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEZvcm0oYXR0cmlidXRlKSB7XHJcbiAgICAgICAgICByZXR1cm4gXCJhcHAvbGFiL2F0dHJpYnV0ZXMvZm9ybXMvXCIgKyBhdHRyaWJ1dGUuZm9ybSArIFwiL1wiICsgIGF0dHJpYnV0ZS5mb3JtICsgXCIudmlldy5odG1sXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRSZXN1bHRWaWV3KHByb2R1Y3QpIHtcclxuICAgICAgICAgIHJldHVybiBcImFwcC9sYWIvYXR0cmlidXRlcy9yZXN1bHRzL1wiICsgcHJvZHVjdC5uYW1lICsgXCIvXCIgKyBwcm9kdWN0Lm5hbWUgKyBcIi52aWV3Lmh0bWxcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNob2ljZVZhbGlkYXRlKGF0dHJpYnV0ZSkge1xyXG4gICAgICAgICAgcmV0dXJuIHR5cGVvZiAkc2NvcGUubGFiVm0uY2hvaWNlc1thdHRyaWJ1dGUubmFtZV0gIT09IFwidW5kZWZpbmVkXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjaGVja1BvcyhlKSB7XHJcbiAgICAgICAgICB2YXIgaSA9IDA7XHJcbiAgICAgICAgICB2YXIgbm90Rm91bmQgPSB0cnVlO1xyXG4gICAgICAgICAgdmFyIGxhc3RBdHRyaWJ1dGUgPSAgdm0uYXR0cmlidXRlc1swXTtcclxuICAgICAgICAgIHdoaWxlIChpIDwgdm0uYXR0cmlidXRlcy5sZW5ndGggJiYgbm90Rm91bmQpIHtcclxuICAgICAgICAgICAgdmFyIGVsZW1udCA9IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh2bS5hdHRyaWJ1dGVzW2ldLm5hbWUpKTtcclxuICAgICAgICAgICAgdmFyIHBvc1N0YXJ0ID0gZWxlbW50LnByb3AoJ29mZnNldFRvcCcpIC0gdm0ub2Zmc2V0IC0gNTtcclxuICAgICAgICAgICAgdmFyIHBvc0VuZCA9IGVsZW1udC5wcm9wKCdvZmZzZXRUb3AnKSArIGVsZW1udFswXS5vZmZzZXRIZWlnaHQgLSB2bS5vZmZzZXQgLSA1O1xyXG4gICAgICAgICAgICBpZiAoJGRvY3VtZW50LnNjcm9sbFRvcCgpID49IHBvc1N0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgaWYgKCRkb2N1bWVudC5zY3JvbGxUb3AoKSA8PSBwb3NFbmQpIHtcclxuICAgICAgICAgICAgICAgIHZtLmN1cnJlbnQgPSB2bS5hdHRyaWJ1dGVzW2ldO1xyXG4gICAgICAgICAgICAgICAgbm90Rm91bmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGFzdEF0dHJpYnV0ZSA9IHZtLmF0dHJpYnV0ZXNbaSArIDFdO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAobm90Rm91bmQpIHtcclxuICAgICAgICAgICAgICB2bS5jdXJyZW50ID0gbGFzdEF0dHJpYnV0ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZW5kZXIoYXR0cmlidXRlKSB7XHJcbiAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgIT09IHZtLmN1cnJlbnQubmFtZSkge1xyXG4gICAgICAgICAgICBnb1RvKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgYXR0cmlidXRlLm5hbWUpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdvVG9OZXh0KGN1cnJlbnQpIHtcclxuICAgICAgICAgIHZhciBuZXh0RWxtbnQgPSBhbmd1bGFyLmVsZW1lbnQoY3VycmVudCkubmV4dCgpO1xyXG4gICAgICAgICAgZ29UbyhuZXh0RWxtbnRbMF0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ29UbyhlbG1udCkge1xyXG4gICAgICAgICAgJGRvY3VtZW50LnNjcm9sbFRvRWxlbWVudChlbG1udCwgdm0ub2Zmc2V0LCAxMDAwKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oXCIkZGVzdHJveVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBjaGVja1Bvcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXHJcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xyXG5cclxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xyXG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xhYi5hdHRyaWJ1dGVzJyxcclxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9hdHRyaWJ1dGVzJyxcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSAtIGF0dHJpYnV0ZXMnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdHRyaWJ1dGVzQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnYXR0cmlidXRlc1ZtJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9sYWIvYXR0cmlidXRlcy9hdHRyaWJ1dGVzLnZpZXcuaHRtbCdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5wcm9kdWN0cycpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1Byb2R1Y3RzQ29udHJvbGxlcicsIFByb2R1Y3RzQ29udHJvbGxlcik7XHJcblxyXG4gICAgUHJvZHVjdHNDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICckc3RhdGUnLCAnZGF0YXNlcnZpY2UnXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIFByb2R1Y3RzQ29udHJvbGxlcigkc2NvcGUsICRzdGF0ZSwgZGF0YXNlcnZpY2UpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuICAgICAgICB2bS5zZWxlY3QgPSBzZWxlY3Q7XHJcblxyXG4gICAgICAgIGFjdGl2YXRlKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xyXG4gICAgICAgICAgZGF0YXNlcnZpY2UucmVhZHkoKS50aGVuKGdldFByb2R1Y3RzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2R1Y3RzKCkge1xyXG4gICAgICAgICAgdm0ucHJvZHVjdHMgPSBkYXRhc2VydmljZS5nZXRQcm9kdWN0cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2VsZWN0KHByb2R1Y3QpIHtcclxuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzLnByb2R1Y3QgPSBwcm9kdWN0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5wcm9kdWN0cycpXHJcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xyXG5cclxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xyXG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xhYi5wcm9kdWN0cycsXHJcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvcHJvZHVjdHMnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5IC0gcHJvZHVjdHMnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9kdWN0c0NvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3Byb2R1Y3RzVm0nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2xhYi9wcm9kdWN0cy9wcm9kdWN0cy52aWV3Lmh0bWwnXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgfVxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0J0blJhZGlvQ29udHJvbGxlcicsIEJ0blJhZGlvQ29udHJvbGxlcik7XHJcblxyXG4gICAgQnRuUmFkaW9Db250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICckZmlsdGVyJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBCdG5SYWRpb0NvbnRyb2xsZXIoJHNjb3BlLCAkZmlsdGVyKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5jaG9pY2UgPSBudWxsO1xyXG4gICAgICAgIHZtLmltZ1ByZXZpZXcgPSBudWxsO1xyXG4gICAgICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcclxuICAgICAgICB2bS5zZXRJbWdQcmV2aWV3ID0gc2V0SW1nUHJldmlldztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcclxuICAgICAgICAgIHZtLmNob2ljZSA9IGF0dHJpYnV0ZUNob2ljZWQ7XHJcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAgICAgc2V0SW1nUHJldmlldyh2bS5jaG9pY2UuaW1nKTtcclxuXHJcbiAgICAgICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldEltZ1ByZXZpZXcoaW1nKSB7XHJcbiAgICAgICAgICBpZiAodm0uYXR0cmlidXRlLmhhdmVJbWdQcmV2aWV3KSB7XHJcbiAgICAgICAgICAgIHZtLmltZ1ByZXZpZXcgPSBpbWc7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdDaGVja2JveENvbnRyb2xsZXInLCBDaGVja2JveENvbnRyb2xsZXIpO1xyXG5cclxuICAgIENoZWNrYm94Q29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIENoZWNrYm94Q29udHJvbGxlcigkc2NvcGUpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLmNob2ljZXMgPSBbXTtcclxuICAgICAgICB2bS5leGlzdHMgPSBleGlzdHM7XHJcbiAgICAgICAgdm0udG9nZ2xlID0gdG9nZ2xlO1xyXG4gICAgICAgIHZtLnNhdmVDaG9pY2VzID0gc2F2ZUNob2ljZXM7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGV4aXN0cyh2YWx1ZSkge1xyXG4gICAgICAgICAgcmV0dXJuIHZtLmNob2ljZXMuaW5kZXhPZih2YWx1ZSkgPiAtMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHRvZ2dsZSh2YWx1ZSkge1xyXG4gICAgICAgICAgdmFyIGlkeCA9IHZtLmNob2ljZXMuaW5kZXhPZih2YWx1ZSk7XHJcbiAgICAgICAgICBpZiAoaWR4ID4gLTEpIHtcclxuICAgICAgICAgICAgdm0uY2hvaWNlcy5zcGxpY2UoaWR4LCAxKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZtLmNob2ljZXMucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2F2ZUNob2ljZXMoKSB7XHJcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB2bS5jaG9pY2VzO1xyXG4gICAgICAgICAgJHNjb3BlLmF0dHJpYnV0ZXNWbS5nb1RvTmV4dChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHZtLmF0dHJpYnV0ZS5uYW1lKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAuY29udHJvbGxlcignQ29sb3JDb250cm9sbGVyJywgQ29sb3JDb250cm9sbGVyKTtcclxuXHJcbiAgICBDb2xvckNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBDb2xvckNvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XHJcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xyXG4gICAgICAgIHZtLnNldE9wYWNpdHkgPSBzZXRPcGFjaXR5O1xyXG4gICAgICAgIHZtLnNhdmVDaG9pY2UgPSBzYXZlQ2hvaWNlO1xyXG4gICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xyXG4gICAgICAgICAgaWYgKHZtLmNob2ljZSkge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9ybS1jb2xvci0nICsgdm0uY2hvaWNlKS5zdHlsZS5vcGFjaXR5ID0gMTtcclxuICAgICAgICAgICAgdm0ucGVyY2VudCA9IDEwMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHZtLmNob2ljZSA9IGF0dHJpYnV0ZUNob2ljZWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzYXZlQ2hvaWNlKCkge1xyXG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0ge3ZhbHVlOiB2bS5jaG9pY2UsIHBlcmNlbnQ6IHZtLnBlcmNlbnR9O1xyXG4gICAgICAgICAgJHNjb3BlLmF0dHJpYnV0ZXNWbS5nb1RvTmV4dChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHZtLmF0dHJpYnV0ZS5uYW1lKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRPcGFjaXR5KCkge1xyXG4gICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvcm0tY29sb3ItJyArIHZtLmNob2ljZSkuc3R5bGUub3BhY2l0eSA9IHZtLnBlcmNlbnQgLyAxMDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAuY29udHJvbGxlcignSW5wdXRUZXh0Q29udHJvbGxlcicsIElucHV0VGV4dENvbnRyb2xsZXIpO1xyXG5cclxuICAgIElucHV0VGV4dENvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBJbnB1dFRleHRDb250cm9sbGVyKCRzY29wZSkge1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcclxuICAgICAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldENob2ljZSgpIHtcclxuICAgICAgICAgIGlmICh2bS5jaG9pY2UgIT09IFwiXCIgJiYgdm0uY2hvaWNlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IHZtLmNob2ljZTtcclxuICAgICAgICAgICAgJHNjb3BlLmF0dHJpYnV0ZXNWbS5nb1RvTmV4dChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHZtLmF0dHJpYnV0ZS5uYW1lKSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBkZWxldGUgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAuY29udHJvbGxlcignUmFkaW9TbGlkZXJDb250cm9sbGVyJywgUmFkaW9TbGlkZXJDb250cm9sbGVyKTtcclxuXHJcbiAgICBSYWRpb1NsaWRlckNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBSYWRpb1NsaWRlckNvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XHJcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xyXG4gICAgICAgIHZtLnNhdmVDaG9pY2UgPSBzYXZlQ2hvaWNlO1xyXG4gICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xyXG4gICAgICAgICAgaWYgKHZtLmNob2ljZSkge1xyXG4gICAgICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdm0uY2hvaWNlID0gYXR0cmlidXRlQ2hvaWNlZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVDaG9pY2UoKSB7XHJcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB7dmFsdWU6IHZtLmNob2ljZSwgcGVyY2VudDogdm0ucGVyY2VudH07XHJcbiAgICAgICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICBhbmd1bGFyXHJcbiAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXHJcbiAgICAgIC5jb250cm9sbGVyKCdJbWdSYWRpb0NvbnRyb2xsZXInLCBJbWdSYWRpb0NvbnRyb2xsZXIpO1xyXG5cclxuICBJbWdSYWRpb0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIEltZ1JhZGlvQ29udHJvbGxlcigkc2NvcGUpIHtcclxuICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICB2bS5jaG9pY2UgPSBudWxsO1xyXG4gICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xyXG4gICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdDcmVhbUNvbnRyb2xsZXInLCBDcmVhbUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIENyZWFtQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIENyZWFtQ29udHJvbGxlcigkc2NvcGUpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
