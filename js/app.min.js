!function(){"use strict";angular.module("app",["app.core","app.lab","app.homepage","app.layout"])}(),function(){"use strict";angular.module("app.core",["ngAnimate","ngSanitize","blocks.exception","blocks.logger","blocks.router","ui.router","ngMaterial","smoothScroll"])}(),function(){"use strict";function t(t,e,r){t.debugEnabled&&t.debugEnabled(!0),r.configure(o.appErrorPrefix),e.configure({docTitle:o.appTitle+": "})}var e=angular.module("app.core"),o={appErrorPrefix:"[<%= appName %> Error] ",appTitle:"<%= appName %>"};e.value("config",o),e.config(t),t.$inject=["$logProvider","routerHelperProvider","exceptionHandlerProvider"]}(),function(){"use strict";function t(t){var o="/404";t.configureStates(e(),o)}function e(){return[{state:"404",config:{url:"/404",templateUrl:"app/core/404.html",title:"404"}}]}t.$inject=["routerHelper"],angular.module("app.core").run(t)}(),function(){"use strict";function t(t,e,o,r){function n(){return a.products}function c(){return i.then(function(t){return a=t.data,!0},function(){return r.error("Impossible de récupérer les données"),!1})}var u="/ressources/products.json",i=t.get(u),a=null,l={ready:c,getProducts:n};return l}angular.module("app.core").factory("dataservice",t),t.$inject=["$http","$q","exception","logger"]}(),function(){"use strict";function t(){return function(t,e){for(var o=0,r=t.length;r>o;o++)if(t[o].value==e||t[o].name==e)return t[o];return null}}angular.module("app.core").filter("getByName",t)}(),function(){"use strict";angular.module("blocks.exception",["blocks.logger"])}(),function(){"use strict";angular.module("blocks.logger",[])}(),function(){"use strict";angular.module("blocks.router",["ui.router","blocks.logger"])}(),function(){"use strict";function t(){this.config={appErrorPrefix:void 0},this.configure=function(t){this.config.appErrorPrefix=t},this.$get=function(){return{config:this.config}}}function e(t){t.decorator("$exceptionHandler",o)}function o(t,e,o){return function(r,n){var c=e.config.appErrorPrefix||"",u={exception:r,cause:n};r.message=c+r.message,t(r,n),o.error(r.message,u)}}angular.module("blocks.exception").provider("exceptionHandler",t).config(e),e.$inject=["$provide"],o.$inject=["$delegate","exceptionHandler","logger"]}(),function(){"use strict";function t(t,e){function o(o){return function(r){var n,c;return r.data&&r.data.description&&(n="\n"+r.data.description,c=o+n),r.data.description=c,e.error(c),t.reject(r)}}var r={catcher:o};return r}t.$inject=["$q","logger"],angular.module("blocks.exception").factory("exception",t)}(),function(){"use strict";function t(t,e){function o(e,o,r){console.error(e,r),t.error("Error: "+e,o)}function r(e,o,r){console.info(e,r),t.info("Info: "+e,o)}function n(e,o,r){console.log(e,r),t.info("Success: "+e,o)}function c(e,o,r){console.warn(e,r),t.warn("Warning: "+e,o)}var u={error:o,info:r,success:n,warning:c,log:t.log};return u}angular.module("blocks.logger").factory("logger",t),t.$inject=["$log"]}(),function(){"use strict";function t(t,e,o){function r(t,r,c,u){function i(t,r){t.forEach(function(t){t.config.resolve=angular.extend(t.config.resolve||{},n.resolveAlways),e.state(t.state,t.config)}),r&&!g&&(g=!0,o.otherwise(r))}function a(){r.$on("$stateChangeError",function(e,o,r,n,c,i){if(!f){m.errors++,f=!0;var a=o&&(o.title||o.name||o.loadedTemplateUrl)||"unknown target",l="Error routing to "+a+". "+(i.data||"")+". <br/>"+(i.statusText||"")+": "+(i.status||"");u.warning(l,[o]),t.path("/")}})}function l(){a(),p()}function s(){return c.get()}function p(){r.$on("$stateChangeSuccess",function(t,e,o,c,u){m.changes++,f=!1;var i=n.docTitle+" "+(e.title||"");r.title=i})}var f=!1,g=!1,m={errors:0,changes:0},d={configureStates:i,getStates:s,stateCounts:m};return l(),d}var n={docTitle:void 0,resolveAlways:{}};t.html5Mode({enabled:!1,requireBase:!1}),this.configure=function(t){angular.extend(n,t)},this.$get=r,r.$inject=["$location","$rootScope","$state","logger"]}angular.module("blocks.router").provider("routerHelper",t),t.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}(),function(){"use strict";angular.module("app.lab.attributes",["app.core"])}(),function(){angular.module("app.lab.products",["app.core"])}(),function(){"use strict";angular.module("app.homepage",["app.core"])}(),function(){angular.module("app.lab",["app.core","app.lab.products","app.lab.attributes"])}(),function(){"use strict";angular.module("app.layout",["app.core"])}(),function(){"use strict";function t(){var t=this;t.title="Homepage"}angular.module("app.homepage").controller("HomeController",t)}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"homepage",config:{url:"/",templateUrl:"app/homepage/homepage.view.html",controller:"HomeController",controllerAs:"home",title:"DoYourBeauty"}}]}angular.module("app.homepage").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){var e=this;e.choices={}}angular.module("app.lab").controller("LabController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab",config:{url:"/lab",templateUrl:"app/lab/lab.view.html",controller:"LabController",controllerAs:"labVm",title:"DoYourBeauty - Lab"}}]}angular.module("app.lab").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){}angular.module("app.layout").controller("HeaderController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t,e,o,r,n,c){function u(){return"undefined"==typeof t.labVm.choices.product?void e.go("lab.products"):(m.product=t.labVm.choices.product,m.attributes=r("orderBy")(m.product.attributes,"order"),void(m.current=m.attributes[0]))}function i(t){return"app/lab/attributes/forms/"+t.form+"/"+t.form+".view.html"}function a(t){return"app/lab/attributes/results/"+t.name+"/"+t.name+".view.html"}function l(e){return"undefined"!=typeof t.labVm.choices[e.name]}function s(e){for(var o=m.attributes.length,r=!0;o>0&&r;)document.getElementById(m.attributes[o-1].name)&&document.getElementById(m.attributes[o-1].name).offsetTop-200<=n.pageYOffset&&(m.current=m.attributes[o-1],r=!1,t.$apply()),o--}function p(t){t.name!==m.current.name&&g(document.querySelector("#"+t.name))}function f(t){var e=angular.element(t).next();g(e[0])}function g(t){o(t,{offset:180,duration:1e3,easing:"easeOutCubic"})}var m=this;m.product=null,m.attributes=[],m.getForm=i,m.getResultView=a,m.choiceValidate=l,m.render=p,m.goToNext=f,n.addEventListener("scroll",s),u(),t.$on("$destroy",function(){n.removeEventListener("scroll",s)})}angular.module("app.lab.attributes").controller("AttributesController",t),t.$inject=["$scope","$state","smoothScroll","$filter","$window","$document"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab.attributes",config:{url:"/attributes",title:"DoYourBeauty - attributes",controller:"AttributesController",controllerAs:"attributesVm",templateUrl:"app/lab/attributes/attributes.view.html"}}]}angular.module("app.lab.attributes").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e,o){function r(){o.ready().then(n)}function n(){u.products=o.getProducts()}function c(e){t.labVm.choices.product=e}var u=this;u.select=c,r()}angular.module("app.lab.products").controller("ProductsController",t),t.$inject=["$scope","$state","dataservice"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab.products",config:{url:"/products",title:"DoYourBeauty - products",controller:"ProductsController",controllerAs:"productsVm",templateUrl:"app/lab/products/products.view.html"}}]}angular.module("app.lab.products").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e){function o(e){n.choice=e,t.labVm.choices[n.attribute.name]=e,r(n.choice.img),t.attributesVm.goToNext(document.querySelector("#"+n.attribute.name))}function r(t){n.attribute.haveImgPreview&&(n.imgPreview=t)}var n=this;n.choice=null,n.imgPreview=null,n.setChoice=o,n.setImgPreview=r}angular.module("app.lab.attributes").controller("BtnRadioController",t),t.$inject=["$scope","$filter"]}(),function(){"use strict";function t(t){function e(t){return n.choices.indexOf(t)>-1}function o(t){var e=n.choices.indexOf(t);e>-1?n.choices.splice(e,1):n.choices.push(t)}function r(){t.labVm.choices[n.attribute.name]=n.choices,t.attributesVm.goToNext(document.querySelector("#"+n.attribute.name))}var n=this;n.choices=[],n.exists=e,n.toggle=o,n.saveChoices=r}angular.module("app.lab.attributes").controller("CheckboxController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(t){n.choice&&(document.getElementById("form-color-"+n.choice).style.opacity=1,n.percent=100),n.choice=t}function o(){t.labVm.choices[n.attribute.name]={value:n.choice,percent:n.percent},t.attributesVm.goToNext(document.querySelector("#"+n.attribute.name))}function r(){document.getElementById("form-color-"+n.choice).style.opacity=n.percent/100}var n=this,n=this;n.choice=null,n.setChoice=e,n.setOpacity=r,n.saveChoice=o,n.percent=100}angular.module("app.lab.attributes").controller("ColorController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(e){o.choice=e,t.labVm.choices[o.attribute.name]=e,t.attributesVm.goToNext(document.querySelector("#"+o.attribute.name))}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("ImgRadioController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(){""!==o.choice&&null!==o.choice?(t.labVm.choices[o.attribute.name]=o.choice,t.attributesVm.goToNext(document.querySelector("#"+o.attribute.name))):delete t.labVm.choices[o.attribute.name]}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("InputTextController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(t){r.choice&&(r.percent=100),r.choice=t}function o(){t.labVm.choices[r.attribute.name]={value:r.choice,percent:r.percent},t.attributesVm.goToNext(document.querySelector("#"+r.attribute.name))}var r=this,r=this;r.choice=null,r.setChoice=e,r.saveChoice=o,r.percent=100}angular.module("app.lab.attributes").controller("RadioSliderController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){}angular.module("app.lab.attributes").controller("CreamController",t),t.$inject=["$scope"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjb3JlLm1vZHVsZS5qcyIsImNvbmZpZy5qcyIsImNvcmUucm91dGUuanMiLCJhcHAubWluLmpzIiwiZGF0YXNlcnZpY2UuanMiLCJnZXRieW5hbWUuZmlsdGVyLmpzIiwiZXhjZXB0aW9uL2V4Y2VwdGlvbi5tb2R1bGUuanMiLCJsb2dnZXIvbG9nZ2VyLm1vZHVsZS5qcyIsInJvdXRlci9yb3V0ZXIubW9kdWxlLmpzIiwiZXhjZXB0aW9uL2V4Y2VwdGlvbi1oYW5kbGVyLnByb3ZpZGVyLmpzIiwiZXhjZXB0aW9uL2V4Y2VwdGlvbi5qcyIsImxvZ2dlci9sb2dnZXIuanMiLCJyb3V0ZXIvcm91dGVyLWhlbHBlci5wcm92aWRlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2F0dHJpYnV0ZXMubW9kdWxlLmpzIiwibGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLm1vZHVsZS5qcyIsImhvbWVwYWdlL2hvbWVwYWdlLm1vZHVsZS5qcyIsImxhYi9sYWIubW9kdWxlLmpzIiwibGF5b3V0L2xheW91dC5tb2R1bGUuanMiLCJob21lcGFnZS9ob21lcGFnZS5jb250cm9sbGVyLmpzIiwiaG9tZXBhZ2UvaG9tZXBhZ2Uucm91dGUuanMiLCJsYWIvbGFiLmNvbnRyb2xsZXIuanMiLCJsYWIvbGFiLnJvdXRlLmpzIiwibGF5b3V0L2hlYWRlci5jb250cm9sbGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy5jb250cm9sbGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy5yb3V0ZS5qcyIsImxhYi9wcm9kdWN0cy9wcm9kdWN0cy5jb250cm9sbGVyLmpzIiwibGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLnJvdXRlLmpzIiwibGFiL2F0dHJpYnV0ZXMvZm9ybXMvYnRuLXJhZGlvL2J0bi1yYWRpby5jb250cm9sbGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvZm9ybXMvY2hlY2tib3gvY2hlY2tib3guY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2Zvcm1zL2NvbG9yL2NvbG9yLmNvbnRyb2xsZXIuanMiLCJsYWIvYXR0cmlidXRlcy9mb3Jtcy9pbWctcmFkaW8vaW1nLXJhZGlvLmNvbnRyb2xsZXIuanMiLCJsYWIvYXR0cmlidXRlcy9mb3Jtcy9pbnB1dC10ZXh0L2lucHV0LXRleHQuY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2Zvcm1zL3JhZGlvLXNsaWRlci9yYWRpby1zbGlkZXIuY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL3Jlc3VsdHMvY3JlYW0vY3JlYW0uY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlndXJlIiwiJGxvZ1Byb3ZpZGVyIiwicm91dGVySGVscGVyUHJvdmlkZXIiLCJleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIiLCJkZWJ1Z0VuYWJsZWQiLCJjb25maWciLCJhcHBFcnJvclByZWZpeCIsImRvY1RpdGxlIiwiYXBwVGl0bGUiLCJjb3JlIiwidmFsdWUiLCIkaW5qZWN0IiwiYXBwUnVuIiwicm91dGVySGVscGVyIiwib3RoZXJ3aXNlIiwiY29uZmlndXJlU3RhdGVzIiwiZ2V0U3RhdGVzIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsInRpdGxlIiwicnVuIiwiZGF0YXNlcnZpY2UiLCIkaHR0cCIsIiRxIiwiZXhjZXB0aW9uIiwibG9nZ2VyIiwiZ2V0UHJvZHVjdHMiLCJkYXRhIiwicHJvZHVjdHMiLCJyZWFkeSIsInByb21pc2UiLCJ0aGVuIiwicmVzdWx0IiwiZXJyb3IiLCJqc29uVVJMIiwiZ2V0Iiwic2VydmljZSIsImZhY3RvcnkiLCJnZXRCeU5hbWUiLCJpbnB1dCIsIm5hbWUiLCJpIiwibGVuZ3RoIiwiZmlsdGVyIiwidGhpcyIsInVuZGVmaW5lZCIsIiRnZXQiLCIkcHJvdmlkZSIsImRlY29yYXRvciIsImV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIiLCIkZGVsZWdhdGUiLCJleGNlcHRpb25IYW5kbGVyIiwiY2F1c2UiLCJlcnJvckRhdGEiLCJtZXNzYWdlIiwicHJvdmlkZXIiLCJjYXRjaGVyIiwiZSIsInRocm93bkRlc2NyaXB0aW9uIiwibmV3TWVzc2FnZSIsImRlc2NyaXB0aW9uIiwicmVqZWN0IiwiJGxvZyIsInRvYXN0ciIsImNvbnNvbGUiLCJpbmZvIiwic3VjY2VzcyIsImxvZyIsIndhcm5pbmciLCJ3YXJuIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIlJvdXRlckhlbHBlciIsIiRsb2NhdGlvbiIsIiRyb290U2NvcGUiLCIkc3RhdGUiLCJzdGF0ZXMiLCJvdGhlcndpc2VQYXRoIiwiZm9yRWFjaCIsInJlc29sdmUiLCJleHRlbmQiLCJyZXNvbHZlQWx3YXlzIiwiaGFzT3RoZXJ3aXNlIiwiaGFuZGxlUm91dGluZ0Vycm9ycyIsIiRvbiIsImV2ZW50IiwidG9TdGF0ZSIsInRvUGFyYW1zIiwiZnJvbVN0YXRlIiwiZnJvbVBhcmFtcyIsImhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciIsInN0YXRlQ291bnRzIiwiZXJyb3JzIiwiZGVzdGluYXRpb24iLCJsb2FkZWRUZW1wbGF0ZVVybCIsIm1zZyIsInN0YXR1c1RleHQiLCJzdGF0dXMiLCJwYXRoIiwiaW5pdCIsInVwZGF0ZURvY1RpdGxlIiwiY2hhbmdlcyIsImh0bWw1TW9kZSIsImVuYWJsZWQiLCJyZXF1aXJlQmFzZSIsImNmZyIsIkhvbWVDb250cm9sbGVyIiwidm0iLCJjb250cm9sbGVyIiwiY29udHJvbGxlckFzIiwiTGFiQ29udHJvbGxlciIsIiRzY29wZSIsImNob2ljZXMiLCJIZWFkZXJDb250cm9sbGVyIiwiQXR0cmlidXRlc0NvbnRyb2xsZXIiLCJzbW9vdGhTY3JvbGwiLCIkZmlsdGVyIiwiJHdpbmRvdyIsIiRkb2N1bWVudCIsImFjdGl2YXRlIiwibGFiVm0iLCJwcm9kdWN0IiwiZ28iLCJhdHRyaWJ1dGVzIiwiY3VycmVudCIsImdldEZvcm0iLCJhdHRyaWJ1dGUiLCJmb3JtIiwiZ2V0UmVzdWx0VmlldyIsImNob2ljZVZhbGlkYXRlIiwiY2hlY2tQb3MiLCJub3RGb3VuZCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJvZmZzZXRUb3AiLCJwYWdlWU9mZnNldCIsIiRhcHBseSIsInJlbmRlciIsImdvVG8iLCJxdWVyeVNlbGVjdG9yIiwiZ29Ub05leHQiLCJuZXh0RWxtbnQiLCJlbGVtZW50IiwibmV4dCIsImVsbW50Iiwib2Zmc2V0IiwiZHVyYXRpb24iLCJlYXNpbmciLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlByb2R1Y3RzQ29udHJvbGxlciIsInNlbGVjdCIsIkJ0blJhZGlvQ29udHJvbGxlciIsInNldENob2ljZSIsImF0dHJpYnV0ZUNob2ljZWQiLCJjaG9pY2UiLCJzZXRJbWdQcmV2aWV3IiwiaW1nIiwiYXR0cmlidXRlc1ZtIiwiaGF2ZUltZ1ByZXZpZXciLCJpbWdQcmV2aWV3IiwiQ2hlY2tib3hDb250cm9sbGVyIiwiZXhpc3RzIiwiaW5kZXhPZiIsInRvZ2dsZSIsImlkeCIsInNwbGljZSIsInB1c2giLCJzYXZlQ2hvaWNlcyIsIkNvbG9yQ29udHJvbGxlciIsInN0eWxlIiwib3BhY2l0eSIsInBlcmNlbnQiLCJzYXZlQ2hvaWNlIiwic2V0T3BhY2l0eSIsIkltZ1JhZGlvQ29udHJvbGxlciIsIklucHV0VGV4dENvbnRyb2xsZXIiLCJSYWRpb1NsaWRlckNvbnRyb2xsZXIiLCJDcmVhbUNvbnRyb2xsZXIiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0EsWUFFQUEsU0FBQUMsT0FBQSxPQUNBLFdBQ0EsVUFDQSxlQUNBLGtCQ1BBLFdBQ0EsWUFFQUQsU0FDQUMsT0FBQSxZQUNBLFlBQUEsYUFDQSxtQkFBQSxnQkFBQSxnQkFDQSxZQUFBLGFBQUEsb0JDUEEsV0FDQSxZQWNBLFNBQUFDLEdBQUFDLEVBQUFDLEVBQUFDLEdBQ0FGLEVBQUFHLGNBQ0FILEVBQUFHLGNBQUEsR0FFQUQsRUFBQUgsVUFBQUssRUFBQUMsZ0JBQ0FKLEVBQUFGLFdBQUFPLFNB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QWhELEVBQUFnRCxRQUNBNUMsRUFBQVMsTUFBQVIsUUFBQUwsRUFBQW1CLFVBQUF2RixNQUFBb0UsRUFBQWdELE9BQ0E1QyxFQUFBK0MsYUFBQWxCLFNBQUFSLFNBQUFPLGNBQUEsSUFBQWhDLEVBQUFtQixVQUFBdkYsY0FFQXdFLEdBQUFTLE1BQUFSLFFBQUFMLEVBQUFtQixVQUFBdkYsTUFUQSxHQUFBb0UsR0FBQWhFLElBQ0FnRSxHQUFBZ0QsT0FBQSxLQUNBaEQsRUFBQThDLFVBQUFBLEVBVkE3SixRQUNBQyxPQUFBLHNCQUNBK0csV0FBQSxzQkFBQW9FLEdBRUFBLEVBQUF2SyxTQUFBLGFDUEEsV0FDQSxZQVNBLFNBQUF3SyxHQUFBbEUsR0FTQSxRQUFBMEMsR0FBQUMsR0FDQS9DLEVBQUFnRCxTQUNBaEQsRUFBQWlFLFFBQUEsS0FFQWpFLEVBQUFnRCxPQUFBRCxFQUdBLFFBQUFtQixLQUNBOUQsRUFBQVMsTUFBQVIsUUFBQUwsRUFBQW1CLFVBQUF2RixPQUFBL0IsTUFBQW1HLEVBQUFnRCxPQUFBaUIsUUFBQWpFLEVBQUFpRSxTQUNBN0QsRUFBQStDLGFBQUFsQixTQUFBUixTQUFBTyxjQUFBLElBQUFoQyxFQUFBbUIsVUFBQXZGLE9BakJBLEdBQUFvRSxHQUFBaEUsS0FDQWdFLEVBQUFoRSxJQUNBZ0UsR0FBQWdELE9BQUEsS0FDQWhELEVBQUE4QyxVQUFBQSxFQUNBOUMsRUFBQWtFLFdBQUFBLEVBQ0FsRSxFQUFBaUUsUUFBQSxJQWJBaEwsUUFDQUMsT0FBQSxzQkFDQStHLFdBQUEsd0JBQUFxRSxHQUVBQSxFQUFBeEssU0FBQSxhQ1BBLFdBQ0EsWUFTQSxTQUFBeUssR0FBQW5FLElBUEFuSCxRQUNBQyxPQUFBLHNCQUNBK0csV0FBQSxrQkFBQXNFLEdBRUFBLEVBQUF6SyxTQUFBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXHJcbiAgICAgICAgJ2FwcC5jb3JlJyxcclxuICAgICAgICAnYXBwLmxhYicsXHJcbiAgICAgICAgJ2FwcC5ob21lcGFnZScsXHJcbiAgICAgICAgJ2FwcC5sYXlvdXQnXHJcbiAgICBdKTtcclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJywgW1xyXG4gICAgICAgICAgICAnbmdBbmltYXRlJywgJ25nU2FuaXRpemUnLFxyXG4gICAgICAgICAgICAnYmxvY2tzLmV4Y2VwdGlvbicsICdibG9ja3MubG9nZ2VyJywgJ2Jsb2Nrcy5yb3V0ZXInLFxyXG4gICAgICAgICAgICAndWkucm91dGVyJywgJ25nTWF0ZXJpYWwnLCAnc21vb3RoU2Nyb2xsJ1xyXG4gICAgICAgIF0pO1xyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBjb3JlID0gYW5ndWxhci5tb2R1bGUoJ2FwcC5jb3JlJyk7XHJcbiAgICB2YXIgY29uZmlnID0ge1xyXG4gICAgICAgIGFwcEVycm9yUHJlZml4OiAnWzwlPSBhcHBOYW1lICU+IEVycm9yXSAnLFxyXG4gICAgICAgIGFwcFRpdGxlOiAnPCU9IGFwcE5hbWUgJT4nXHJcbiAgICB9O1xyXG5cclxuICAgIGNvcmUudmFsdWUoJ2NvbmZpZycsIGNvbmZpZyk7XHJcblxyXG4gICAgY29yZS5jb25maWcoY29uZmlndXJlKTtcclxuXHJcbiAgICBjb25maWd1cmUuJGluamVjdCA9IFsnJGxvZ1Byb3ZpZGVyJywgJ3JvdXRlckhlbHBlclByb3ZpZGVyJywgJ2V4Y2VwdGlvbkhhbmRsZXJQcm92aWRlciddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBjb25maWd1cmUoJGxvZ1Byb3ZpZGVyLCByb3V0ZXJIZWxwZXJQcm92aWRlciwgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKSB7XHJcbiAgICAgICAgaWYgKCRsb2dQcm92aWRlci5kZWJ1Z0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgJGxvZ1Byb3ZpZGVyLmRlYnVnRW5hYmxlZCh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyLmNvbmZpZ3VyZShjb25maWcuYXBwRXJyb3JQcmVmaXgpO1xyXG4gICAgICAgIHJvdXRlckhlbHBlclByb3ZpZGVyLmNvbmZpZ3VyZSh7ZG9jVGl0bGU6IGNvbmZpZy5hcHBUaXRsZSArICc6ICd9KTtcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvcmUnKVxyXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcclxuICAgICAgICB2YXIgb3RoZXJ3aXNlID0gJy80MDQnO1xyXG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCksIG90aGVyd2lzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlOiAnNDA0JyxcclxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy80MDQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2NvcmUvNDA0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnNDA0J1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuICAgIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xyXG4gICAgICAgICdhcHAuY29yZScsXHJcbiAgICAgICAgJ2FwcC5sYWInLFxyXG4gICAgICAgICdhcHAuaG9tZXBhZ2UnLFxyXG4gICAgICAgICdhcHAubGF5b3V0J1xyXG4gICAgXSk7XHJcblxyXG59KSgpO1xyXG5cbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJywgW1xyXG4gICAgICAgICAgICAnbmdBbmltYXRlJywgJ25nU2FuaXRpemUnLFxyXG4gICAgICAgICAgICAnYmxvY2tzLmV4Y2VwdGlvbicsICdibG9ja3MubG9nZ2VyJywgJ2Jsb2Nrcy5yb3V0ZXInLFxyXG4gICAgICAgICAgICAndWkucm91dGVyJywgJ25nTWF0ZXJpYWwnLCAnc21vb3RoU2Nyb2xsJ1xyXG4gICAgICAgIF0pO1xyXG59KSgpO1xyXG5cbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIGNvcmUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwLmNvcmUnKTtcclxuICAgIHZhciBjb25maWcgPSB7XHJcbiAgICAgICAgYXBwRXJyb3JQcmVmaXg6ICdbPCU9IGFwcE5hbWUgJT4gRXJyb3JdICcsXHJcbiAgICAgICAgYXBwVGl0bGU6ICc8JT0gYXBwTmFtZSAlPidcclxuICAgIH07XHJcblxyXG4gICAgY29yZS52YWx1ZSgnY29uZmlnJywgY29uZmlnKTtcclxuXHJcbiAgICBjb3JlLmNvbmZpZyhjb25maWd1cmUpO1xyXG5cclxuICAgIGNvbmZpZ3VyZS4kaW5qZWN0ID0gWyckbG9nUHJvdmlkZXInLCAncm91dGVySGVscGVyUHJvdmlkZXInLCAnZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyJ107XHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZSgkbG9nUHJvdmlkZXIsIHJvdXRlckhlbHBlclByb3ZpZGVyLCBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIpIHtcclxuICAgICAgICBpZiAoJGxvZ1Byb3ZpZGVyLmRlYnVnRW5hYmxlZCkge1xyXG4gICAgICAgICAgICAkbG9nUHJvdmlkZXIuZGVidWdFbmFibGVkKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIuY29uZmlndXJlKGNvbmZpZy5hcHBFcnJvclByZWZpeCk7XHJcbiAgICAgICAgcm91dGVySGVscGVyUHJvdmlkZXIuY29uZmlndXJlKHtkb2NUaXRsZTogY29uZmlnLmFwcFRpdGxlICsgJzogJ30pO1xyXG4gICAgfVxyXG5cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbXCJyb3V0ZXJIZWxwZXJcIl07XHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvcmUnKVxyXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcclxuICAgICAgICB2YXIgb3RoZXJ3aXNlID0gJy80MDQnO1xyXG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCksIG90aGVyd2lzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlOiAnNDA0JyxcclxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy80MDQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2NvcmUvNDA0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnNDA0J1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuICAgIH1cclxufSkoKTtcclxuXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuY29yZScpXHJcbiAgICAgICAgLmZhY3RvcnkoJ2RhdGFzZXJ2aWNlJywgZGF0YXNlcnZpY2UpO1xyXG5cclxuICAgIGRhdGFzZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywgJyRxJywgJ2V4Y2VwdGlvbicsICdsb2dnZXInXTtcclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gZGF0YXNlcnZpY2UoJGh0dHAsICRxLCBleGNlcHRpb24sIGxvZ2dlcikge1xyXG4gICAgICAgIHZhciBqc29uVVJMID0gJy9yZXNzb3VyY2VzL3Byb2R1Y3RzLmpzb24nO1xyXG4gICAgICAgIHZhciBwcm9taXNlID0gJGh0dHAuZ2V0KGpzb25VUkwpO1xyXG4gICAgICAgIHZhciBkYXRhID0gbnVsbDtcclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgIHJlYWR5OiByZWFkeSxcclxuICAgICAgICAgIGdldFByb2R1Y3RzOiBnZXRQcm9kdWN0c1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRQcm9kdWN0cygpIHtcclxuICAgICAgICAgIHJldHVybiBkYXRhLnByb2R1Y3RzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVhZHkoKSB7XHJcbiAgICAgICAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBkYXRhID0gcmVzdWx0LmRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignSW1wb3NzaWJsZSBkZSByw6ljdXDDqXJlciBsZXMgZG9ubsOpZXMnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uICgpIHtcclxuICAndXNlIHN0cmljdCc7XHJcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5jb3JlJylcclxuICAgIC5maWx0ZXIoJ2dldEJ5TmFtZScsIGdldEJ5TmFtZSk7XHJcblxyXG4gIGZ1bmN0aW9uIGdldEJ5TmFtZSgpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgbmFtZSkge1xyXG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gaW5wdXQubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAoaW5wdXRbaV0udmFsdWUgPT0gbmFtZSB8fCBpbnB1dFtpXS5uYW1lID09IG5hbWUpIHtcclxuICAgICAgICAgIHJldHVybiBpbnB1dFtpXTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicsIFsnYmxvY2tzLmxvZ2dlciddKTtcclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInLCBbXSk7XHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdibG9ja3Mucm91dGVyJywgW1xyXG4gICAgICAgICd1aS5yb3V0ZXInLFxyXG4gICAgICAgICdibG9ja3MubG9nZ2VyJ1xyXG4gICAgXSk7XHJcbn0pKCk7XHJcblxuLy8gSW5jbHVkZSBpbiBpbmRleC5odG1sIHNvIHRoYXQgYXBwIGxldmVsIGV4Y2VwdGlvbnMgYXJlIGhhbmRsZWQuXHJcbi8vIEV4Y2x1ZGUgZnJvbSB0ZXN0UnVubmVyLmh0bWwgd2hpY2ggc2hvdWxkIHJ1biBleGFjdGx5IHdoYXQgaXQgd2FudHMgdG8gcnVuXHJcbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicpXHJcbiAgICAgICAgLnByb3ZpZGVyKCdleGNlcHRpb25IYW5kbGVyJywgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKVxyXG4gICAgICAgIC5jb25maWcoY29uZmlnKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIE11c3QgY29uZmlndXJlIHRoZSBleGNlcHRpb24gaGFuZGxpbmdcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKCkge1xyXG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xyXG4gICAgICAgIHRoaXMuY29uZmlnID0ge1xyXG4gICAgICAgICAgICBhcHBFcnJvclByZWZpeDogdW5kZWZpbmVkXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5jb25maWd1cmUgPSBmdW5jdGlvbiAoYXBwRXJyb3JQcmVmaXgpIHtcclxuICAgICAgICAgICAgdGhpcy5jb25maWcuYXBwRXJyb3JQcmVmaXggPSBhcHBFcnJvclByZWZpeDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLiRnZXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtjb25maWc6IHRoaXMuY29uZmlnfTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpZy4kaW5qZWN0ID0gWyckcHJvdmlkZSddO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29uZmlndXJlIGJ5IHNldHRpbmcgYW4gb3B0aW9uYWwgc3RyaW5nIHZhbHVlIGZvciBhcHBFcnJvclByZWZpeC5cclxuICAgICAqIEFjY2Vzc2libGUgdmlhIGNvbmZpZy5hcHBFcnJvclByZWZpeCAodmlhIGNvbmZpZyB2YWx1ZSkuXHJcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9ICRwcm92aWRlXHJcbiAgICAgKi9cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gY29uZmlnKCRwcm92aWRlKSB7XHJcbiAgICAgICAgJHByb3ZpZGUuZGVjb3JhdG9yKCckZXhjZXB0aW9uSGFuZGxlcicsIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIuJGluamVjdCA9IFsnJGRlbGVnYXRlJywgJ2V4Y2VwdGlvbkhhbmRsZXInLCAnbG9nZ2VyJ107XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFeHRlbmQgdGhlICRleGNlcHRpb25IYW5kbGVyIHNlcnZpY2UgdG8gYWxzbyBkaXNwbGF5IGEgdG9hc3QuXHJcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9ICRkZWxlZ2F0ZVxyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBleGNlcHRpb25IYW5kbGVyXHJcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGxvZ2dlclxyXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IHRoZSBkZWNvcmF0ZWQgJGV4Y2VwdGlvbkhhbmRsZXIgc2VydmljZVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBleHRlbmRFeGNlcHRpb25IYW5kbGVyKCRkZWxlZ2F0ZSwgZXhjZXB0aW9uSGFuZGxlciwgbG9nZ2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGV4Y2VwdGlvbiwgY2F1c2UpIHtcclxuICAgICAgICAgICAgdmFyIGFwcEVycm9yUHJlZml4ID0gZXhjZXB0aW9uSGFuZGxlci5jb25maWcuYXBwRXJyb3JQcmVmaXggfHwgJyc7XHJcbiAgICAgICAgICAgIHZhciBlcnJvckRhdGEgPSB7ZXhjZXB0aW9uOiBleGNlcHRpb24sIGNhdXNlOiBjYXVzZX07XHJcbiAgICAgICAgICAgIGV4Y2VwdGlvbi5tZXNzYWdlID0gYXBwRXJyb3JQcmVmaXggKyBleGNlcHRpb24ubWVzc2FnZTtcclxuICAgICAgICAgICAgJGRlbGVnYXRlKGV4Y2VwdGlvbiwgY2F1c2UpO1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogQ291bGQgYWRkIHRoZSBlcnJvciB0byBhIHNlcnZpY2UncyBjb2xsZWN0aW9uLFxyXG4gICAgICAgICAgICAgKiBhZGQgZXJyb3JzIHRvICRyb290U2NvcGUsIGxvZyBlcnJvcnMgdG8gcmVtb3RlIHdlYiBzZXJ2ZXIsXHJcbiAgICAgICAgICAgICAqIG9yIGxvZyBsb2NhbGx5LiBPciB0aHJvdyBoYXJkLiBJdCBpcyBlbnRpcmVseSB1cCB0byB5b3UuXHJcbiAgICAgICAgICAgICAqIHRocm93IGV4Y2VwdGlvbjtcclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQGV4YW1wbGVcclxuICAgICAgICAgICAgICogICAgIHRocm93IHsgbWVzc2FnZTogJ2Vycm9yIG1lc3NhZ2Ugd2UgYWRkZWQnIH07XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXhjZXB0aW9uLm1lc3NhZ2UsIGVycm9yRGF0YSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgZXhjZXB0aW9uLiRpbmplY3QgPSBbXCIkcVwiLCBcImxvZ2dlclwiXTtcclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJylcclxuICAgICAgICAuZmFjdG9yeSgnZXhjZXB0aW9uJywgZXhjZXB0aW9uKTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGV4Y2VwdGlvbigkcSwgbG9nZ2VyKSB7XHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIGNhdGNoZXI6IGNhdGNoZXJcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjYXRjaGVyKG1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0aHJvd25EZXNjcmlwdGlvbjtcclxuICAgICAgICAgICAgICAgIHZhciBuZXdNZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuZGF0YSAmJiBlLmRhdGEuZGVzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvd25EZXNjcmlwdGlvbiA9ICdcXG4nICsgZS5kYXRhLmRlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld01lc3NhZ2UgPSBtZXNzYWdlICsgdGhyb3duRGVzY3JpcHRpb247XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlLmRhdGEuZGVzY3JpcHRpb24gPSBuZXdNZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5ld01lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChlKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdibG9ja3MubG9nZ2VyJylcclxuICAgICAgICAuZmFjdG9yeSgnbG9nZ2VyJywgbG9nZ2VyKTtcclxuXHJcbiAgICBsb2dnZXIuJGluamVjdCA9IFsnJGxvZyddO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gbG9nZ2VyKCRsb2csIHRvYXN0cikge1xyXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgICBlcnJvciAgIDogZXJyb3IsXHJcbiAgICAgICAgICAgIGluZm8gICAgOiBpbmZvLFxyXG4gICAgICAgICAgICBzdWNjZXNzIDogc3VjY2VzcyxcclxuICAgICAgICAgICAgd2FybmluZyA6IHdhcm5pbmcsXHJcblxyXG4gICAgICAgICAgICAvLyBzdHJhaWdodCB0byBjb25zb2xlOyBieXBhc3MgdG9hc3RyXHJcbiAgICAgICAgICAgIGxvZyAgICAgOiAkbG9nLmxvZ1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKG1lc3NhZ2UsIHRpdGxlKTtcclxuICAgICAgICAgICAgJGxvZy5lcnJvcignRXJyb3I6ICcgKyBtZXNzYWdlLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGluZm8obWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5pbmZvKG1lc3NhZ2UsIHRpdGxlKTtcclxuICAgICAgICAgICAgJGxvZy5pbmZvKCdJbmZvOiAnICsgbWVzc2FnZSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UsIHRpdGxlKTtcclxuICAgICAgICAgICAgJGxvZy5pbmZvKCdTdWNjZXNzOiAnICsgbWVzc2FnZSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB3YXJuaW5nKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlLCB0aXRsZSk7XHJcbiAgICAgICAgICAgICRsb2cud2FybignV2FybmluZzogJyArIG1lc3NhZ2UsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSgpKTtcclxuXG4vKiBIZWxwIGNvbmZpZ3VyZSB0aGUgc3RhdGUtYmFzZSB1aS5yb3V0ZXIgKi9cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdibG9ja3Mucm91dGVyJylcclxuICAgICAgICAucHJvdmlkZXIoJ3JvdXRlckhlbHBlcicsIHJvdXRlckhlbHBlclByb3ZpZGVyKTtcclxuXHJcbiAgICByb3V0ZXJIZWxwZXJQcm92aWRlci4kaW5qZWN0ID0gWyckbG9jYXRpb25Qcm92aWRlcicsICckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInXTtcclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gcm91dGVySGVscGVyUHJvdmlkZXIoJGxvY2F0aW9uUHJvdmlkZXIsICRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcclxuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cclxuICAgICAgICB2YXIgY29uZmlnID0ge1xyXG4gICAgICAgICAgICBkb2NUaXRsZTogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICByZXNvbHZlQWx3YXlzOiB7fVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh7XHJcbiAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcclxuICAgICAgICAgIHJlcXVpcmVCYXNlOiBmYWxzZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uKGNmZykge1xyXG4gICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChjb25maWcsIGNmZyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy4kZ2V0ID0gUm91dGVySGVscGVyO1xyXG4gICAgICAgIFJvdXRlckhlbHBlci4kaW5qZWN0ID0gWyckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsICckc3RhdGUnLCAnbG9nZ2VyJ107XHJcbiAgICAgICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICAgICAgZnVuY3Rpb24gUm91dGVySGVscGVyKCRsb2NhdGlvbiwgJHJvb3RTY29wZSwgJHN0YXRlLCBsb2dnZXIpIHtcclxuICAgICAgICAgICAgdmFyIGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciA9IGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgaGFzT3RoZXJ3aXNlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciBzdGF0ZUNvdW50cyA9IHtcclxuICAgICAgICAgICAgICAgIGVycm9yczogMCxcclxuICAgICAgICAgICAgICAgIGNoYW5nZXM6IDBcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgICAgICAgY29uZmlndXJlU3RhdGVzOiBjb25maWd1cmVTdGF0ZXMsXHJcbiAgICAgICAgICAgICAgICBnZXRTdGF0ZXM6IGdldFN0YXRlcyxcclxuICAgICAgICAgICAgICAgIHN0YXRlQ291bnRzOiBzdGF0ZUNvdW50c1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaW5pdCgpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcblxyXG4gICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy9cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZVN0YXRlcyhzdGF0ZXMsIG90aGVyd2lzZVBhdGgpIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlcy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuY29uZmlnLnJlc29sdmUgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChzdGF0ZS5jb25maWcucmVzb2x2ZSB8fCB7fSwgY29uZmlnLnJlc29sdmVBbHdheXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKHN0YXRlLnN0YXRlLCBzdGF0ZS5jb25maWcpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAob3RoZXJ3aXNlUGF0aCAmJiAhaGFzT3RoZXJ3aXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFzT3RoZXJ3aXNlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKG90aGVyd2lzZVBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVSb3V0aW5nRXJyb3JzKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gUm91dGUgY2FuY2VsbGF0aW9uOlxyXG4gICAgICAgICAgICAgICAgLy8gT24gcm91dGluZyBlcnJvciwgZ28gdG8gdGhlIGRhc2hib2FyZC5cclxuICAgICAgICAgICAgICAgIC8vIFByb3ZpZGUgYW4gZXhpdCBjbGF1c2UgaWYgaXQgdHJpZXMgdG8gZG8gaXQgdHdpY2UuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlRXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudHMuZXJyb3JzKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZXN0aW5hdGlvbiA9ICh0b1N0YXRlICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodG9TdGF0ZS50aXRsZSB8fCB0b1N0YXRlLm5hbWUgfHwgdG9TdGF0ZS5sb2FkZWRUZW1wbGF0ZVVybCkpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndW5rbm93biB0YXJnZXQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbXNnID0gJ0Vycm9yIHJvdXRpbmcgdG8gJyArIGRlc3RpbmF0aW9uICsgJy4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZXJyb3IuZGF0YSB8fCAnJykgKyAnLiA8YnIvPicgKyAoZXJyb3Iuc3RhdHVzVGV4dCB8fCAnJykgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzogJyArIChlcnJvci5zdGF0dXMgfHwgJycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyhtc2csIFt0b1N0YXRlXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGhhbmRsZVJvdXRpbmdFcnJvcnMoKTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZURvY1RpdGxlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHsgcmV0dXJuICRzdGF0ZS5nZXQoKTsgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlRG9jVGl0bGUoKSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudHMuY2hhbmdlcysrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gY29uZmlnLmRvY1RpdGxlICsgJyAnICsgKHRvU3RhdGUudGl0bGUgfHwgJycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnRpdGxlID0gdGl0bGU7IC8vIGRhdGEgYmluZCB0byA8dGl0bGU+XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJywgWydhcHAuY29yZSddKTtcclxuXHJcbn0pICgpO1xyXG5cbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAubGFiLnByb2R1Y3RzJywgWydhcHAuY29yZSddKTtcclxuXHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uICgpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG5cclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmhvbWVwYWdlJywgW1xyXG4gICAgJ2FwcC5jb3JlJ1xyXG4gIF0pO1xyXG5cclxufSkgKCk7XHJcblxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYWInLCBbXHJcbiAgICAnYXBwLmNvcmUnLFxyXG4gICAgJ2FwcC5sYWIucHJvZHVjdHMnLFxyXG4gICAgJ2FwcC5sYWIuYXR0cmlidXRlcydcclxuICBdKTtcclxuXHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAubGF5b3V0JywgW1xyXG4gICAgICAnYXBwLmNvcmUnXHJcbiAgICBdKTtcclxufSkoKTtcclxuXG4oZnVuY3Rpb24gKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5ob21lcGFnZScpLmNvbnRyb2xsZXIoJ0hvbWVDb250cm9sbGVyJywgSG9tZUNvbnRyb2xsZXIpO1xyXG5cclxuICBmdW5jdGlvbiBIb21lQ29udHJvbGxlcigpwqB7XHJcbiAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgdm0udGl0bGUgPSAnSG9tZXBhZ2UnO1xyXG4gIH1cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5ob21lcGFnZScpXHJcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xyXG5cclxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xyXG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2hvbWVwYWdlJyxcclxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy8nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2hvbWVwYWdlL2hvbWVwYWdlLnZpZXcuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdob21lJyxcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiJylcclxuICAgICAgICAuY29udHJvbGxlcignTGFiQ29udHJvbGxlcicsIExhYkNvbnRyb2xsZXIpO1xyXG5cclxuICAgIExhYkNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBMYWJDb250cm9sbGVyKCRzY29wZSkge1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgdm0uY2hvaWNlcyA9IHt9O1xyXG4gICAgfVxyXG5cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWInKVxyXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcclxuXHJcbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcclxuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsYWInLFxyXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2xhYicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL2xhYi52aWV3Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMYWJDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsYWJWbScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBMYWInXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgfVxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxheW91dCcpXHJcbiAgICAgICAgICAuY29udHJvbGxlcignSGVhZGVyQ29udHJvbGxlcicsIEhlYWRlckNvbnRyb2xsZXIpO1xyXG5cclxuICAgIEhlYWRlckNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBIZWFkZXJDb250cm9sbGVyKCRzY29wZSkge1xyXG4gICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgfVxyXG5cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0F0dHJpYnV0ZXNDb250cm9sbGVyJywgQXR0cmlidXRlc0NvbnRyb2xsZXIpO1xyXG5cclxuICAgIEF0dHJpYnV0ZXNDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICckc3RhdGUnLCAnc21vb3RoU2Nyb2xsJywgJyRmaWx0ZXInLCAnJHdpbmRvdycsICckZG9jdW1lbnQnXTtcclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gQXR0cmlidXRlc0NvbnRyb2xsZXIoJHNjb3BlLCAkc3RhdGUsIHNtb290aFNjcm9sbCwgJGZpbHRlciwgJHdpbmRvdywgJGRvY3VtZW50KSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5wcm9kdWN0ID0gbnVsbDtcclxuICAgICAgICB2bS5hdHRyaWJ1dGVzID0gW107XHJcbiAgICAgICAgdm0uZ2V0Rm9ybSA9IGdldEZvcm07XHJcbiAgICAgICAgdm0uZ2V0UmVzdWx0VmlldyA9IGdldFJlc3VsdFZpZXc7XHJcbiAgICAgICAgdm0uY2hvaWNlVmFsaWRhdGUgPSBjaG9pY2VWYWxpZGF0ZTtcclxuICAgICAgICB2bS5yZW5kZXIgPSByZW5kZXI7XHJcbiAgICAgICAgdm0uZ29Ub05leHQgPSBnb1RvTmV4dDtcclxuXHJcbiAgICAgICAgJHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIGNoZWNrUG9zKTtcclxuXHJcbiAgICAgICAgYWN0aXZhdGUoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XHJcbiAgICAgICAgICBpZiAodHlwZW9mICRzY29wZS5sYWJWbS5jaG9pY2VzLnByb2R1Y3QgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgJHN0YXRlLmdvKCdsYWIucHJvZHVjdHMnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdm0ucHJvZHVjdCA9ICRzY29wZS5sYWJWbS5jaG9pY2VzLnByb2R1Y3Q7XHJcbiAgICAgICAgICB2bS5hdHRyaWJ1dGVzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLnByb2R1Y3QuYXR0cmlidXRlcywgJ29yZGVyJyk7XHJcbiAgICAgICAgICB2bS5jdXJyZW50ID0gdm0uYXR0cmlidXRlc1swXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEZvcm0oYXR0cmlidXRlKSB7XHJcbiAgICAgICAgICByZXR1cm4gXCJhcHAvbGFiL2F0dHJpYnV0ZXMvZm9ybXMvXCIgKyBhdHRyaWJ1dGUuZm9ybSArIFwiL1wiICsgIGF0dHJpYnV0ZS5mb3JtICsgXCIudmlldy5odG1sXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRSZXN1bHRWaWV3KHByb2R1Y3QpIHtcclxuICAgICAgICAgIHJldHVybiBcImFwcC9sYWIvYXR0cmlidXRlcy9yZXN1bHRzL1wiICsgcHJvZHVjdC5uYW1lICsgXCIvXCIgKyBwcm9kdWN0Lm5hbWUgKyBcIi52aWV3Lmh0bWxcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNob2ljZVZhbGlkYXRlKGF0dHJpYnV0ZSkge1xyXG4gICAgICAgICAgcmV0dXJuIHR5cGVvZiAkc2NvcGUubGFiVm0uY2hvaWNlc1thdHRyaWJ1dGUubmFtZV0gIT09IFwidW5kZWZpbmVkXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjaGVja1BvcyhlKSB7XHJcbiAgICAgICAgICB2YXIgaSA9IHZtLmF0dHJpYnV0ZXMubGVuZ3RoO1xyXG4gICAgICAgICAgdmFyIG5vdEZvdW5kID0gdHJ1ZTtcclxuICAgICAgICAgIHdoaWxlIChpID4gMCAmJiBub3RGb3VuZCkge1xyXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodm0uYXR0cmlidXRlc1tpLTFdLm5hbWUpICYmIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHZtLmF0dHJpYnV0ZXNbaS0xXS5uYW1lKS5vZmZzZXRUb3AgLSAyMDAgPD0gJHdpbmRvdy5wYWdlWU9mZnNldCkge1xyXG4gICAgICAgICAgICAgIHZtLmN1cnJlbnQgPSB2bS5hdHRyaWJ1dGVzW2ktMV07XHJcbiAgICAgICAgICAgICAgbm90Rm91bmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaS0tO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVuZGVyKGF0dHJpYnV0ZSkge1xyXG4gICAgICAgICAgaWYgKGF0dHJpYnV0ZS5uYW1lICE9PSB2bS5jdXJyZW50Lm5hbWUpIHtcclxuICAgICAgICAgICAgZ29Ubyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIGF0dHJpYnV0ZS5uYW1lKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnb1RvTmV4dChjdXJyZW50KSB7XHJcbiAgICAgICAgICB2YXIgbmV4dEVsbW50ID0gYW5ndWxhci5lbGVtZW50KGN1cnJlbnQpLm5leHQoKTtcclxuICAgICAgICAgIGdvVG8obmV4dEVsbW50WzBdKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdvVG8oZWxtbnQpIHtcclxuICAgICAgICAgIHNtb290aFNjcm9sbChlbG1udCwge1xyXG4gICAgICAgICAgICAgb2Zmc2V0OiAxODAsXHJcbiAgICAgICAgICAgICBkdXJhdGlvbjogMTAwMCxcclxuICAgICAgICAgICAgIGVhc2luZzogJ2Vhc2VPdXRDdWJpYydcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbihcIiRkZXN0cm95XCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgJHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIGNoZWNrUG9zKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcclxuXHJcbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcclxuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsYWIuYXR0cmlidXRlcycsXHJcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXR0cmlidXRlcycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBhdHRyaWJ1dGVzJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQXR0cmlidXRlc0NvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2F0dHJpYnV0ZXNWbScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy52aWV3Lmh0bWwnXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgfVxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5wcm9kdWN0cycpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1Byb2R1Y3RzQ29udHJvbGxlcicsIFByb2R1Y3RzQ29udHJvbGxlcik7XHJcblxyXG4gICAgUHJvZHVjdHNDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICckc3RhdGUnLCAnZGF0YXNlcnZpY2UnXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIFByb2R1Y3RzQ29udHJvbGxlcigkc2NvcGUsICRzdGF0ZSwgZGF0YXNlcnZpY2UpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuICAgICAgICB2bS5zZWxlY3QgPSBzZWxlY3Q7XHJcblxyXG4gICAgICAgIGFjdGl2YXRlKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xyXG4gICAgICAgICAgZGF0YXNlcnZpY2UucmVhZHkoKS50aGVuKGdldFByb2R1Y3RzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2R1Y3RzKCkge1xyXG4gICAgICAgICAgdm0ucHJvZHVjdHMgPSBkYXRhc2VydmljZS5nZXRQcm9kdWN0cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2VsZWN0KHByb2R1Y3QpIHtcclxuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzLnByb2R1Y3QgPSBwcm9kdWN0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLnByb2R1Y3RzJylcclxuICAgICAgICAucnVuKGFwcFJ1bik7XHJcblxyXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XHJcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGFiLnByb2R1Y3RzJyxcclxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9wcm9kdWN0cycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBwcm9kdWN0cycsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2R1Y3RzQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAncHJvZHVjdHNWbScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLnZpZXcuaHRtbCdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdCdG5SYWRpb0NvbnRyb2xsZXInLCBCdG5SYWRpb0NvbnRyb2xsZXIpO1xyXG5cclxuICAgIEJ0blJhZGlvQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJGZpbHRlciddO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gQnRuUmFkaW9Db250cm9sbGVyKCRzY29wZSwgJGZpbHRlcikge1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcclxuICAgICAgICB2bS5pbWdQcmV2aWV3ID0gbnVsbDtcclxuICAgICAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XHJcbiAgICAgICAgdm0uc2V0SW1nUHJldmlldyA9IHNldEltZ1ByZXZpZXc7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldENob2ljZShhdHRyaWJ1dGVDaG9pY2VkKSB7XHJcbiAgICAgICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gYXR0cmlidXRlQ2hvaWNlZDtcclxuICAgICAgICAgIHNldEltZ1ByZXZpZXcodm0uY2hvaWNlLmltZyk7XHJcblxyXG4gICAgICAgICAgJHNjb3BlLmF0dHJpYnV0ZXNWbS5nb1RvTmV4dChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHZtLmF0dHJpYnV0ZS5uYW1lKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRJbWdQcmV2aWV3KGltZykge1xyXG4gICAgICAgICAgaWYgKHZtLmF0dHJpYnV0ZS5oYXZlSW1nUHJldmlldykge1xyXG4gICAgICAgICAgICB2bS5pbWdQcmV2aWV3ID0gaW1nO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdDaGVja2JveENvbnRyb2xsZXInLCBDaGVja2JveENvbnRyb2xsZXIpO1xyXG5cclxuICAgIENoZWNrYm94Q29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIENoZWNrYm94Q29udHJvbGxlcigkc2NvcGUpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLmNob2ljZXMgPSBbXTtcclxuICAgICAgICB2bS5leGlzdHMgPSBleGlzdHM7XHJcbiAgICAgICAgdm0udG9nZ2xlID0gdG9nZ2xlO1xyXG4gICAgICAgIHZtLnNhdmVDaG9pY2VzID0gc2F2ZUNob2ljZXM7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGV4aXN0cyh2YWx1ZSkge1xyXG4gICAgICAgICAgcmV0dXJuIHZtLmNob2ljZXMuaW5kZXhPZih2YWx1ZSkgPiAtMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHRvZ2dsZSh2YWx1ZSkge1xyXG4gICAgICAgICAgdmFyIGlkeCA9IHZtLmNob2ljZXMuaW5kZXhPZih2YWx1ZSk7XHJcbiAgICAgICAgICBpZiAoaWR4ID4gLTEpIHtcclxuICAgICAgICAgICAgdm0uY2hvaWNlcy5zcGxpY2UoaWR4LCAxKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZtLmNob2ljZXMucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2F2ZUNob2ljZXMoKSB7XHJcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB2bS5jaG9pY2VzO1xyXG4gICAgICAgICAgJHNjb3BlLmF0dHJpYnV0ZXNWbS5nb1RvTmV4dChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHZtLmF0dHJpYnV0ZS5uYW1lKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcblxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdDb2xvckNvbnRyb2xsZXInLCBDb2xvckNvbnRyb2xsZXIpO1xyXG5cclxuICAgIENvbG9yQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIENvbG9yQ29udHJvbGxlcigkc2NvcGUpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcclxuICAgICAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XHJcbiAgICAgICAgdm0uc2V0T3BhY2l0eSA9IHNldE9wYWNpdHk7XHJcbiAgICAgICAgdm0uc2F2ZUNob2ljZSA9IHNhdmVDaG9pY2U7XHJcbiAgICAgICAgdm0ucGVyY2VudCA9IDEwMDtcclxuXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldENob2ljZShhdHRyaWJ1dGVDaG9pY2VkKSB7XHJcbiAgICAgICAgICBpZiAodm0uY2hvaWNlKSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb3JtLWNvbG9yLScgKyB2bS5jaG9pY2UpLnN0eWxlLm9wYWNpdHkgPSAxO1xyXG4gICAgICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdm0uY2hvaWNlID0gYXR0cmlidXRlQ2hvaWNlZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVDaG9pY2UoKSB7XHJcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB7dmFsdWU6IHZtLmNob2ljZSwgcGVyY2VudDogdm0ucGVyY2VudH07XHJcbiAgICAgICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldE9wYWNpdHkoKSB7XHJcbiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9ybS1jb2xvci0nICsgdm0uY2hvaWNlKS5zdHlsZS5vcGFjaXR5ID0gdm0ucGVyY2VudCAvIDEwMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICBhbmd1bGFyXHJcbiAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXHJcbiAgICAgIC5jb250cm9sbGVyKCdJbWdSYWRpb0NvbnRyb2xsZXInLCBJbWdSYWRpb0NvbnRyb2xsZXIpO1xyXG5cclxuICBJbWdSYWRpb0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIEltZ1JhZGlvQ29udHJvbGxlcigkc2NvcGUpIHtcclxuICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICB2bS5jaG9pY2UgPSBudWxsO1xyXG4gICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xyXG4gICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0lucHV0VGV4dENvbnRyb2xsZXInLCBJbnB1dFRleHRDb250cm9sbGVyKTtcclxuXHJcbiAgICBJbnB1dFRleHRDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gSW5wdXRUZXh0Q29udHJvbGxlcigkc2NvcGUpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XHJcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoKSB7XHJcbiAgICAgICAgICBpZiAodm0uY2hvaWNlICE9PSBcIlwiICYmIHZtLmNob2ljZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB2bS5jaG9pY2U7XHJcbiAgICAgICAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGVsZXRlICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAuY29udHJvbGxlcignUmFkaW9TbGlkZXJDb250cm9sbGVyJywgUmFkaW9TbGlkZXJDb250cm9sbGVyKTtcclxuXHJcbiAgICBSYWRpb1NsaWRlckNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBSYWRpb1NsaWRlckNvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XHJcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xyXG4gICAgICAgIHZtLnNhdmVDaG9pY2UgPSBzYXZlQ2hvaWNlO1xyXG4gICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xyXG4gICAgICAgICAgaWYgKHZtLmNob2ljZSkge1xyXG4gICAgICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdm0uY2hvaWNlID0gYXR0cmlidXRlQ2hvaWNlZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVDaG9pY2UoKSB7XHJcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB7dmFsdWU6IHZtLmNob2ljZSwgcGVyY2VudDogdm0ucGVyY2VudH07XHJcbiAgICAgICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAuY29udHJvbGxlcignQ3JlYW1Db250cm9sbGVyJywgQ3JlYW1Db250cm9sbGVyKTtcclxuXHJcbiAgICBDcmVhbUNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBDcmVhbUNvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJylcclxuICAgICAgICAuZmFjdG9yeSgnZGF0YXNlcnZpY2UnLCBkYXRhc2VydmljZSk7XHJcblxyXG4gICAgZGF0YXNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCAnJHEnLCAnZXhjZXB0aW9uJywgJ2xvZ2dlciddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBkYXRhc2VydmljZSgkaHR0cCwgJHEsIGV4Y2VwdGlvbiwgbG9nZ2VyKSB7XHJcbiAgICAgICAgdmFyIGpzb25VUkwgPSAnL3Jlc3NvdXJjZXMvcHJvZHVjdHMuanNvbic7XHJcbiAgICAgICAgdmFyIHByb21pc2UgPSAkaHR0cC5nZXQoanNvblVSTCk7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBudWxsO1xyXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgcmVhZHk6IHJlYWR5LFxyXG4gICAgICAgICAgZ2V0UHJvZHVjdHM6IGdldFByb2R1Y3RzXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2R1Y3RzKCkge1xyXG4gICAgICAgICAgcmV0dXJuIGRhdGEucHJvZHVjdHM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZWFkeSgpIHtcclxuICAgICAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSByZXN1bHQuZGF0YTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdJbXBvc3NpYmxlIGRlIHLDqWN1cMOpcmVyIGxlcyBkb25uw6llcycpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uICgpIHtcclxuICAndXNlIHN0cmljdCc7XHJcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5jb3JlJylcclxuICAgIC5maWx0ZXIoJ2dldEJ5TmFtZScsIGdldEJ5TmFtZSk7XHJcblxyXG4gIGZ1bmN0aW9uIGdldEJ5TmFtZSgpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgbmFtZSkge1xyXG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gaW5wdXQubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAoaW5wdXRbaV0udmFsdWUgPT0gbmFtZSB8fCBpbnB1dFtpXS5uYW1lID09IG5hbWUpIHtcclxuICAgICAgICAgIHJldHVybiBpbnB1dFtpXTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nLCBbJ2Jsb2Nrcy5sb2dnZXInXSk7XHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYmxvY2tzLmxvZ2dlcicsIFtdKTtcclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdibG9ja3Mucm91dGVyJywgW1xyXG4gICAgICAgICd1aS5yb3V0ZXInLFxyXG4gICAgICAgICdibG9ja3MubG9nZ2VyJ1xyXG4gICAgXSk7XHJcbn0pKCk7XHJcbiIsIi8vIEluY2x1ZGUgaW4gaW5kZXguaHRtbCBzbyB0aGF0IGFwcCBsZXZlbCBleGNlcHRpb25zIGFyZSBoYW5kbGVkLlxyXG4vLyBFeGNsdWRlIGZyb20gdGVzdFJ1bm5lci5odG1sIHdoaWNoIHNob3VsZCBydW4gZXhhY3RseSB3aGF0IGl0IHdhbnRzIHRvIHJ1blxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nKVxyXG4gICAgICAgIC5wcm92aWRlcignZXhjZXB0aW9uSGFuZGxlcicsIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcilcclxuICAgICAgICAuY29uZmlnKGNvbmZpZyk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNdXN0IGNvbmZpZ3VyZSB0aGUgZXhjZXB0aW9uIGhhbmRsaW5nXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcigpIHtcclxuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cclxuICAgICAgICB0aGlzLmNvbmZpZyA9IHtcclxuICAgICAgICAgICAgYXBwRXJyb3JQcmVmaXg6IHVuZGVmaW5lZFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlndXJlID0gZnVuY3Rpb24gKGFwcEVycm9yUHJlZml4KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmFwcEVycm9yUHJlZml4ID0gYXBwRXJyb3JQcmVmaXg7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7Y29uZmlnOiB0aGlzLmNvbmZpZ307XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25maWcuJGluamVjdCA9IFsnJHByb3ZpZGUnXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbmZpZ3VyZSBieSBzZXR0aW5nIGFuIG9wdGlvbmFsIHN0cmluZyB2YWx1ZSBmb3IgYXBwRXJyb3JQcmVmaXguXHJcbiAgICAgKiBBY2Nlc3NpYmxlIHZpYSBjb25maWcuYXBwRXJyb3JQcmVmaXggKHZpYSBjb25maWcgdmFsdWUpLlxyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSAkcHJvdmlkZVxyXG4gICAgICovXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGNvbmZpZygkcHJvdmlkZSkge1xyXG4gICAgICAgICRwcm92aWRlLmRlY29yYXRvcignJGV4Y2VwdGlvbkhhbmRsZXInLCBleHRlbmRFeGNlcHRpb25IYW5kbGVyKTtcclxuICAgIH1cclxuXHJcbiAgICBleHRlbmRFeGNlcHRpb25IYW5kbGVyLiRpbmplY3QgPSBbJyRkZWxlZ2F0ZScsICdleGNlcHRpb25IYW5kbGVyJywgJ2xvZ2dlciddO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0ZW5kIHRoZSAkZXhjZXB0aW9uSGFuZGxlciBzZXJ2aWNlIHRvIGFsc28gZGlzcGxheSBhIHRvYXN0LlxyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSAkZGVsZWdhdGVcclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gZXhjZXB0aW9uSGFuZGxlclxyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSBsb2dnZXJcclxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSB0aGUgZGVjb3JhdGVkICRleGNlcHRpb25IYW5kbGVyIHNlcnZpY2VcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZXh0ZW5kRXhjZXB0aW9uSGFuZGxlcigkZGVsZWdhdGUsIGV4Y2VwdGlvbkhhbmRsZXIsIGxvZ2dlcikge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihleGNlcHRpb24sIGNhdXNlKSB7XHJcbiAgICAgICAgICAgIHZhciBhcHBFcnJvclByZWZpeCA9IGV4Y2VwdGlvbkhhbmRsZXIuY29uZmlnLmFwcEVycm9yUHJlZml4IHx8ICcnO1xyXG4gICAgICAgICAgICB2YXIgZXJyb3JEYXRhID0ge2V4Y2VwdGlvbjogZXhjZXB0aW9uLCBjYXVzZTogY2F1c2V9O1xyXG4gICAgICAgICAgICBleGNlcHRpb24ubWVzc2FnZSA9IGFwcEVycm9yUHJlZml4ICsgZXhjZXB0aW9uLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgICRkZWxlZ2F0ZShleGNlcHRpb24sIGNhdXNlKTtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIENvdWxkIGFkZCB0aGUgZXJyb3IgdG8gYSBzZXJ2aWNlJ3MgY29sbGVjdGlvbixcclxuICAgICAgICAgICAgICogYWRkIGVycm9ycyB0byAkcm9vdFNjb3BlLCBsb2cgZXJyb3JzIHRvIHJlbW90ZSB3ZWIgc2VydmVyLFxyXG4gICAgICAgICAgICAgKiBvciBsb2cgbG9jYWxseS4gT3IgdGhyb3cgaGFyZC4gSXQgaXMgZW50aXJlbHkgdXAgdG8geW91LlxyXG4gICAgICAgICAgICAgKiB0aHJvdyBleGNlcHRpb247XHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEBleGFtcGxlXHJcbiAgICAgICAgICAgICAqICAgICB0aHJvdyB7IG1lc3NhZ2U6ICdlcnJvciBtZXNzYWdlIHdlIGFkZGVkJyB9O1xyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGV4Y2VwdGlvbi5tZXNzYWdlLCBlcnJvckRhdGEpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicpXHJcbiAgICAgICAgLmZhY3RvcnkoJ2V4Y2VwdGlvbicsIGV4Y2VwdGlvbik7XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBleGNlcHRpb24oJHEsIGxvZ2dlcikge1xyXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgICBjYXRjaGVyOiBjYXRjaGVyXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2F0Y2hlcihtZXNzYWdlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGhyb3duRGVzY3JpcHRpb247XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3TWVzc2FnZTtcclxuICAgICAgICAgICAgICAgIGlmIChlLmRhdGEgJiYgZS5kYXRhLmRlc2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3duRGVzY3JpcHRpb24gPSAnXFxuJyArIGUuZGF0YS5kZXNjcmlwdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBuZXdNZXNzYWdlID0gbWVzc2FnZSArIHRocm93bkRlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZS5kYXRhLmRlc2NyaXB0aW9uID0gbmV3TWVzc2FnZTtcclxuICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihuZXdNZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QoZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInKVxyXG4gICAgICAgIC5mYWN0b3J5KCdsb2dnZXInLCBsb2dnZXIpO1xyXG5cclxuICAgIGxvZ2dlci4kaW5qZWN0ID0gWyckbG9nJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBsb2dnZXIoJGxvZywgdG9hc3RyKSB7XHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIGVycm9yICAgOiBlcnJvcixcclxuICAgICAgICAgICAgaW5mbyAgICA6IGluZm8sXHJcbiAgICAgICAgICAgIHN1Y2Nlc3MgOiBzdWNjZXNzLFxyXG4gICAgICAgICAgICB3YXJuaW5nIDogd2FybmluZyxcclxuXHJcbiAgICAgICAgICAgIC8vIHN0cmFpZ2h0IHRvIGNvbnNvbGU7IGJ5cGFzcyB0b2FzdHJcclxuICAgICAgICAgICAgbG9nICAgICA6ICRsb2cubG9nXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSwgdGl0bGUpO1xyXG4gICAgICAgICAgICAkbG9nLmVycm9yKCdFcnJvcjogJyArIG1lc3NhZ2UsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaW5mbyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmluZm8obWVzc2FnZSwgdGl0bGUpO1xyXG4gICAgICAgICAgICAkbG9nLmluZm8oJ0luZm86ICcgKyBtZXNzYWdlLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSwgdGl0bGUpO1xyXG4gICAgICAgICAgICAkbG9nLmluZm8oJ1N1Y2Nlc3M6ICcgKyBtZXNzYWdlLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKG1lc3NhZ2UsIHRpdGxlKTtcclxuICAgICAgICAgICAgJGxvZy53YXJuKCdXYXJuaW5nOiAnICsgbWVzc2FnZSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KCkpO1xyXG4iLCIvKiBIZWxwIGNvbmZpZ3VyZSB0aGUgc3RhdGUtYmFzZSB1aS5yb3V0ZXIgKi9cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdibG9ja3Mucm91dGVyJylcclxuICAgICAgICAucHJvdmlkZXIoJ3JvdXRlckhlbHBlcicsIHJvdXRlckhlbHBlclByb3ZpZGVyKTtcclxuXHJcbiAgICByb3V0ZXJIZWxwZXJQcm92aWRlci4kaW5qZWN0ID0gWyckbG9jYXRpb25Qcm92aWRlcicsICckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInXTtcclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gcm91dGVySGVscGVyUHJvdmlkZXIoJGxvY2F0aW9uUHJvdmlkZXIsICRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcclxuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cclxuICAgICAgICB2YXIgY29uZmlnID0ge1xyXG4gICAgICAgICAgICBkb2NUaXRsZTogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICByZXNvbHZlQWx3YXlzOiB7fVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh7XHJcbiAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcclxuICAgICAgICAgIHJlcXVpcmVCYXNlOiBmYWxzZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uKGNmZykge1xyXG4gICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChjb25maWcsIGNmZyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy4kZ2V0ID0gUm91dGVySGVscGVyO1xyXG4gICAgICAgIFJvdXRlckhlbHBlci4kaW5qZWN0ID0gWyckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsICckc3RhdGUnLCAnbG9nZ2VyJ107XHJcbiAgICAgICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICAgICAgZnVuY3Rpb24gUm91dGVySGVscGVyKCRsb2NhdGlvbiwgJHJvb3RTY29wZSwgJHN0YXRlLCBsb2dnZXIpIHtcclxuICAgICAgICAgICAgdmFyIGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciA9IGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgaGFzT3RoZXJ3aXNlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciBzdGF0ZUNvdW50cyA9IHtcclxuICAgICAgICAgICAgICAgIGVycm9yczogMCxcclxuICAgICAgICAgICAgICAgIGNoYW5nZXM6IDBcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgICAgICAgY29uZmlndXJlU3RhdGVzOiBjb25maWd1cmVTdGF0ZXMsXHJcbiAgICAgICAgICAgICAgICBnZXRTdGF0ZXM6IGdldFN0YXRlcyxcclxuICAgICAgICAgICAgICAgIHN0YXRlQ291bnRzOiBzdGF0ZUNvdW50c1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaW5pdCgpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcblxyXG4gICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy9cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZVN0YXRlcyhzdGF0ZXMsIG90aGVyd2lzZVBhdGgpIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlcy5mb3JFYWNoKGZ1bmN0aW9uKHN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuY29uZmlnLnJlc29sdmUgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChzdGF0ZS5jb25maWcucmVzb2x2ZSB8fCB7fSwgY29uZmlnLnJlc29sdmVBbHdheXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKHN0YXRlLnN0YXRlLCBzdGF0ZS5jb25maWcpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAob3RoZXJ3aXNlUGF0aCAmJiAhaGFzT3RoZXJ3aXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFzT3RoZXJ3aXNlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKG90aGVyd2lzZVBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVSb3V0aW5nRXJyb3JzKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gUm91dGUgY2FuY2VsbGF0aW9uOlxyXG4gICAgICAgICAgICAgICAgLy8gT24gcm91dGluZyBlcnJvciwgZ28gdG8gdGhlIGRhc2hib2FyZC5cclxuICAgICAgICAgICAgICAgIC8vIFByb3ZpZGUgYW4gZXhpdCBjbGF1c2UgaWYgaXQgdHJpZXMgdG8gZG8gaXQgdHdpY2UuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlRXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudHMuZXJyb3JzKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZXN0aW5hdGlvbiA9ICh0b1N0YXRlICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodG9TdGF0ZS50aXRsZSB8fCB0b1N0YXRlLm5hbWUgfHwgdG9TdGF0ZS5sb2FkZWRUZW1wbGF0ZVVybCkpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndW5rbm93biB0YXJnZXQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbXNnID0gJ0Vycm9yIHJvdXRpbmcgdG8gJyArIGRlc3RpbmF0aW9uICsgJy4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZXJyb3IuZGF0YSB8fCAnJykgKyAnLiA8YnIvPicgKyAoZXJyb3Iuc3RhdHVzVGV4dCB8fCAnJykgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzogJyArIChlcnJvci5zdGF0dXMgfHwgJycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyhtc2csIFt0b1N0YXRlXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGhhbmRsZVJvdXRpbmdFcnJvcnMoKTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZURvY1RpdGxlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHsgcmV0dXJuICRzdGF0ZS5nZXQoKTsgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlRG9jVGl0bGUoKSB7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudHMuY2hhbmdlcysrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gY29uZmlnLmRvY1RpdGxlICsgJyAnICsgKHRvU3RhdGUudGl0bGUgfHwgJycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnRpdGxlID0gdGl0bGU7IC8vIGRhdGEgYmluZCB0byA8dGl0bGU+XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycsIFsnYXBwLmNvcmUnXSk7XHJcblxyXG59KSAoKTtcclxuIiwiKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnLCBbJ2FwcC5jb3JlJ10pO1xyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uICgpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG5cclxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmhvbWVwYWdlJywgW1xyXG4gICAgJ2FwcC5jb3JlJ1xyXG4gIF0pO1xyXG5cclxufSkgKCk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcblxyXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAubGFiJywgW1xyXG4gICAgJ2FwcC5jb3JlJyxcclxuICAgICdhcHAubGFiLnByb2R1Y3RzJyxcclxuICAgICdhcHAubGFiLmF0dHJpYnV0ZXMnXHJcbiAgXSk7XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYXlvdXQnLCBbXHJcbiAgICAgICdhcHAuY29yZSdcclxuICAgIF0pO1xyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24gKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5ob21lcGFnZScpLmNvbnRyb2xsZXIoJ0hvbWVDb250cm9sbGVyJywgSG9tZUNvbnRyb2xsZXIpO1xyXG5cclxuICBmdW5jdGlvbiBIb21lQ29udHJvbGxlcigpwqB7XHJcbiAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgdm0udGl0bGUgPSAnSG9tZXBhZ2UnO1xyXG4gIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAuaG9tZXBhZ2UnKVxyXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcclxuXHJcbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcclxuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdob21lcGFnZScsXHJcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9ob21lcGFnZS9ob21lcGFnZS52aWV3Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnaG9tZScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHknXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgfVxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWInKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdMYWJDb250cm9sbGVyJywgTGFiQ29udHJvbGxlcik7XHJcblxyXG4gICAgTGFiQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIExhYkNvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5jaG9pY2VzID0ge307XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWInKVxyXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcclxuXHJcbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcclxuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsYWInLFxyXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2xhYicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL2xhYi52aWV3Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMYWJDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdsYWJWbScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBMYWInXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgfVxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYXlvdXQnKVxyXG4gICAgICAgICAgLmNvbnRyb2xsZXIoJ0hlYWRlckNvbnRyb2xsZXInLCBIZWFkZXJDb250cm9sbGVyKTtcclxuXHJcbiAgICBIZWFkZXJDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gSGVhZGVyQ29udHJvbGxlcigkc2NvcGUpIHtcclxuICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAuY29udHJvbGxlcignQXR0cmlidXRlc0NvbnRyb2xsZXInLCBBdHRyaWJ1dGVzQ29udHJvbGxlcik7XHJcblxyXG4gICAgQXR0cmlidXRlc0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJywgJyRzdGF0ZScsICdzbW9vdGhTY3JvbGwnLCAnJGZpbHRlcicsICckd2luZG93JywgJyRkb2N1bWVudCddO1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBBdHRyaWJ1dGVzQ29udHJvbGxlcigkc2NvcGUsICRzdGF0ZSwgc21vb3RoU2Nyb2xsLCAkZmlsdGVyLCAkd2luZG93LCAkZG9jdW1lbnQpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZtLnByb2R1Y3QgPSBudWxsO1xyXG4gICAgICAgIHZtLmF0dHJpYnV0ZXMgPSBbXTtcclxuICAgICAgICB2bS5nZXRGb3JtID0gZ2V0Rm9ybTtcclxuICAgICAgICB2bS5nZXRSZXN1bHRWaWV3ID0gZ2V0UmVzdWx0VmlldztcclxuICAgICAgICB2bS5jaG9pY2VWYWxpZGF0ZSA9IGNob2ljZVZhbGlkYXRlO1xyXG4gICAgICAgIHZtLnJlbmRlciA9IHJlbmRlcjtcclxuICAgICAgICB2bS5nb1RvTmV4dCA9IGdvVG9OZXh0O1xyXG5cclxuICAgICAgICAkd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgY2hlY2tQb3MpO1xyXG5cclxuICAgICAgICBhY3RpdmF0ZSgpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcclxuICAgICAgICAgIGlmICh0eXBlb2YgJHNjb3BlLmxhYlZtLmNob2ljZXMucHJvZHVjdCA9PT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2xhYi5wcm9kdWN0cycpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB2bS5wcm9kdWN0ID0gJHNjb3BlLmxhYlZtLmNob2ljZXMucHJvZHVjdDtcclxuICAgICAgICAgIHZtLmF0dHJpYnV0ZXMgPSAkZmlsdGVyKCdvcmRlckJ5Jykodm0ucHJvZHVjdC5hdHRyaWJ1dGVzLCAnb3JkZXInKTtcclxuICAgICAgICAgIHZtLmN1cnJlbnQgPSB2bS5hdHRyaWJ1dGVzWzBdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0Rm9ybShhdHRyaWJ1dGUpIHtcclxuICAgICAgICAgIHJldHVybiBcImFwcC9sYWIvYXR0cmlidXRlcy9mb3Jtcy9cIiArIGF0dHJpYnV0ZS5mb3JtICsgXCIvXCIgKyAgYXR0cmlidXRlLmZvcm0gKyBcIi52aWV3Lmh0bWxcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFJlc3VsdFZpZXcocHJvZHVjdCkge1xyXG4gICAgICAgICAgcmV0dXJuIFwiYXBwL2xhYi9hdHRyaWJ1dGVzL3Jlc3VsdHMvXCIgKyBwcm9kdWN0Lm5hbWUgKyBcIi9cIiArIHByb2R1Y3QubmFtZSArIFwiLnZpZXcuaHRtbFwiO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2hvaWNlVmFsaWRhdGUoYXR0cmlidXRlKSB7XHJcbiAgICAgICAgICByZXR1cm4gdHlwZW9mICRzY29wZS5sYWJWbS5jaG9pY2VzW2F0dHJpYnV0ZS5uYW1lXSAhPT0gXCJ1bmRlZmluZWRcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNoZWNrUG9zKGUpIHtcclxuICAgICAgICAgIHZhciBpID0gdm0uYXR0cmlidXRlcy5sZW5ndGg7XHJcbiAgICAgICAgICB2YXIgbm90Rm91bmQgPSB0cnVlO1xyXG4gICAgICAgICAgd2hpbGUgKGkgPiAwICYmIG5vdEZvdW5kKSB7XHJcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh2bS5hdHRyaWJ1dGVzW2ktMV0ubmFtZSkgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodm0uYXR0cmlidXRlc1tpLTFdLm5hbWUpLm9mZnNldFRvcCAtIDIwMCA8PSAkd2luZG93LnBhZ2VZT2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgdm0uY3VycmVudCA9IHZtLmF0dHJpYnV0ZXNbaS0xXTtcclxuICAgICAgICAgICAgICBub3RGb3VuZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpLS07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZW5kZXIoYXR0cmlidXRlKSB7XHJcbiAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgIT09IHZtLmN1cnJlbnQubmFtZSkge1xyXG4gICAgICAgICAgICBnb1RvKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgYXR0cmlidXRlLm5hbWUpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdvVG9OZXh0KGN1cnJlbnQpIHtcclxuICAgICAgICAgIHZhciBuZXh0RWxtbnQgPSBhbmd1bGFyLmVsZW1lbnQoY3VycmVudCkubmV4dCgpO1xyXG4gICAgICAgICAgZ29UbyhuZXh0RWxtbnRbMF0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ29UbyhlbG1udCkge1xyXG4gICAgICAgICAgc21vb3RoU2Nyb2xsKGVsbW50LCB7XHJcbiAgICAgICAgICAgICBvZmZzZXQ6IDE4MCxcclxuICAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwLFxyXG4gICAgICAgICAgICAgZWFzaW5nOiAnZWFzZU91dEN1YmljJ1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKFwiJGRlc3Ryb3lcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAkd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgY2hlY2tQb3MpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcclxuXHJcbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcclxuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsYWIuYXR0cmlidXRlcycsXHJcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXR0cmlidXRlcycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBhdHRyaWJ1dGVzJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQXR0cmlidXRlc0NvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2F0dHJpYnV0ZXNWbScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy52aWV3Lmh0bWwnXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgfVxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdQcm9kdWN0c0NvbnRyb2xsZXInLCBQcm9kdWN0c0NvbnRyb2xsZXIpO1xyXG5cclxuICAgIFByb2R1Y3RzQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHN0YXRlJywgJ2RhdGFzZXJ2aWNlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBQcm9kdWN0c0NvbnRyb2xsZXIoJHNjb3BlLCAkc3RhdGUsIGRhdGFzZXJ2aWNlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuXHJcbiAgICAgICAgdm0uc2VsZWN0ID0gc2VsZWN0O1xyXG5cclxuICAgICAgICBhY3RpdmF0ZSgpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcclxuICAgICAgICAgIGRhdGFzZXJ2aWNlLnJlYWR5KCkudGhlbihnZXRQcm9kdWN0cyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRQcm9kdWN0cygpIHtcclxuICAgICAgICAgIHZtLnByb2R1Y3RzID0gZGF0YXNlcnZpY2UuZ2V0UHJvZHVjdHMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdChwcm9kdWN0KSB7XHJcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlcy5wcm9kdWN0ID0gcHJvZHVjdDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnKVxyXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcclxuXHJcbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcclxuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsYWIucHJvZHVjdHMnLFxyXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3Byb2R1Y3RzJyxcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSAtIHByb2R1Y3RzJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnUHJvZHVjdHNDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdwcm9kdWN0c1ZtJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9sYWIvcHJvZHVjdHMvcHJvZHVjdHMudmlldy5odG1sJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuICAgIH1cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdCdG5SYWRpb0NvbnRyb2xsZXInLCBCdG5SYWRpb0NvbnRyb2xsZXIpO1xyXG5cclxuICAgIEJ0blJhZGlvQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJGZpbHRlciddO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gQnRuUmFkaW9Db250cm9sbGVyKCRzY29wZSwgJGZpbHRlcikge1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcclxuICAgICAgICB2bS5pbWdQcmV2aWV3ID0gbnVsbDtcclxuICAgICAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XHJcbiAgICAgICAgdm0uc2V0SW1nUHJldmlldyA9IHNldEltZ1ByZXZpZXc7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldENob2ljZShhdHRyaWJ1dGVDaG9pY2VkKSB7XHJcbiAgICAgICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gYXR0cmlidXRlQ2hvaWNlZDtcclxuICAgICAgICAgIHNldEltZ1ByZXZpZXcodm0uY2hvaWNlLmltZyk7XHJcblxyXG4gICAgICAgICAgJHNjb3BlLmF0dHJpYnV0ZXNWbS5nb1RvTmV4dChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHZtLmF0dHJpYnV0ZS5uYW1lKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRJbWdQcmV2aWV3KGltZykge1xyXG4gICAgICAgICAgaWYgKHZtLmF0dHJpYnV0ZS5oYXZlSW1nUHJldmlldykge1xyXG4gICAgICAgICAgICB2bS5pbWdQcmV2aWV3ID0gaW1nO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAuY29udHJvbGxlcignQ2hlY2tib3hDb250cm9sbGVyJywgQ2hlY2tib3hDb250cm9sbGVyKTtcclxuXHJcbiAgICBDaGVja2JveENvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBDaGVja2JveENvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5jaG9pY2VzID0gW107XHJcbiAgICAgICAgdm0uZXhpc3RzID0gZXhpc3RzO1xyXG4gICAgICAgIHZtLnRvZ2dsZSA9IHRvZ2dsZTtcclxuICAgICAgICB2bS5zYXZlQ2hvaWNlcyA9IHNhdmVDaG9pY2VzO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGlzdHModmFsdWUpIHtcclxuICAgICAgICAgIHJldHVybiB2bS5jaG9pY2VzLmluZGV4T2YodmFsdWUpID4gLTE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB0b2dnbGUodmFsdWUpIHtcclxuICAgICAgICAgIHZhciBpZHggPSB2bS5jaG9pY2VzLmluZGV4T2YodmFsdWUpO1xyXG4gICAgICAgICAgaWYgKGlkeCA+IC0xKSB7XHJcbiAgICAgICAgICAgIHZtLmNob2ljZXMuc3BsaWNlKGlkeCwgMSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2bS5jaG9pY2VzLnB1c2godmFsdWUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVDaG9pY2VzKCkge1xyXG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gdm0uY2hvaWNlcztcclxuICAgICAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0NvbG9yQ29udHJvbGxlcicsIENvbG9yQ29udHJvbGxlcik7XHJcblxyXG4gICAgQ29sb3JDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xyXG5cclxuICAgIC8qIEBuZ0luamVjdCAqL1xyXG4gICAgZnVuY3Rpb24gQ29sb3JDb250cm9sbGVyKCRzY29wZSkge1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5jaG9pY2UgPSBudWxsO1xyXG4gICAgICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcclxuICAgICAgICB2bS5zZXRPcGFjaXR5ID0gc2V0T3BhY2l0eTtcclxuICAgICAgICB2bS5zYXZlQ2hvaWNlID0gc2F2ZUNob2ljZTtcclxuICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xyXG5cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcclxuICAgICAgICAgIGlmICh2bS5jaG9pY2UpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Zvcm0tY29sb3ItJyArIHZtLmNob2ljZSkuc3R5bGUub3BhY2l0eSA9IDE7XHJcbiAgICAgICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2F2ZUNob2ljZSgpIHtcclxuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IHt2YWx1ZTogdm0uY2hvaWNlLCBwZXJjZW50OiB2bS5wZXJjZW50fTtcclxuICAgICAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0T3BhY2l0eSgpIHtcclxuICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb3JtLWNvbG9yLScgKyB2bS5jaG9pY2UpLnN0eWxlLm9wYWNpdHkgPSB2bS5wZXJjZW50IC8gMTAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICBhbmd1bGFyXHJcbiAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXHJcbiAgICAgIC5jb250cm9sbGVyKCdJbWdSYWRpb0NvbnRyb2xsZXInLCBJbWdSYWRpb0NvbnRyb2xsZXIpO1xyXG5cclxuICBJbWdSYWRpb0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIEltZ1JhZGlvQ29udHJvbGxlcigkc2NvcGUpIHtcclxuICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICB2bS5jaG9pY2UgPSBudWxsO1xyXG4gICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xyXG4gICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdJbnB1dFRleHRDb250cm9sbGVyJywgSW5wdXRUZXh0Q29udHJvbGxlcik7XHJcblxyXG4gICAgSW5wdXRUZXh0Q29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIElucHV0VGV4dENvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICB2bS5jaG9pY2UgPSBudWxsO1xyXG4gICAgICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKCkge1xyXG4gICAgICAgICAgaWYgKHZtLmNob2ljZSAhPT0gXCJcIiAmJiB2bS5jaG9pY2UgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gdm0uY2hvaWNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdSYWRpb1NsaWRlckNvbnRyb2xsZXInLCBSYWRpb1NsaWRlckNvbnRyb2xsZXIpO1xyXG5cclxuICAgIFJhZGlvU2xpZGVyQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcclxuXHJcbiAgICAvKiBAbmdJbmplY3QgKi9cclxuICAgIGZ1bmN0aW9uIFJhZGlvU2xpZGVyQ29udHJvbGxlcigkc2NvcGUpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XHJcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcclxuICAgICAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XHJcbiAgICAgICAgdm0uc2F2ZUNob2ljZSA9IHNhdmVDaG9pY2U7XHJcbiAgICAgICAgdm0ucGVyY2VudCA9IDEwMDtcclxuXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldENob2ljZShhdHRyaWJ1dGVDaG9pY2VkKSB7XHJcbiAgICAgICAgICBpZiAodm0uY2hvaWNlKSB7XHJcbiAgICAgICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2F2ZUNob2ljZSgpIHtcclxuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IHt2YWx1ZTogdm0uY2hvaWNlLCBwZXJjZW50OiB2bS5wZXJjZW50fTtcclxuICAgICAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbigpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcclxuICAgICAgICAuY29udHJvbGxlcignQ3JlYW1Db250cm9sbGVyJywgQ3JlYW1Db250cm9sbGVyKTtcclxuXHJcbiAgICBDcmVhbUNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBDcmVhbUNvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbn0pKCk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
