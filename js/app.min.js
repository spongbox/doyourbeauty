!function(){"use strict";angular.module("app",["app.core","app.lab","app.homepage","app.layout"])}(),function(){"use strict";angular.module("app.core",["ngAnimate","ngSanitize","blocks.exception","blocks.logger","blocks.router","ui.router","ngMaterial","duScroll"])}(),function(){"use strict";function t(t,e,r){t.debugEnabled&&t.debugEnabled(!0),r.configure(o.appErrorPrefix),e.configure({docTitle:o.appTitle+": "})}var e=angular.module("app.core"),o={appErrorPrefix:"[<%= appName %> Error] ",appTitle:"<%= appName %>"};e.value("config",o),e.config(t),t.$inject=["$logProvider","routerHelperProvider","exceptionHandlerProvider"]}(),function(){"use strict";function t(t){var o="/404";t.configureStates(e(),o)}function e(){return[{state:"404",config:{url:"/404",templateUrl:"app/core/404.html",title:"404"}}]}t.$inject=["routerHelper"],angular.module("app.core").run(t)}(),function(){"use strict";function t(t,e,o,r){function n(){return a.products}function c(){return i.then(function(t){return a=t.data,!0},function(){return r.error("Impossible de récupérer les données"),!1})}var u="/ressources/products.json",i=t.get(u),a=null,l={ready:c,getProducts:n};return l}angular.module("app.core").factory("dataservice",t),t.$inject=["$http","$q","exception","logger"]}(),function(){"use strict";function t(){return function(t,e){for(var o=0,r=t.length;r>o;o++)if(t[o].value==e||t[o].name==e)return t[o];return null}}angular.module("app.core").filter("getByName",t)}(),function(){"use strict";angular.module("blocks.exception",["blocks.logger"])}(),function(){"use strict";angular.module("blocks.logger",[])}(),function(){"use strict";angular.module("blocks.router",["ui.router","blocks.logger"])}(),function(){"use strict";function t(){this.config={appErrorPrefix:void 0},this.configure=function(t){this.config.appErrorPrefix=t},this.$get=function(){return{config:this.config}}}function e(t){t.decorator("$exceptionHandler",o)}function o(t,e,o){return function(r,n){var c=e.config.appErrorPrefix||"",u={exception:r,cause:n};r.message=c+r.message,t(r,n),o.error(r.message,u)}}angular.module("blocks.exception").provider("exceptionHandler",t).config(e),e.$inject=["$provide"],o.$inject=["$delegate","exceptionHandler","logger"]}(),function(){"use strict";function t(t,e){function o(o){return function(r){var n,c;return r.data&&r.data.description&&(n="\n"+r.data.description,c=o+n),r.data.description=c,e.error(c),t.reject(r)}}var r={catcher:o};return r}t.$inject=["$q","logger"],angular.module("blocks.exception").factory("exception",t)}(),function(){"use strict";function t(t,e){function o(e,o,r){console.error(e,r),t.error("Error: "+e,o)}function r(e,o,r){console.info(e,r),t.info("Info: "+e,o)}function n(e,o,r){console.log(e,r),t.info("Success: "+e,o)}function c(e,o,r){console.warn(e,r),t.warn("Warning: "+e,o)}var u={error:o,info:r,success:n,warning:c,log:t.log};return u}angular.module("blocks.logger").factory("logger",t),t.$inject=["$log"]}(),function(){"use strict";function t(t,e,o){function r(t,r,c,u){function i(t,r){t.forEach(function(t){t.config.resolve=angular.extend(t.config.resolve||{},n.resolveAlways),e.state(t.state,t.config)}),r&&!g&&(g=!0,o.otherwise(r))}function a(){r.$on("$stateChangeError",function(e,o,r,n,c,i){if(!f){m.errors++,f=!0;var a=o&&(o.title||o.name||o.loadedTemplateUrl)||"unknown target",l="Error routing to "+a+". "+(i.data||"")+". <br/>"+(i.statusText||"")+": "+(i.status||"");u.warning(l,[o]),t.path("/")}})}function l(){a(),p()}function s(){return c.get()}function p(){r.$on("$stateChangeSuccess",function(t,e,o,c,u){m.changes++,f=!1;var i=n.docTitle+" "+(e.title||"");r.title=i})}var f=!1,g=!1,m={errors:0,changes:0},d={configureStates:i,getStates:s,stateCounts:m};return l(),d}var n={docTitle:void 0,resolveAlways:{}};t.html5Mode({enabled:!1,requireBase:!1}),this.configure=function(t){angular.extend(n,t)},this.$get=r,r.$inject=["$location","$rootScope","$state","logger"]}angular.module("blocks.router").provider("routerHelper",t),t.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}(),function(){"use strict";angular.module("app.lab.attributes",["app.core"])}(),function(){angular.module("app.lab.products",["app.core"])}(),function(){"use strict";angular.module("app.homepage",["app.core"])}(),function(){angular.module("app.lab",["app.core","app.lab.products","app.lab.attributes"])}(),function(){"use strict";angular.module("app.layout",["app.core"])}(),function(){"use strict";function t(){var t=this;t.title="Homepage"}angular.module("app.homepage").controller("HomeController",t)}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"homepage",config:{url:"/",templateUrl:"app/homepage/homepage.view.html",controller:"HomeController",controllerAs:"home",title:"DoYourBeauty"}}]}angular.module("app.homepage").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){var e=this;e.choices={}}angular.module("app.lab").controller("LabController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab",config:{url:"/lab",templateUrl:"app/lab/lab.view.html",controller:"LabController",controllerAs:"labVm",title:"DoYourBeauty - Lab"}}]}angular.module("app.lab").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e,o,r,n,c){function u(){return"undefined"==typeof t.labVm.choices.product?void e.go("lab.products"):(r.smallHeader=!0,m.product=t.labVm.choices.product,m.attributes=o("orderBy")(m.product.attributes,"order"),void(m.current=m.attributes[0]))}function i(t){return"app/lab/attributes/forms/"+t.form+"/"+t.form+".view.html"}function a(t){return"app/lab/attributes/results/"+t.name+"/"+t.name+".view.html"}function l(e){return"undefined"!=typeof t.labVm.choices[e.name]}function s(e){for(var o=0,r=!0,n=m.attributes[0];o<m.attributes.length&&r;){var u=angular.element(document.getElementById(m.attributes[o].name)),i=u.prop("offsetTop")-m.offset-5,a=u.prop("offsetTop")+u[0].offsetHeight-m.offset-5;c.scrollTop()>=i&&(c.scrollTop()<=a?(m.current=m.attributes[o],r=!1):n=m.attributes[o+1]),o++}r&&(m.current=n),t.$apply()}function p(t){t.name!==m.current.name&&g(document.querySelector("#"+t.name))}function f(t){var e=angular.element(t).next();g(e[0])}function g(t){c.scrollToElement(t,m.offset,1e3)}var m=this;m.product=null,m.attributes=[],m.offset=218,m.getForm=i,m.getResultView=a,m.choiceValidate=l,m.render=p,m.goToNext=f,n.addEventListener("scroll",s),u(),t.$on("$destroy",function(){n.removeEventListener("scroll",s)})}angular.module("app.lab.attributes").controller("AttributesController",t),t.$inject=["$scope","$state","$filter","$rootScope","$window","$document"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab.attributes",config:{url:"/attributes",title:"DoYourBeauty - attributes",controller:"AttributesController",controllerAs:"attributesVm",templateUrl:"app/lab/attributes/attributes.view.html"}}]}angular.module("app.lab.attributes").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e,o){function r(){o.ready().then(n)}function n(){u.products=o.getProducts()}function c(e){t.labVm.choices.product=e}var u=this;u.select=c,r()}angular.module("app.lab.products").controller("ProductsController",t),t.$inject=["$scope","$state","dataservice"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"lab.products",config:{url:"/products",title:"DoYourBeauty - products",controller:"ProductsController",controllerAs:"productsVm",templateUrl:"app/lab/products/products.view.html"}}]}angular.module("app.lab.products").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e){function o(e){n.choice=e,t.labVm.choices[n.attribute.name]=e,r(n.choice.img),t.attributesVm.goToNext(document.querySelector("#"+n.attribute.name))}function r(t){n.attribute.haveImgPreview&&(n.imgPreview=t)}var n=this;n.choice=null,n.imgPreview=null,n.setChoice=o,n.setImgPreview=r}angular.module("app.lab.attributes").controller("BtnRadioController",t),t.$inject=["$scope","$filter"]}(),function(){"use strict";function t(t){function e(t){return n.choices.indexOf(t)>-1}function o(t){var e=n.choices.indexOf(t);e>-1?n.choices.splice(e,1):n.choices.push(t)}function r(){t.labVm.choices[n.attribute.name]=n.choices,t.attributesVm.goToNext(document.querySelector("#"+n.attribute.name))}var n=this;n.choices=[],n.exists=e,n.toggle=o,n.saveChoices=r}angular.module("app.lab.attributes").controller("CheckboxController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(t){n.choice&&(document.getElementById("form-color-"+n.choice).style.opacity=1,n.percent=100),n.choice=t}function o(){t.labVm.choices[n.attribute.name]={value:n.choice,percent:n.percent},t.attributesVm.goToNext(document.querySelector("#"+n.attribute.name))}function r(){document.getElementById("form-color-"+n.choice).style.opacity=n.percent/100}var n=this,n=this;n.choice=null,n.setChoice=e,n.setOpacity=r,n.saveChoice=o,n.percent=100}angular.module("app.lab.attributes").controller("ColorController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(e){o.choice=e,t.labVm.choices[o.attribute.name]=e,t.attributesVm.goToNext(document.querySelector("#"+o.attribute.name))}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("ImgRadioController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(){""!==o.choice&&null!==o.choice?(t.labVm.choices[o.attribute.name]=o.choice,t.attributesVm.goToNext(document.querySelector("#"+o.attribute.name))):delete t.labVm.choices[o.attribute.name]}var o=this;o.choice=null,o.setChoice=e}angular.module("app.lab.attributes").controller("InputTextController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){function e(t){r.choice&&(r.percent=100),r.choice=t}function o(){t.labVm.choices[r.attribute.name]={value:r.choice,percent:r.percent},t.attributesVm.goToNext(document.querySelector("#"+r.attribute.name))}var r=this,r=this;r.choice=null,r.setChoice=e,r.saveChoice=o,r.percent=100}angular.module("app.lab.attributes").controller("RadioSliderController",t),t.$inject=["$scope"]}(),function(){"use strict";function t(t){}angular.module("app.lab.attributes").controller("CreamController",t),t.$inject=["$scope"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjb3JlLm1vZHVsZS5qcyIsImNvbmZpZy5qcyIsImNvcmUucm91dGUuanMiLCJhcHAubWluLmpzIiwiZGF0YXNlcnZpY2UuanMiLCJnZXRieW5hbWUuZmlsdGVyLmpzIiwiZXhjZXB0aW9uL2V4Y2VwdGlvbi5tb2R1bGUuanMiLCJsb2dnZXIvbG9nZ2VyLm1vZHVsZS5qcyIsInJvdXRlci9yb3V0ZXIubW9kdWxlLmpzIiwiZXhjZXB0aW9uL2V4Y2VwdGlvbi1oYW5kbGVyLnByb3ZpZGVyLmpzIiwiZXhjZXB0aW9uL2V4Y2VwdGlvbi5qcyIsImxvZ2dlci9sb2dnZXIuanMiLCJyb3V0ZXIvcm91dGVyLWhlbHBlci5wcm92aWRlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2F0dHJpYnV0ZXMubW9kdWxlLmpzIiwibGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLm1vZHVsZS5qcyIsImhvbWVwYWdlL2hvbWVwYWdlLm1vZHVsZS5qcyIsImxhYi9sYWIubW9kdWxlLmpzIiwibGF5b3V0L2xheW91dC5tb2R1bGUuanMiLCJob21lcGFnZS9ob21lcGFnZS5jb250cm9sbGVyLmpzIiwiaG9tZXBhZ2UvaG9tZXBhZ2Uucm91dGUuanMiLCJsYWIvbGFiLmNvbnRyb2xsZXIuanMiLCJsYWIvbGFiLnJvdXRlLmpzIiwibGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy5jb250cm9sbGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvYXR0cmlidXRlcy5yb3V0ZS5qcyIsImxhYi9wcm9kdWN0cy9wcm9kdWN0cy5jb250cm9sbGVyLmpzIiwibGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLnJvdXRlLmpzIiwibGFiL2F0dHJpYnV0ZXMvZm9ybXMvYnRuLXJhZGlvL2J0bi1yYWRpby5jb250cm9sbGVyLmpzIiwibGFiL2F0dHJpYnV0ZXMvZm9ybXMvY2hlY2tib3gvY2hlY2tib3guY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2Zvcm1zL2NvbG9yL2NvbG9yLmNvbnRyb2xsZXIuanMiLCJsYWIvYXR0cmlidXRlcy9mb3Jtcy9pbWctcmFkaW8vaW1nLXJhZGlvLmNvbnRyb2xsZXIuanMiLCJsYWIvYXR0cmlidXRlcy9mb3Jtcy9pbnB1dC10ZXh0L2lucHV0LXRleHQuY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL2Zvcm1zL3JhZGlvLXNsaWRlci9yYWRpby1zbGlkZXIuY29udHJvbGxlci5qcyIsImxhYi9hdHRyaWJ1dGVzL3Jlc3VsdHMvY3JlYW0vY3JlYW0uY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlndXJlIiwiJGxvZ1Byb3ZpZGVyIiwicm91dGVySGVscGVyUHJvdmlkZXIiLCJleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIiLCJkZWJ1Z0VuYWJsZWQiLCJjb25maWciLCJhcHBFcnJvclByZWZpeCIsImRvY1RpdGxlIiwiYXBwVGl0bGUiLCJjb3JlIiwidmFsdWUiLCIkaW5qZWN0IiwiYXBwUnVuIiwicm91dGVySGVscGVyIiwib3RoZXJ3aXNlIiwiY29uZmlndXJlU3RhdGVzIiwiZ2V0U3RhdGVzIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsInRpdGxlIiwicnVuIiwiZGF0YXNlcnZpY2UiLCIkaHR0cCIsIiRxIiwiZXhjZXB0aW9uIiwibG9nZ2VyIiwiZ2V0UHJvZHVjdHMiLCJkYXRhIiwicHJvZHVjdHMiLCJyZWFkeSIsInByb21pc2UiLCJ0aGVuIiwicmVzdWx0IiwiZXJyb3IiLCJqc29uVVJMIiwiZ2V0Iiwic2VydmljZSIsImZhY3RvcnkiLCJnZXRCeU5hbWUiLCJpbnB1dCIsIm5hbWUiLCJpIiwibGVuZ3RoIiwiZmlsdGVyIiwidGhpcyIsInVuZGVmaW5lZCIsIiRnZXQiLCIkcHJvdmlkZSIsImRlY29yYXRvciIsImV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIiLCIkZGVsZWdhdGUiLCJleGNlcHRpb25IYW5kbGVyIiwiY2F1c2UiLCJlcnJvckRhdGEiLCJtZXNzYWdlIiwicHJvdmlkZXIiLCJjYXRjaGVyIiwiZSIsInRocm93bkRlc2NyaXB0aW9uIiwibmV3TWVzc2FnZSIsImRlc2NyaXB0aW9uIiwicmVqZWN0IiwiJGxvZyIsInRvYXN0ciIsImNvbnNvbGUiLCJpbmZvIiwic3VjY2VzcyIsImxvZyIsIndhcm5pbmciLCJ3YXJuIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIlJvdXRlckhlbHBlciIsIiRsb2NhdGlvbiIsIiRyb290U2NvcGUiLCIkc3RhdGUiLCJzdGF0ZXMiLCJvdGhlcndpc2VQYXRoIiwiZm9yRWFjaCIsInJlc29sdmUiLCJleHRlbmQiLCJyZXNvbHZlQWx3YXlzIiwiaGFzT3RoZXJ3aXNlIiwiaGFuZGxlUm91dGluZ0Vycm9ycyIsIiRvbiIsImV2ZW50IiwidG9TdGF0ZSIsInRvUGFyYW1zIiwiZnJvbVN0YXRlIiwiZnJvbVBhcmFtcyIsImhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciIsInN0YXRlQ291bnRzIiwiZXJyb3JzIiwiZGVzdGluYXRpb24iLCJsb2FkZWRUZW1wbGF0ZVVybCIsIm1zZyIsInN0YXR1c1RleHQiLCJzdGF0dXMiLCJwYXRoIiwiaW5pdCIsInVwZGF0ZURvY1RpdGxlIiwiY2hhbmdlcyIsImh0bWw1TW9kZSIsImVuYWJsZWQiLCJyZXF1aXJlQmFzZSIsImNmZyIsIkhvbWVDb250cm9sbGVyIiwidm0iLCJjb250cm9sbGVyIiwiY29udHJvbGxlckFzIiwiTGFiQ29udHJvbGxlciIsIiRzY29wZSIsImNob2ljZXMiLCJBdHRyaWJ1dGVzQ29udHJvbGxlciIsIiRmaWx0ZXIiLCIkd2luZG93IiwiJGRvY3VtZW50IiwiYWN0aXZhdGUiLCJsYWJWbSIsInByb2R1Y3QiLCJnbyIsInNtYWxsSGVhZGVyIiwiYXR0cmlidXRlcyIsImN1cnJlbnQiLCJnZXRGb3JtIiwiYXR0cmlidXRlIiwiZm9ybSIsImdldFJlc3VsdFZpZXciLCJjaG9pY2VWYWxpZGF0ZSIsImNoZWNrUG9zIiwibm90Rm91bmQiLCJsYXN0QXR0cmlidXRlIiwiZWxlbW50IiwiZWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJwb3NTdGFydCIsInByb3AiLCJvZmZzZXQiLCJwb3NFbmQiLCJvZmZzZXRIZWlnaHQiLCJzY3JvbGxUb3AiLCIkYXBwbHkiLCJyZW5kZXIiLCJnb1RvIiwicXVlcnlTZWxlY3RvciIsImdvVG9OZXh0IiwibmV4dEVsbW50IiwibmV4dCIsImVsbW50Iiwic2Nyb2xsVG9FbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJQcm9kdWN0c0NvbnRyb2xsZXIiLCJzZWxlY3QiLCJCdG5SYWRpb0NvbnRyb2xsZXIiLCJzZXRDaG9pY2UiLCJhdHRyaWJ1dGVDaG9pY2VkIiwiY2hvaWNlIiwic2V0SW1nUHJldmlldyIsImltZyIsImF0dHJpYnV0ZXNWbSIsImhhdmVJbWdQcmV2aWV3IiwiaW1nUHJldmlldyIsIkNoZWNrYm94Q29udHJvbGxlciIsImV4aXN0cyIsImluZGV4T2YiLCJ0b2dnbGUiLCJpZHgiLCJzcGxpY2UiLCJwdXNoIiwic2F2ZUNob2ljZXMiLCJDb2xvckNvbnRyb2xsZXIiLCJzdHlsZSIsIm9wYWNpdHkiLCJwZXJjZW50Iiwic2F2ZUNob2ljZSIsInNldE9wYWNpdHkiLCJJbWdSYWRpb0NvbnRyb2xsZXIiLCJJbnB1dFRleHRDb250cm9sbGVyIiwiUmFkaW9TbGlkZXJDb250cm9sbGVyIiwiQ3JlYW1Db250cm9sbGVyIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUNBLFlBRUFBLFNBQUFDLE9BQUEsT0FDQSxXQUNBLFVBQ0EsZUFDQSxrQkNQQSxXQUNBLFlBRUFELFNBQ0FDLE9BQUEsWUFDQSxZQUFBLGFBQ0EsbUJBQUEsZ0JBQUEsZ0JBQ0EsWUFBQSxhQUFBLGdCQ1BBLFdBQ0EsWUFjQSxTQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxHQUNBRixFQUFBRyxjQUNBSCxFQUFBRyxjQUFBLEdBRUFELEVBQUFILFVBQUFLLEVBQUFDLGdCQUNBSixFQUFBRixXQUFBTyxT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OiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAgICAgICAnYXBwLmNvcmUnLFxuICAgICAgICAnYXBwLmxhYicsXG4gICAgICAgICdhcHAuaG9tZXBhZ2UnLFxuICAgICAgICAnYXBwLmxheW91dCdcbiAgICBdKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuY29yZScsIFtcbiAgICAgICAgICAgICduZ0FuaW1hdGUnLCAnbmdTYW5pdGl6ZScsXG4gICAgICAgICAgICAnYmxvY2tzLmV4Y2VwdGlvbicsICdibG9ja3MubG9nZ2VyJywgJ2Jsb2Nrcy5yb3V0ZXInLFxuICAgICAgICAgICAgJ3VpLnJvdXRlcicsICduZ01hdGVyaWFsJywgJ2R1U2Nyb2xsJ1xuICAgICAgICBdKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBjb3JlID0gYW5ndWxhci5tb2R1bGUoJ2FwcC5jb3JlJyk7XG4gICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgYXBwRXJyb3JQcmVmaXg6ICdbPCU9IGFwcE5hbWUgJT4gRXJyb3JdICcsXG4gICAgICAgIGFwcFRpdGxlOiAnPCU9IGFwcE5hbWUgJT4nXG4gICAgfTtcblxuICAgIGNvcmUudmFsdWUoJ2NvbmZpZycsIGNvbmZpZyk7XG5cbiAgICBjb3JlLmNvbmZpZyhjb25maWd1cmUpO1xuXG4gICAgY29uZmlndXJlLiRpbmplY3QgPSBbJyRsb2dQcm92aWRlcicsICdyb3V0ZXJIZWxwZXJQcm92aWRlcicsICdleGNlcHRpb25IYW5kbGVyUHJvdmlkZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBjb25maWd1cmUoJGxvZ1Byb3ZpZGVyLCByb3V0ZXJIZWxwZXJQcm92aWRlciwgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKSB7XG4gICAgICAgIGlmICgkbG9nUHJvdmlkZXIuZGVidWdFbmFibGVkKSB7XG4gICAgICAgICAgICAkbG9nUHJvdmlkZXIuZGVidWdFbmFibGVkKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlci5jb25maWd1cmUoY29uZmlnLmFwcEVycm9yUHJlZml4KTtcbiAgICAgICAgcm91dGVySGVscGVyUHJvdmlkZXIuY29uZmlndXJlKHtkb2NUaXRsZTogY29uZmlnLmFwcFRpdGxlICsgJzogJ30pO1xuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xuICAgICAgICB2YXIgb3RoZXJ3aXNlID0gJy80MDQnO1xuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpLCBvdGhlcndpc2UpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJzQwNCcsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy80MDQnLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9jb3JlLzQwNC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICc0MDQnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICAgICAgICdhcHAuY29yZScsXG4gICAgICAgICdhcHAubGFiJyxcbiAgICAgICAgJ2FwcC5ob21lcGFnZScsXG4gICAgICAgICdhcHAubGF5b3V0J1xuICAgIF0pO1xuXG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvcmUnLCBbXG4gICAgICAgICAgICAnbmdBbmltYXRlJywgJ25nU2FuaXRpemUnLFxuICAgICAgICAgICAgJ2Jsb2Nrcy5leGNlcHRpb24nLCAnYmxvY2tzLmxvZ2dlcicsICdibG9ja3Mucm91dGVyJyxcbiAgICAgICAgICAgICd1aS5yb3V0ZXInLCAnbmdNYXRlcmlhbCcsICdkdVNjcm9sbCdcbiAgICAgICAgXSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBjb3JlID0gYW5ndWxhci5tb2R1bGUoJ2FwcC5jb3JlJyk7XG4gICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgYXBwRXJyb3JQcmVmaXg6ICdbPCU9IGFwcE5hbWUgJT4gRXJyb3JdICcsXG4gICAgICAgIGFwcFRpdGxlOiAnPCU9IGFwcE5hbWUgJT4nXG4gICAgfTtcblxuICAgIGNvcmUudmFsdWUoJ2NvbmZpZycsIGNvbmZpZyk7XG5cbiAgICBjb3JlLmNvbmZpZyhjb25maWd1cmUpO1xuXG4gICAgY29uZmlndXJlLiRpbmplY3QgPSBbJyRsb2dQcm92aWRlcicsICdyb3V0ZXJIZWxwZXJQcm92aWRlcicsICdleGNlcHRpb25IYW5kbGVyUHJvdmlkZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBjb25maWd1cmUoJGxvZ1Byb3ZpZGVyLCByb3V0ZXJIZWxwZXJQcm92aWRlciwgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKSB7XG4gICAgICAgIGlmICgkbG9nUHJvdmlkZXIuZGVidWdFbmFibGVkKSB7XG4gICAgICAgICAgICAkbG9nUHJvdmlkZXIuZGVidWdFbmFibGVkKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlci5jb25maWd1cmUoY29uZmlnLmFwcEVycm9yUHJlZml4KTtcbiAgICAgICAgcm91dGVySGVscGVyUHJvdmlkZXIuY29uZmlndXJlKHtkb2NUaXRsZTogY29uZmlnLmFwcFRpdGxlICsgJzogJ30pO1xuICAgIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gW1wicm91dGVySGVscGVyXCJdO1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvcmUnKVxuICAgICAgICAucnVuKGFwcFJ1bik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XG4gICAgICAgIHZhciBvdGhlcndpc2UgPSAnLzQwNCc7XG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCksIG90aGVyd2lzZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnNDA0JyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnLzQwNCcsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2NvcmUvNDA0Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJzQwNCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5jb3JlJylcbiAgICAgICAgLmZhY3RvcnkoJ2RhdGFzZXJ2aWNlJywgZGF0YXNlcnZpY2UpO1xuXG4gICAgZGF0YXNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCAnJHEnLCAnZXhjZXB0aW9uJywgJ2xvZ2dlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGRhdGFzZXJ2aWNlKCRodHRwLCAkcSwgZXhjZXB0aW9uLCBsb2dnZXIpIHtcbiAgICAgICAgdmFyIGpzb25VUkwgPSAnL3Jlc3NvdXJjZXMvcHJvZHVjdHMuanNvbic7XG4gICAgICAgIHZhciBwcm9taXNlID0gJGh0dHAuZ2V0KGpzb25VUkwpO1xuICAgICAgICB2YXIgZGF0YSA9IG51bGw7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgIHJlYWR5OiByZWFkeSxcbiAgICAgICAgICBnZXRQcm9kdWN0czogZ2V0UHJvZHVjdHNcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICBmdW5jdGlvbiBnZXRQcm9kdWN0cygpIHtcbiAgICAgICAgICByZXR1cm4gZGF0YS5wcm9kdWN0cztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlYWR5KCkge1xuICAgICAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICBkYXRhID0gcmVzdWx0LmRhdGE7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcignSW1wb3NzaWJsZSBkZSByw6ljdXDDqXJlciBsZXMgZG9ubsOpZXMnKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmNvcmUnKVxuICAgIC5maWx0ZXIoJ2dldEJ5TmFtZScsIGdldEJ5TmFtZSk7XG5cbiAgZnVuY3Rpb24gZ2V0QnlOYW1lKCkge1xuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgbmFtZSkge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGlucHV0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpbnB1dFtpXS52YWx1ZSA9PSBuYW1lIHx8IGlucHV0W2ldLm5hbWUgPT0gbmFtZSkge1xuICAgICAgICAgIHJldHVybiBpbnB1dFtpXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nLCBbJ2Jsb2Nrcy5sb2dnZXInXSk7XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInLCBbXSk7XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Jsb2Nrcy5yb3V0ZXInLCBbXG4gICAgICAgICd1aS5yb3V0ZXInLFxuICAgICAgICAnYmxvY2tzLmxvZ2dlcidcbiAgICBdKTtcbn0pKCk7XG5cbi8vIEluY2x1ZGUgaW4gaW5kZXguaHRtbCBzbyB0aGF0IGFwcCBsZXZlbCBleGNlcHRpb25zIGFyZSBoYW5kbGVkLlxuLy8gRXhjbHVkZSBmcm9tIHRlc3RSdW5uZXIuaHRtbCB3aGljaCBzaG91bGQgcnVuIGV4YWN0bHkgd2hhdCBpdCB3YW50cyB0byBydW5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nKVxuICAgICAgICAucHJvdmlkZXIoJ2V4Y2VwdGlvbkhhbmRsZXInLCBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIpXG4gICAgICAgIC5jb25maWcoY29uZmlnKTtcblxuICAgIC8qKlxuICAgICAqIE11c3QgY29uZmlndXJlIHRoZSBleGNlcHRpb24gaGFuZGxpbmdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleGNlcHRpb25IYW5kbGVyUHJvdmlkZXIoKSB7XG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICAgICAgICB0aGlzLmNvbmZpZyA9IHtcbiAgICAgICAgICAgIGFwcEVycm9yUHJlZml4OiB1bmRlZmluZWRcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uIChhcHBFcnJvclByZWZpeCkge1xuICAgICAgICAgICAgdGhpcy5jb25maWcuYXBwRXJyb3JQcmVmaXggPSBhcHBFcnJvclByZWZpeDtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLiRnZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB7Y29uZmlnOiB0aGlzLmNvbmZpZ307XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgY29uZmlnLiRpbmplY3QgPSBbJyRwcm92aWRlJ107XG5cbiAgICAvKipcbiAgICAgKiBDb25maWd1cmUgYnkgc2V0dGluZyBhbiBvcHRpb25hbCBzdHJpbmcgdmFsdWUgZm9yIGFwcEVycm9yUHJlZml4LlxuICAgICAqIEFjY2Vzc2libGUgdmlhIGNvbmZpZy5hcHBFcnJvclByZWZpeCAodmlhIGNvbmZpZyB2YWx1ZSkuXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSAkcHJvdmlkZVxuICAgICAqL1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpZygkcHJvdmlkZSkge1xuICAgICAgICAkcHJvdmlkZS5kZWNvcmF0b3IoJyRleGNlcHRpb25IYW5kbGVyJywgZXh0ZW5kRXhjZXB0aW9uSGFuZGxlcik7XG4gICAgfVxuXG4gICAgZXh0ZW5kRXhjZXB0aW9uSGFuZGxlci4kaW5qZWN0ID0gWyckZGVsZWdhdGUnLCAnZXhjZXB0aW9uSGFuZGxlcicsICdsb2dnZXInXTtcblxuICAgIC8qKlxuICAgICAqIEV4dGVuZCB0aGUgJGV4Y2VwdGlvbkhhbmRsZXIgc2VydmljZSB0byBhbHNvIGRpc3BsYXkgYSB0b2FzdC5cbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9ICRkZWxlZ2F0ZVxuICAgICAqIEBwYXJhbSAge09iamVjdH0gZXhjZXB0aW9uSGFuZGxlclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gbG9nZ2VyXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IHRoZSBkZWNvcmF0ZWQgJGV4Y2VwdGlvbkhhbmRsZXIgc2VydmljZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIoJGRlbGVnYXRlLCBleGNlcHRpb25IYW5kbGVyLCBsb2dnZXIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGV4Y2VwdGlvbiwgY2F1c2UpIHtcbiAgICAgICAgICAgIHZhciBhcHBFcnJvclByZWZpeCA9IGV4Y2VwdGlvbkhhbmRsZXIuY29uZmlnLmFwcEVycm9yUHJlZml4IHx8ICcnO1xuICAgICAgICAgICAgdmFyIGVycm9yRGF0YSA9IHtleGNlcHRpb246IGV4Y2VwdGlvbiwgY2F1c2U6IGNhdXNlfTtcbiAgICAgICAgICAgIGV4Y2VwdGlvbi5tZXNzYWdlID0gYXBwRXJyb3JQcmVmaXggKyBleGNlcHRpb24ubWVzc2FnZTtcbiAgICAgICAgICAgICRkZWxlZ2F0ZShleGNlcHRpb24sIGNhdXNlKTtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ291bGQgYWRkIHRoZSBlcnJvciB0byBhIHNlcnZpY2UncyBjb2xsZWN0aW9uLFxuICAgICAgICAgICAgICogYWRkIGVycm9ycyB0byAkcm9vdFNjb3BlLCBsb2cgZXJyb3JzIHRvIHJlbW90ZSB3ZWIgc2VydmVyLFxuICAgICAgICAgICAgICogb3IgbG9nIGxvY2FsbHkuIE9yIHRocm93IGhhcmQuIEl0IGlzIGVudGlyZWx5IHVwIHRvIHlvdS5cbiAgICAgICAgICAgICAqIHRocm93IGV4Y2VwdGlvbjtcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgICAgICogICAgIHRocm93IHsgbWVzc2FnZTogJ2Vycm9yIG1lc3NhZ2Ugd2UgYWRkZWQnIH07XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihleGNlcHRpb24ubWVzc2FnZSwgZXJyb3JEYXRhKTtcbiAgICAgICAgfTtcbiAgICB9XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZXhjZXB0aW9uLiRpbmplY3QgPSBbXCIkcVwiLCBcImxvZ2dlclwiXTtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nKVxuICAgICAgICAuZmFjdG9yeSgnZXhjZXB0aW9uJywgZXhjZXB0aW9uKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGV4Y2VwdGlvbigkcSwgbG9nZ2VyKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgY2F0Y2hlcjogY2F0Y2hlclxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICBmdW5jdGlvbiBjYXRjaGVyKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRocm93bkRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgIHZhciBuZXdNZXNzYWdlO1xuICAgICAgICAgICAgICAgIGlmIChlLmRhdGEgJiYgZS5kYXRhLmRlc2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93bkRlc2NyaXB0aW9uID0gJ1xcbicgKyBlLmRhdGEuZGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgICAgIG5ld01lc3NhZ2UgPSBtZXNzYWdlICsgdGhyb3duRGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGUuZGF0YS5kZXNjcmlwdGlvbiA9IG5ld01lc3NhZ2U7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5ld01lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QoZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmxvZ2dlcicpXG4gICAgICAgIC5mYWN0b3J5KCdsb2dnZXInLCBsb2dnZXIpO1xuXG4gICAgbG9nZ2VyLiRpbmplY3QgPSBbJyRsb2cnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGxvZ2dlcigkbG9nLCB0b2FzdHIpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBlcnJvciAgIDogZXJyb3IsXG4gICAgICAgICAgICBpbmZvICAgIDogaW5mbyxcbiAgICAgICAgICAgIHN1Y2Nlc3MgOiBzdWNjZXNzLFxuICAgICAgICAgICAgd2FybmluZyA6IHdhcm5pbmcsXG5cbiAgICAgICAgICAgIC8vIHN0cmFpZ2h0IHRvIGNvbnNvbGU7IGJ5cGFzcyB0b2FzdHJcbiAgICAgICAgICAgIGxvZyAgICAgOiAkbG9nLmxvZ1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLmVycm9yKCdFcnJvcjogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaW5mbyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgY29uc29sZS5pbmZvKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuaW5mbygnSW5mbzogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5pbmZvKCdTdWNjZXNzOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB3YXJuaW5nKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4obWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy53YXJuKCdXYXJuaW5nOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cbiAgICB9XG59KCkpO1xuXG4vKiBIZWxwIGNvbmZpZ3VyZSB0aGUgc3RhdGUtYmFzZSB1aS5yb3V0ZXIgKi9cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5yb3V0ZXInKVxuICAgICAgICAucHJvdmlkZXIoJ3JvdXRlckhlbHBlcicsIHJvdXRlckhlbHBlclByb3ZpZGVyKTtcblxuICAgIHJvdXRlckhlbHBlclByb3ZpZGVyLiRpbmplY3QgPSBbJyRsb2NhdGlvblByb3ZpZGVyJywgJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIHJvdXRlckhlbHBlclByb3ZpZGVyKCRsb2NhdGlvblByb3ZpZGVyLCAkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgZG9jVGl0bGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHJlc29sdmVBbHdheXM6IHt9XG4gICAgICAgIH07XG5cbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHtcbiAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgICAgICByZXF1aXJlQmFzZTogZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jb25maWd1cmUgPSBmdW5jdGlvbihjZmcpIHtcbiAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGNvbmZpZywgY2ZnKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLiRnZXQgPSBSb3V0ZXJIZWxwZXI7XG4gICAgICAgIFJvdXRlckhlbHBlci4kaW5qZWN0ID0gWyckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsICckc3RhdGUnLCAnbG9nZ2VyJ107XG4gICAgICAgIC8qIEBuZ0luamVjdCAqL1xuICAgICAgICBmdW5jdGlvbiBSb3V0ZXJIZWxwZXIoJGxvY2F0aW9uLCAkcm9vdFNjb3BlLCAkc3RhdGUsIGxvZ2dlcikge1xuICAgICAgICAgICAgdmFyIGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGhhc090aGVyd2lzZSA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIHN0YXRlQ291bnRzID0ge1xuICAgICAgICAgICAgICAgIGVycm9yczogMCxcbiAgICAgICAgICAgICAgICBjaGFuZ2VzOiAwXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgICAgICBjb25maWd1cmVTdGF0ZXM6IGNvbmZpZ3VyZVN0YXRlcyxcbiAgICAgICAgICAgICAgICBnZXRTdGF0ZXM6IGdldFN0YXRlcyxcbiAgICAgICAgICAgICAgICBzdGF0ZUNvdW50czogc3RhdGVDb3VudHNcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGluaXQoKTtcblxuICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBjb25maWd1cmVTdGF0ZXMoc3RhdGVzLCBvdGhlcndpc2VQYXRoKSB7XG4gICAgICAgICAgICAgICAgc3RhdGVzLmZvckVhY2goZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUuY29uZmlnLnJlc29sdmUgPVxuICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoc3RhdGUuY29uZmlnLnJlc29sdmUgfHwge30sIGNvbmZpZy5yZXNvbHZlQWx3YXlzKTtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoc3RhdGUuc3RhdGUsIHN0YXRlLmNvbmZpZyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKG90aGVyd2lzZVBhdGggJiYgIWhhc090aGVyd2lzZSkge1xuICAgICAgICAgICAgICAgICAgICBoYXNPdGhlcndpc2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKG90aGVyd2lzZVBhdGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlUm91dGluZ0Vycm9ycygpIHtcbiAgICAgICAgICAgICAgICAvLyBSb3V0ZSBjYW5jZWxsYXRpb246XG4gICAgICAgICAgICAgICAgLy8gT24gcm91dGluZyBlcnJvciwgZ28gdG8gdGhlIGRhc2hib2FyZC5cbiAgICAgICAgICAgICAgICAvLyBQcm92aWRlIGFuIGV4aXQgY2xhdXNlIGlmIGl0IHRyaWVzIHRvIGRvIGl0IHR3aWNlLlxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRzLmVycm9ycysrO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZXN0aW5hdGlvbiA9ICh0b1N0YXRlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRvU3RhdGUudGl0bGUgfHwgdG9TdGF0ZS5uYW1lIHx8IHRvU3RhdGUubG9hZGVkVGVtcGxhdGVVcmwpKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd1bmtub3duIHRhcmdldCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbXNnID0gJ0Vycm9yIHJvdXRpbmcgdG8gJyArIGRlc3RpbmF0aW9uICsgJy4gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGVycm9yLmRhdGEgfHwgJycpICsgJy4gPGJyLz4nICsgKGVycm9yLnN0YXR1c1RleHQgfHwgJycpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnOiAnICsgKGVycm9yLnN0YXR1cyB8fCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyhtc2csIFt0b1N0YXRlXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVSb3V0aW5nRXJyb3JzKCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlRG9jVGl0bGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkgeyByZXR1cm4gJHN0YXRlLmdldCgpOyB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHVwZGF0ZURvY1RpdGxlKCkge1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRzLmNoYW5nZXMrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsaW5nU3RhdGVDaGFuZ2VFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gY29uZmlnLmRvY1RpdGxlICsgJyAnICsgKHRvU3RhdGUudGl0bGUgfHwgJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50aXRsZSA9IHRpdGxlOyAvLyBkYXRhIGJpbmQgdG8gPHRpdGxlPlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnLCBbJ2FwcC5jb3JlJ10pO1xuXG59KSAoKTtcblxuKGZ1bmN0aW9uICgpIHtcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxhYi5wcm9kdWN0cycsIFsnYXBwLmNvcmUnXSk7XG5cbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuaG9tZXBhZ2UnLCBbXG4gICAgJ2FwcC5jb3JlJ1xuICBdKTtcblxufSkgKCk7XG5cbihmdW5jdGlvbiAoKSB7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYWInLCBbXG4gICAgJ2FwcC5jb3JlJyxcbiAgICAnYXBwLmxhYi5wcm9kdWN0cycsXG4gICAgJ2FwcC5sYWIuYXR0cmlidXRlcydcbiAgXSk7XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmxheW91dCcsIFtcbiAgICAgICdhcHAuY29yZSdcbiAgICBdKTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmhvbWVwYWdlJykuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBIb21lQ29udHJvbGxlcik7XG5cbiAgZnVuY3Rpb24gSG9tZUNvbnRyb2xsZXIoKcKge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0udGl0bGUgPSAnSG9tZXBhZ2UnO1xuICB9XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuaG9tZXBhZ2UnKVxuICAgICAgICAucnVuKGFwcFJ1bik7XG5cbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdob21lcGFnZScsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy8nLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9ob21lcGFnZS9ob21lcGFnZS52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdob21lJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHknXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWInKVxuICAgICAgICAuY29udHJvbGxlcignTGFiQ29udHJvbGxlcicsIExhYkNvbnRyb2xsZXIpO1xuXG4gICAgTGFiQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIExhYkNvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNob2ljZXMgPSB7fTtcbiAgICB9XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWInKVxuICAgICAgICAucnVuKGFwcFJ1bik7XG5cbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdsYWInLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvbGFiJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL2xhYi52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTGFiQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2xhYlZtJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBMYWInXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdBdHRyaWJ1dGVzQ29udHJvbGxlcicsIEF0dHJpYnV0ZXNDb250cm9sbGVyKTtcblxuICAgIEF0dHJpYnV0ZXNDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICckc3RhdGUnLCAnJGZpbHRlcicsICckcm9vdFNjb3BlJywnJHdpbmRvdycsICckZG9jdW1lbnQnXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBBdHRyaWJ1dGVzQ29udHJvbGxlcigkc2NvcGUsICRzdGF0ZSwgJGZpbHRlciwgJHJvb3RTY29wZSwgJHdpbmRvdywgJGRvY3VtZW50KSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLnByb2R1Y3QgPSBudWxsO1xuICAgICAgICB2bS5hdHRyaWJ1dGVzID0gW107XG4gICAgICAgIHZtLm9mZnNldCA9IDIxODtcbiAgICAgICAgdm0uZ2V0Rm9ybSA9IGdldEZvcm07XG4gICAgICAgIHZtLmdldFJlc3VsdFZpZXcgPSBnZXRSZXN1bHRWaWV3O1xuICAgICAgICB2bS5jaG9pY2VWYWxpZGF0ZSA9IGNob2ljZVZhbGlkYXRlO1xuICAgICAgICB2bS5yZW5kZXIgPSByZW5kZXI7XG4gICAgICAgIHZtLmdvVG9OZXh0ID0gZ29Ub05leHQ7XG5cblxuICAgICAgICAkd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgY2hlY2tQb3MpO1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiAkc2NvcGUubGFiVm0uY2hvaWNlcy5wcm9kdWN0ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2xhYi5wcm9kdWN0cycpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICAkcm9vdFNjb3BlLnNtYWxsSGVhZGVyID0gdHJ1ZTtcbiAgICAgICAgICB2bS5wcm9kdWN0ID0gJHNjb3BlLmxhYlZtLmNob2ljZXMucHJvZHVjdDtcbiAgICAgICAgICB2bS5hdHRyaWJ1dGVzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLnByb2R1Y3QuYXR0cmlidXRlcywgJ29yZGVyJyk7XG4gICAgICAgICAgdm0uY3VycmVudCA9IHZtLmF0dHJpYnV0ZXNbMF07XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRGb3JtKGF0dHJpYnV0ZSkge1xuICAgICAgICAgIHJldHVybiBcImFwcC9sYWIvYXR0cmlidXRlcy9mb3Jtcy9cIiArIGF0dHJpYnV0ZS5mb3JtICsgXCIvXCIgKyAgYXR0cmlidXRlLmZvcm0gKyBcIi52aWV3Lmh0bWxcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFJlc3VsdFZpZXcocHJvZHVjdCkge1xuICAgICAgICAgIHJldHVybiBcImFwcC9sYWIvYXR0cmlidXRlcy9yZXN1bHRzL1wiICsgcHJvZHVjdC5uYW1lICsgXCIvXCIgKyBwcm9kdWN0Lm5hbWUgKyBcIi52aWV3Lmh0bWxcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNob2ljZVZhbGlkYXRlKGF0dHJpYnV0ZSkge1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgJHNjb3BlLmxhYlZtLmNob2ljZXNbYXR0cmlidXRlLm5hbWVdICE9PSBcInVuZGVmaW5lZFwiO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2hlY2tQb3MoZSkge1xuICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICB2YXIgbm90Rm91bmQgPSB0cnVlO1xuICAgICAgICAgIHZhciBsYXN0QXR0cmlidXRlID0gIHZtLmF0dHJpYnV0ZXNbMF07XG4gICAgICAgICAgd2hpbGUgKGkgPCB2bS5hdHRyaWJ1dGVzLmxlbmd0aCAmJiBub3RGb3VuZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1udCA9IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh2bS5hdHRyaWJ1dGVzW2ldLm5hbWUpKTtcbiAgICAgICAgICAgIHZhciBwb3NTdGFydCA9IGVsZW1udC5wcm9wKCdvZmZzZXRUb3AnKSAtIHZtLm9mZnNldCAtIDU7XG4gICAgICAgICAgICB2YXIgcG9zRW5kID0gZWxlbW50LnByb3AoJ29mZnNldFRvcCcpICsgZWxlbW50WzBdLm9mZnNldEhlaWdodCAtIHZtLm9mZnNldCAtIDU7XG4gICAgICAgICAgICBpZiAoJGRvY3VtZW50LnNjcm9sbFRvcCgpID49IHBvc1N0YXJ0KSB7XG4gICAgICAgICAgICAgIGlmICgkZG9jdW1lbnQuc2Nyb2xsVG9wKCkgPD0gcG9zRW5kKSB7XG4gICAgICAgICAgICAgICAgdm0uY3VycmVudCA9IHZtLmF0dHJpYnV0ZXNbaV07XG4gICAgICAgICAgICAgICAgbm90Rm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsYXN0QXR0cmlidXRlID0gdm0uYXR0cmlidXRlc1tpICsgMV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG5vdEZvdW5kKSB7XG4gICAgICAgICAgICAgIHZtLmN1cnJlbnQgPSBsYXN0QXR0cmlidXRlO1xuICAgICAgICAgIH1cbiAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlbmRlcihhdHRyaWJ1dGUpIHtcbiAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgIT09IHZtLmN1cnJlbnQubmFtZSkge1xuICAgICAgICAgICAgZ29Ubyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIGF0dHJpYnV0ZS5uYW1lKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ29Ub05leHQoY3VycmVudCkge1xuICAgICAgICAgIHZhciBuZXh0RWxtbnQgPSBhbmd1bGFyLmVsZW1lbnQoY3VycmVudCkubmV4dCgpO1xuICAgICAgICAgIGdvVG8obmV4dEVsbW50WzBdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdvVG8oZWxtbnQpIHtcbiAgICAgICAgICAkZG9jdW1lbnQuc2Nyb2xsVG9FbGVtZW50KGVsbW50LCB2bS5vZmZzZXQsIDEwMDApO1xuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLiRvbihcIiRkZXN0cm95XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBjaGVja1Bvcyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGFiLmF0dHJpYnV0ZXMnLFxuICAgICAgICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXR0cmlidXRlcycsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRG9Zb3VyQmVhdXR5IC0gYXR0cmlidXRlcycsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBdHRyaWJ1dGVzQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2F0dHJpYnV0ZXNWbScsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2xhYi9hdHRyaWJ1dGVzL2F0dHJpYnV0ZXMudmlldy5odG1sJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLnByb2R1Y3RzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1Byb2R1Y3RzQ29udHJvbGxlcicsIFByb2R1Y3RzQ29udHJvbGxlcik7XG5cbiAgICBQcm9kdWN0c0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJywgJyRzdGF0ZScsICdkYXRhc2VydmljZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gUHJvZHVjdHNDb250cm9sbGVyKCRzY29wZSwgJHN0YXRlLCBkYXRhc2VydmljZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIHZtLnNlbGVjdCA9IHNlbGVjdDtcblxuICAgICAgICBhY3RpdmF0ZSgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICAgIGRhdGFzZXJ2aWNlLnJlYWR5KCkudGhlbihnZXRQcm9kdWN0cyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRQcm9kdWN0cygpIHtcbiAgICAgICAgICB2bS5wcm9kdWN0cyA9IGRhdGFzZXJ2aWNlLmdldFByb2R1Y3RzKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZWxlY3QocHJvZHVjdCkge1xuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzLnByb2R1Y3QgPSBwcm9kdWN0O1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLnByb2R1Y3RzJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGFiLnByb2R1Y3RzJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3Byb2R1Y3RzJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBwcm9kdWN0cycsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9kdWN0c0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdwcm9kdWN0c1ZtJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLnZpZXcuaHRtbCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0J0blJhZGlvQ29udHJvbGxlcicsIEJ0blJhZGlvQ29udHJvbGxlcik7XG5cbiAgICBCdG5SYWRpb0NvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJywgJyRmaWx0ZXInXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEJ0blJhZGlvQ29udHJvbGxlcigkc2NvcGUsICRmaWx0ZXIpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcbiAgICAgICAgdm0uaW1nUHJldmlldyA9IG51bGw7XG4gICAgICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcbiAgICAgICAgdm0uc2V0SW1nUHJldmlldyA9IHNldEltZ1ByZXZpZXc7XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcbiAgICAgICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IGF0dHJpYnV0ZUNob2ljZWQ7XG4gICAgICAgICAgc2V0SW1nUHJldmlldyh2bS5jaG9pY2UuaW1nKTtcblxuICAgICAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0SW1nUHJldmlldyhpbWcpIHtcbiAgICAgICAgICBpZiAodm0uYXR0cmlidXRlLmhhdmVJbWdQcmV2aWV3KSB7XG4gICAgICAgICAgICB2bS5pbWdQcmV2aWV3ID0gaW1nO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0NoZWNrYm94Q29udHJvbGxlcicsIENoZWNrYm94Q29udHJvbGxlcik7XG5cbiAgICBDaGVja2JveENvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBDaGVja2JveENvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNob2ljZXMgPSBbXTtcbiAgICAgICAgdm0uZXhpc3RzID0gZXhpc3RzO1xuICAgICAgICB2bS50b2dnbGUgPSB0b2dnbGU7XG4gICAgICAgIHZtLnNhdmVDaG9pY2VzID0gc2F2ZUNob2ljZXM7XG5cbiAgICAgICAgZnVuY3Rpb24gZXhpc3RzKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHZtLmNob2ljZXMuaW5kZXhPZih2YWx1ZSkgPiAtMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHRvZ2dsZSh2YWx1ZSkge1xuICAgICAgICAgIHZhciBpZHggPSB2bS5jaG9pY2VzLmluZGV4T2YodmFsdWUpO1xuICAgICAgICAgIGlmIChpZHggPiAtMSkge1xuICAgICAgICAgICAgdm0uY2hvaWNlcy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdm0uY2hvaWNlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZUNob2ljZXMoKSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gdm0uY2hvaWNlcztcbiAgICAgICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAuY29udHJvbGxlcignQ29sb3JDb250cm9sbGVyJywgQ29sb3JDb250cm9sbGVyKTtcblxuICAgIENvbG9yQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIENvbG9yQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xuICAgICAgICB2bS5zZXRPcGFjaXR5ID0gc2V0T3BhY2l0eTtcbiAgICAgICAgdm0uc2F2ZUNob2ljZSA9IHNhdmVDaG9pY2U7XG4gICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XG5cblxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xuICAgICAgICAgIGlmICh2bS5jaG9pY2UpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb3JtLWNvbG9yLScgKyB2bS5jaG9pY2UpLnN0eWxlLm9wYWNpdHkgPSAxO1xuICAgICAgICAgICAgdm0ucGVyY2VudCA9IDEwMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgdm0uY2hvaWNlID0gYXR0cmlidXRlQ2hvaWNlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVDaG9pY2UoKSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0ge3ZhbHVlOiB2bS5jaG9pY2UsIHBlcmNlbnQ6IHZtLnBlcmNlbnR9O1xuICAgICAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0T3BhY2l0eSgpIHtcbiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9ybS1jb2xvci0nICsgdm0uY2hvaWNlKS5zdHlsZS5vcGFjaXR5ID0gdm0ucGVyY2VudCAvIDEwMDtcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgLmNvbnRyb2xsZXIoJ0ltZ1JhZGlvQ29udHJvbGxlcicsIEltZ1JhZGlvQ29udHJvbGxlcik7XG5cbiAgSW1nUmFkaW9Db250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gIC8qIEBuZ0luamVjdCAqL1xuICBmdW5jdGlvbiBJbWdSYWRpb0NvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5jaG9pY2UgPSBudWxsO1xuICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcblxuXG4gICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcbiAgICAgIHZtLmNob2ljZSA9IGF0dHJpYnV0ZUNob2ljZWQ7XG4gICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgICAgJHNjb3BlLmF0dHJpYnV0ZXNWbS5nb1RvTmV4dChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHZtLmF0dHJpYnV0ZS5uYW1lKSk7XG4gICAgfVxuXG4gIH1cblxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0lucHV0VGV4dENvbnRyb2xsZXInLCBJbnB1dFRleHRDb250cm9sbGVyKTtcblxuICAgIElucHV0VGV4dENvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBJbnB1dFRleHRDb250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5jaG9pY2UgPSBudWxsO1xuICAgICAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKCkge1xuICAgICAgICAgIGlmICh2bS5jaG9pY2UgIT09IFwiXCIgJiYgdm0uY2hvaWNlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB2bS5jaG9pY2U7XG4gICAgICAgICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGVsZXRlICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdSYWRpb1NsaWRlckNvbnRyb2xsZXInLCBSYWRpb1NsaWRlckNvbnRyb2xsZXIpO1xuXG4gICAgUmFkaW9TbGlkZXJDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gUmFkaW9TbGlkZXJDb250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5jaG9pY2UgPSBudWxsO1xuICAgICAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XG4gICAgICAgIHZtLnNhdmVDaG9pY2UgPSBzYXZlQ2hvaWNlO1xuICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xuXG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcbiAgICAgICAgICBpZiAodm0uY2hvaWNlKSB7XG4gICAgICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZUNob2ljZSgpIHtcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB7dmFsdWU6IHZtLmNob2ljZSwgcGVyY2VudDogdm0ucGVyY2VudH07XG4gICAgICAgICAgJHNjb3BlLmF0dHJpYnV0ZXNWbS5nb1RvTmV4dChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHZtLmF0dHJpYnV0ZS5uYW1lKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdDcmVhbUNvbnRyb2xsZXInLCBDcmVhbUNvbnRyb2xsZXIpO1xuXG4gICAgQ3JlYW1Db250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gQ3JlYW1Db250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICBcbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmNvcmUnKVxuICAgICAgICAuZmFjdG9yeSgnZGF0YXNlcnZpY2UnLCBkYXRhc2VydmljZSk7XG5cbiAgICBkYXRhc2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsICckcScsICdleGNlcHRpb24nLCAnbG9nZ2VyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gZGF0YXNlcnZpY2UoJGh0dHAsICRxLCBleGNlcHRpb24sIGxvZ2dlcikge1xuICAgICAgICB2YXIganNvblVSTCA9ICcvcmVzc291cmNlcy9wcm9kdWN0cy5qc29uJztcbiAgICAgICAgdmFyIHByb21pc2UgPSAkaHR0cC5nZXQoanNvblVSTCk7XG4gICAgICAgIHZhciBkYXRhID0gbnVsbDtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgcmVhZHk6IHJlYWR5LFxuICAgICAgICAgIGdldFByb2R1Y3RzOiBnZXRQcm9kdWN0c1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2R1Y3RzKCkge1xuICAgICAgICAgIHJldHVybiBkYXRhLnByb2R1Y3RzO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVhZHkoKSB7XG4gICAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgIGRhdGEgPSByZXN1bHQuZGF0YTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCdJbXBvc3NpYmxlIGRlIHLDqWN1cMOpcmVyIGxlcyBkb25uw6llcycpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmNvcmUnKVxuICAgIC5maWx0ZXIoJ2dldEJ5TmFtZScsIGdldEJ5TmFtZSk7XG5cbiAgZnVuY3Rpb24gZ2V0QnlOYW1lKCkge1xuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgbmFtZSkge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGlucHV0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpbnB1dFtpXS52YWx1ZSA9PSBuYW1lIHx8IGlucHV0W2ldLm5hbWUgPT0gbmFtZSkge1xuICAgICAgICAgIHJldHVybiBpbnB1dFtpXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJywgWydibG9ja3MubG9nZ2VyJ10pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYmxvY2tzLmxvZ2dlcicsIFtdKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Jsb2Nrcy5yb3V0ZXInLCBbXG4gICAgICAgICd1aS5yb3V0ZXInLFxuICAgICAgICAnYmxvY2tzLmxvZ2dlcidcbiAgICBdKTtcbn0pKCk7XG4iLCIvLyBJbmNsdWRlIGluIGluZGV4Lmh0bWwgc28gdGhhdCBhcHAgbGV2ZWwgZXhjZXB0aW9ucyBhcmUgaGFuZGxlZC5cbi8vIEV4Y2x1ZGUgZnJvbSB0ZXN0UnVubmVyLmh0bWwgd2hpY2ggc2hvdWxkIHJ1biBleGFjdGx5IHdoYXQgaXQgd2FudHMgdG8gcnVuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJylcbiAgICAgICAgLnByb3ZpZGVyKCdleGNlcHRpb25IYW5kbGVyJywgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKVxuICAgICAgICAuY29uZmlnKGNvbmZpZyk7XG5cbiAgICAvKipcbiAgICAgKiBNdXN0IGNvbmZpZ3VyZSB0aGUgZXhjZXB0aW9uIGhhbmRsaW5nXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKCkge1xuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgICAgICAgdGhpcy5jb25maWcgPSB7XG4gICAgICAgICAgICBhcHBFcnJvclByZWZpeDogdW5kZWZpbmVkXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5jb25maWd1cmUgPSBmdW5jdGlvbiAoYXBwRXJyb3JQcmVmaXgpIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmFwcEVycm9yUHJlZml4ID0gYXBwRXJyb3JQcmVmaXg7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4ge2NvbmZpZzogdGhpcy5jb25maWd9O1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNvbmZpZy4kaW5qZWN0ID0gWyckcHJvdmlkZSddO1xuXG4gICAgLyoqXG4gICAgICogQ29uZmlndXJlIGJ5IHNldHRpbmcgYW4gb3B0aW9uYWwgc3RyaW5nIHZhbHVlIGZvciBhcHBFcnJvclByZWZpeC5cbiAgICAgKiBBY2Nlc3NpYmxlIHZpYSBjb25maWcuYXBwRXJyb3JQcmVmaXggKHZpYSBjb25maWcgdmFsdWUpLlxuICAgICAqIEBwYXJhbSAge09iamVjdH0gJHByb3ZpZGVcbiAgICAgKi9cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBjb25maWcoJHByb3ZpZGUpIHtcbiAgICAgICAgJHByb3ZpZGUuZGVjb3JhdG9yKCckZXhjZXB0aW9uSGFuZGxlcicsIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIpO1xuICAgIH1cblxuICAgIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIuJGluamVjdCA9IFsnJGRlbGVnYXRlJywgJ2V4Y2VwdGlvbkhhbmRsZXInLCAnbG9nZ2VyJ107XG5cbiAgICAvKipcbiAgICAgKiBFeHRlbmQgdGhlICRleGNlcHRpb25IYW5kbGVyIHNlcnZpY2UgdG8gYWxzbyBkaXNwbGF5IGEgdG9hc3QuXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSAkZGVsZWdhdGVcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGV4Y2VwdGlvbkhhbmRsZXJcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IGxvZ2dlclxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSB0aGUgZGVjb3JhdGVkICRleGNlcHRpb25IYW5kbGVyIHNlcnZpY2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBleHRlbmRFeGNlcHRpb25IYW5kbGVyKCRkZWxlZ2F0ZSwgZXhjZXB0aW9uSGFuZGxlciwgbG9nZ2VyKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihleGNlcHRpb24sIGNhdXNlKSB7XG4gICAgICAgICAgICB2YXIgYXBwRXJyb3JQcmVmaXggPSBleGNlcHRpb25IYW5kbGVyLmNvbmZpZy5hcHBFcnJvclByZWZpeCB8fCAnJztcbiAgICAgICAgICAgIHZhciBlcnJvckRhdGEgPSB7ZXhjZXB0aW9uOiBleGNlcHRpb24sIGNhdXNlOiBjYXVzZX07XG4gICAgICAgICAgICBleGNlcHRpb24ubWVzc2FnZSA9IGFwcEVycm9yUHJlZml4ICsgZXhjZXB0aW9uLm1lc3NhZ2U7XG4gICAgICAgICAgICAkZGVsZWdhdGUoZXhjZXB0aW9uLCBjYXVzZSk7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIENvdWxkIGFkZCB0aGUgZXJyb3IgdG8gYSBzZXJ2aWNlJ3MgY29sbGVjdGlvbixcbiAgICAgICAgICAgICAqIGFkZCBlcnJvcnMgdG8gJHJvb3RTY29wZSwgbG9nIGVycm9ycyB0byByZW1vdGUgd2ViIHNlcnZlcixcbiAgICAgICAgICAgICAqIG9yIGxvZyBsb2NhbGx5LiBPciB0aHJvdyBoYXJkLiBJdCBpcyBlbnRpcmVseSB1cCB0byB5b3UuXG4gICAgICAgICAgICAgKiB0aHJvdyBleGNlcHRpb247XG4gICAgICAgICAgICAgKlxuICAgICAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICAgICAqICAgICB0aHJvdyB7IG1lc3NhZ2U6ICdlcnJvciBtZXNzYWdlIHdlIGFkZGVkJyB9O1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXhjZXB0aW9uLm1lc3NhZ2UsIGVycm9yRGF0YSk7XG4gICAgICAgIH07XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nKVxuICAgICAgICAuZmFjdG9yeSgnZXhjZXB0aW9uJywgZXhjZXB0aW9uKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGV4Y2VwdGlvbigkcSwgbG9nZ2VyKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgY2F0Y2hlcjogY2F0Y2hlclxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICBmdW5jdGlvbiBjYXRjaGVyKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRocm93bkRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgIHZhciBuZXdNZXNzYWdlO1xuICAgICAgICAgICAgICAgIGlmIChlLmRhdGEgJiYgZS5kYXRhLmRlc2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93bkRlc2NyaXB0aW9uID0gJ1xcbicgKyBlLmRhdGEuZGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgICAgIG5ld01lc3NhZ2UgPSBtZXNzYWdlICsgdGhyb3duRGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGUuZGF0YS5kZXNjcmlwdGlvbiA9IG5ld01lc3NhZ2U7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKG5ld01lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QoZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInKVxuICAgICAgICAuZmFjdG9yeSgnbG9nZ2VyJywgbG9nZ2VyKTtcblxuICAgIGxvZ2dlci4kaW5qZWN0ID0gWyckbG9nJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBsb2dnZXIoJGxvZywgdG9hc3RyKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgZXJyb3IgICA6IGVycm9yLFxuICAgICAgICAgICAgaW5mbyAgICA6IGluZm8sXG4gICAgICAgICAgICBzdWNjZXNzIDogc3VjY2VzcyxcbiAgICAgICAgICAgIHdhcm5pbmcgOiB3YXJuaW5nLFxuXG4gICAgICAgICAgICAvLyBzdHJhaWdodCB0byBjb25zb2xlOyBieXBhc3MgdG9hc3RyXG4gICAgICAgICAgICBsb2cgICAgIDogJGxvZy5sb2dcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gZXJyb3IobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5lcnJvcignRXJyb3I6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluZm8obWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLmluZm8oJ0luZm86ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuaW5mbygnU3VjY2VzczogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gd2FybmluZyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cud2FybignV2FybmluZzogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxufSgpKTtcbiIsIi8qIEhlbHAgY29uZmlndXJlIHRoZSBzdGF0ZS1iYXNlIHVpLnJvdXRlciAqL1xuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLnJvdXRlcicpXG4gICAgICAgIC5wcm92aWRlcigncm91dGVySGVscGVyJywgcm91dGVySGVscGVyUHJvdmlkZXIpO1xuXG4gICAgcm91dGVySGVscGVyUHJvdmlkZXIuJGluamVjdCA9IFsnJGxvY2F0aW9uUHJvdmlkZXInLCAnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gcm91dGVySGVscGVyUHJvdmlkZXIoJGxvY2F0aW9uUHJvdmlkZXIsICRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICBkb2NUaXRsZTogdW5kZWZpbmVkLFxuICAgICAgICAgICAgcmVzb2x2ZUFsd2F5czoge31cbiAgICAgICAgfTtcblxuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUoe1xuICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgIHJlcXVpcmVCYXNlOiBmYWxzZVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSA9IGZ1bmN0aW9uKGNmZykge1xuICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoY29uZmlnLCBjZmcpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuJGdldCA9IFJvdXRlckhlbHBlcjtcbiAgICAgICAgUm91dGVySGVscGVyLiRpbmplY3QgPSBbJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgJyRzdGF0ZScsICdsb2dnZXInXTtcbiAgICAgICAgLyogQG5nSW5qZWN0ICovXG4gICAgICAgIGZ1bmN0aW9uIFJvdXRlckhlbHBlcigkbG9jYXRpb24sICRyb290U2NvcGUsICRzdGF0ZSwgbG9nZ2VyKSB7XG4gICAgICAgICAgICB2YXIgaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgaGFzT3RoZXJ3aXNlID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgc3RhdGVDb3VudHMgPSB7XG4gICAgICAgICAgICAgICAgZXJyb3JzOiAwLFxuICAgICAgICAgICAgICAgIGNoYW5nZXM6IDBcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgICAgIGNvbmZpZ3VyZVN0YXRlczogY29uZmlndXJlU3RhdGVzLFxuICAgICAgICAgICAgICAgIGdldFN0YXRlczogZ2V0U3RhdGVzLFxuICAgICAgICAgICAgICAgIHN0YXRlQ291bnRzOiBzdGF0ZUNvdW50c1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZVN0YXRlcyhzdGF0ZXMsIG90aGVyd2lzZVBhdGgpIHtcbiAgICAgICAgICAgICAgICBzdGF0ZXMuZm9yRWFjaChmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5jb25maWcucmVzb2x2ZSA9XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChzdGF0ZS5jb25maWcucmVzb2x2ZSB8fCB7fSwgY29uZmlnLnJlc29sdmVBbHdheXMpO1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZShzdGF0ZS5zdGF0ZSwgc3RhdGUuY29uZmlnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAob3RoZXJ3aXNlUGF0aCAmJiAhaGFzT3RoZXJ3aXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhc090aGVyd2lzZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2Uob3RoZXJ3aXNlUGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVSb3V0aW5nRXJyb3JzKCkge1xuICAgICAgICAgICAgICAgIC8vIFJvdXRlIGNhbmNlbGxhdGlvbjpcbiAgICAgICAgICAgICAgICAvLyBPbiByb3V0aW5nIGVycm9yLCBnbyB0byB0aGUgZGFzaGJvYXJkLlxuICAgICAgICAgICAgICAgIC8vIFByb3ZpZGUgYW4gZXhpdCBjbGF1c2UgaWYgaXQgdHJpZXMgdG8gZG8gaXQgdHdpY2UuXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZUVycm9yJyxcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMsIGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudHMuZXJyb3JzKys7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGluZ1N0YXRlQ2hhbmdlRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlc3RpbmF0aW9uID0gKHRvU3RhdGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodG9TdGF0ZS50aXRsZSB8fCB0b1N0YXRlLm5hbWUgfHwgdG9TdGF0ZS5sb2FkZWRUZW1wbGF0ZVVybCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Vua25vd24gdGFyZ2V0JztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtc2cgPSAnRXJyb3Igcm91dGluZyB0byAnICsgZGVzdGluYXRpb24gKyAnLiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZXJyb3IuZGF0YSB8fCAnJykgKyAnLiA8YnIvPicgKyAoZXJyb3Iuc3RhdHVzVGV4dCB8fCAnJykgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6ICcgKyAoZXJyb3Iuc3RhdHVzIHx8ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKG1zZywgW3RvU3RhdGVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgICAgIGhhbmRsZVJvdXRpbmdFcnJvcnMoKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVEb2NUaXRsZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7IHJldHVybiAkc3RhdGUuZ2V0KCk7IH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlRG9jVGl0bGUoKSB7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudHMuY2hhbmdlcysrO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxpbmdTdGF0ZUNoYW5nZUVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBjb25maWcuZG9jVGl0bGUgKyAnICcgKyAodG9TdGF0ZS50aXRsZSB8fCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnRpdGxlID0gdGl0bGU7IC8vIGRhdGEgYmluZCB0byA8dGl0bGU+XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnLCBbJ2FwcC5jb3JlJ10pO1xuXG59KSAoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnLCBbJ2FwcC5jb3JlJ10pO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5ob21lcGFnZScsIFtcbiAgICAnYXBwLmNvcmUnXG4gIF0pO1xuXG59KSAoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYWInLCBbXG4gICAgJ2FwcC5jb3JlJyxcbiAgICAnYXBwLmxhYi5wcm9kdWN0cycsXG4gICAgJ2FwcC5sYWIuYXR0cmlidXRlcydcbiAgXSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5sYXlvdXQnLCBbXG4gICAgICAnYXBwLmNvcmUnXG4gICAgXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuaG9tZXBhZ2UnKS5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIEhvbWVDb250cm9sbGVyKTtcblxuICBmdW5jdGlvbiBIb21lQ29udHJvbGxlcigpwqB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS50aXRsZSA9ICdIb21lcGFnZSc7XG4gIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuaG9tZXBhZ2UnKVxuICAgICAgICAucnVuKGFwcFJ1bik7XG5cbiAgICBhcHBSdW4uJGluamVjdCA9IFsncm91dGVySGVscGVyJ107XG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gYXBwUnVuKHJvdXRlckhlbHBlcikge1xuICAgICAgICByb3V0ZXJIZWxwZXIuY29uZmlndXJlU3RhdGVzKGdldFN0YXRlcygpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdob21lcGFnZScsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy8nLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9ob21lcGFnZS9ob21lcGFnZS52aWV3Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdob21lJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHknXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0xhYkNvbnRyb2xsZXInLCBMYWJDb250cm9sbGVyKTtcblxuICAgIExhYkNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBMYWJDb250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5jaG9pY2VzID0ge307XG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmxhYicpXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcblxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xhYicsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9sYWInLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9sYWIvbGFiLnZpZXcuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMYWJDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnbGFiVm0nLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSAtIExhYidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdBdHRyaWJ1dGVzQ29udHJvbGxlcicsIEF0dHJpYnV0ZXNDb250cm9sbGVyKTtcblxuICAgIEF0dHJpYnV0ZXNDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICckc3RhdGUnLCAnJGZpbHRlcicsICckcm9vdFNjb3BlJywnJHdpbmRvdycsICckZG9jdW1lbnQnXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBBdHRyaWJ1dGVzQ29udHJvbGxlcigkc2NvcGUsICRzdGF0ZSwgJGZpbHRlciwgJHJvb3RTY29wZSwgJHdpbmRvdywgJGRvY3VtZW50KSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLnByb2R1Y3QgPSBudWxsO1xuICAgICAgICB2bS5hdHRyaWJ1dGVzID0gW107XG4gICAgICAgIHZtLm9mZnNldCA9IDIxODtcbiAgICAgICAgdm0uZ2V0Rm9ybSA9IGdldEZvcm07XG4gICAgICAgIHZtLmdldFJlc3VsdFZpZXcgPSBnZXRSZXN1bHRWaWV3O1xuICAgICAgICB2bS5jaG9pY2VWYWxpZGF0ZSA9IGNob2ljZVZhbGlkYXRlO1xuICAgICAgICB2bS5yZW5kZXIgPSByZW5kZXI7XG4gICAgICAgIHZtLmdvVG9OZXh0ID0gZ29Ub05leHQ7XG5cblxuICAgICAgICAkd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgY2hlY2tQb3MpO1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiAkc2NvcGUubGFiVm0uY2hvaWNlcy5wcm9kdWN0ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2xhYi5wcm9kdWN0cycpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICAkcm9vdFNjb3BlLnNtYWxsSGVhZGVyID0gdHJ1ZTtcbiAgICAgICAgICB2bS5wcm9kdWN0ID0gJHNjb3BlLmxhYlZtLmNob2ljZXMucHJvZHVjdDtcbiAgICAgICAgICB2bS5hdHRyaWJ1dGVzID0gJGZpbHRlcignb3JkZXJCeScpKHZtLnByb2R1Y3QuYXR0cmlidXRlcywgJ29yZGVyJyk7XG4gICAgICAgICAgdm0uY3VycmVudCA9IHZtLmF0dHJpYnV0ZXNbMF07XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRGb3JtKGF0dHJpYnV0ZSkge1xuICAgICAgICAgIHJldHVybiBcImFwcC9sYWIvYXR0cmlidXRlcy9mb3Jtcy9cIiArIGF0dHJpYnV0ZS5mb3JtICsgXCIvXCIgKyAgYXR0cmlidXRlLmZvcm0gKyBcIi52aWV3Lmh0bWxcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFJlc3VsdFZpZXcocHJvZHVjdCkge1xuICAgICAgICAgIHJldHVybiBcImFwcC9sYWIvYXR0cmlidXRlcy9yZXN1bHRzL1wiICsgcHJvZHVjdC5uYW1lICsgXCIvXCIgKyBwcm9kdWN0Lm5hbWUgKyBcIi52aWV3Lmh0bWxcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNob2ljZVZhbGlkYXRlKGF0dHJpYnV0ZSkge1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgJHNjb3BlLmxhYlZtLmNob2ljZXNbYXR0cmlidXRlLm5hbWVdICE9PSBcInVuZGVmaW5lZFwiO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2hlY2tQb3MoZSkge1xuICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICB2YXIgbm90Rm91bmQgPSB0cnVlO1xuICAgICAgICAgIHZhciBsYXN0QXR0cmlidXRlID0gIHZtLmF0dHJpYnV0ZXNbMF07XG4gICAgICAgICAgd2hpbGUgKGkgPCB2bS5hdHRyaWJ1dGVzLmxlbmd0aCAmJiBub3RGb3VuZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1udCA9IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh2bS5hdHRyaWJ1dGVzW2ldLm5hbWUpKTtcbiAgICAgICAgICAgIHZhciBwb3NTdGFydCA9IGVsZW1udC5wcm9wKCdvZmZzZXRUb3AnKSAtIHZtLm9mZnNldCAtIDU7XG4gICAgICAgICAgICB2YXIgcG9zRW5kID0gZWxlbW50LnByb3AoJ29mZnNldFRvcCcpICsgZWxlbW50WzBdLm9mZnNldEhlaWdodCAtIHZtLm9mZnNldCAtIDU7XG4gICAgICAgICAgICBpZiAoJGRvY3VtZW50LnNjcm9sbFRvcCgpID49IHBvc1N0YXJ0KSB7XG4gICAgICAgICAgICAgIGlmICgkZG9jdW1lbnQuc2Nyb2xsVG9wKCkgPD0gcG9zRW5kKSB7XG4gICAgICAgICAgICAgICAgdm0uY3VycmVudCA9IHZtLmF0dHJpYnV0ZXNbaV07XG4gICAgICAgICAgICAgICAgbm90Rm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsYXN0QXR0cmlidXRlID0gdm0uYXR0cmlidXRlc1tpICsgMV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG5vdEZvdW5kKSB7XG4gICAgICAgICAgICAgIHZtLmN1cnJlbnQgPSBsYXN0QXR0cmlidXRlO1xuICAgICAgICAgIH1cbiAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlbmRlcihhdHRyaWJ1dGUpIHtcbiAgICAgICAgICBpZiAoYXR0cmlidXRlLm5hbWUgIT09IHZtLmN1cnJlbnQubmFtZSkge1xuICAgICAgICAgICAgZ29Ubyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIGF0dHJpYnV0ZS5uYW1lKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ29Ub05leHQoY3VycmVudCkge1xuICAgICAgICAgIHZhciBuZXh0RWxtbnQgPSBhbmd1bGFyLmVsZW1lbnQoY3VycmVudCkubmV4dCgpO1xuICAgICAgICAgIGdvVG8obmV4dEVsbW50WzBdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdvVG8oZWxtbnQpIHtcbiAgICAgICAgICAkZG9jdW1lbnQuc2Nyb2xsVG9FbGVtZW50KGVsbW50LCB2bS5vZmZzZXQsIDEwMDApO1xuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLiRvbihcIiRkZXN0cm95XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBjaGVja1Bvcyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5ydW4oYXBwUnVuKTtcblxuICAgIGFwcFJ1bi4kaW5qZWN0ID0gWydyb3V0ZXJIZWxwZXInXTtcbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBhcHBSdW4ocm91dGVySGVscGVyKSB7XG4gICAgICAgIHJvdXRlckhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2xhYi5hdHRyaWJ1dGVzJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2F0dHJpYnV0ZXMnLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0RvWW91ckJlYXV0eSAtIGF0dHJpYnV0ZXMnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQXR0cmlidXRlc0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdhdHRyaWJ1dGVzVm0nLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9sYWIvYXR0cmlidXRlcy9hdHRyaWJ1dGVzLnZpZXcuaHRtbCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIucHJvZHVjdHMnKVxuICAgICAgICAuY29udHJvbGxlcignUHJvZHVjdHNDb250cm9sbGVyJywgUHJvZHVjdHNDb250cm9sbGVyKTtcblxuICAgIFByb2R1Y3RzQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHN0YXRlJywgJ2RhdGFzZXJ2aWNlJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBQcm9kdWN0c0NvbnRyb2xsZXIoJHNjb3BlLCAkc3RhdGUsIGRhdGFzZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0uc2VsZWN0ID0gc2VsZWN0O1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgZGF0YXNlcnZpY2UucmVhZHkoKS50aGVuKGdldFByb2R1Y3RzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2R1Y3RzKCkge1xuICAgICAgICAgIHZtLnByb2R1Y3RzID0gZGF0YXNlcnZpY2UuZ2V0UHJvZHVjdHMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdChwcm9kdWN0KSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXMucHJvZHVjdCA9IHByb2R1Y3Q7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLnByb2R1Y3RzJylcbiAgICAgICAgLnJ1bihhcHBSdW4pO1xuXG4gICAgYXBwUnVuLiRpbmplY3QgPSBbJ3JvdXRlckhlbHBlciddO1xuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGFwcFJ1bihyb3V0ZXJIZWxwZXIpIHtcbiAgICAgICAgcm91dGVySGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U3RhdGVzKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN0YXRlOiAnbGFiLnByb2R1Y3RzJyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3Byb2R1Y3RzJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdEb1lvdXJCZWF1dHkgLSBwcm9kdWN0cycsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQcm9kdWN0c0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICdwcm9kdWN0c1ZtJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvbGFiL3Byb2R1Y3RzL3Byb2R1Y3RzLnZpZXcuaHRtbCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdCdG5SYWRpb0NvbnRyb2xsZXInLCBCdG5SYWRpb0NvbnRyb2xsZXIpO1xuXG4gICAgQnRuUmFkaW9Db250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICckZmlsdGVyJ107XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBCdG5SYWRpb0NvbnRyb2xsZXIoJHNjb3BlLCAkZmlsdGVyKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XG4gICAgICAgIHZtLmltZ1ByZXZpZXcgPSBudWxsO1xuICAgICAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XG4gICAgICAgIHZtLnNldEltZ1ByZXZpZXcgPSBzZXRJbWdQcmV2aWV3O1xuXG4gICAgICAgIGZ1bmN0aW9uIHNldENob2ljZShhdHRyaWJ1dGVDaG9pY2VkKSB7XG4gICAgICAgICAgdm0uY2hvaWNlID0gYXR0cmlidXRlQ2hvaWNlZDtcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgICAgICAgIHNldEltZ1ByZXZpZXcodm0uY2hvaWNlLmltZyk7XG5cbiAgICAgICAgICAkc2NvcGUuYXR0cmlidXRlc1ZtLmdvVG9OZXh0KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgdm0uYXR0cmlidXRlLm5hbWUpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNldEltZ1ByZXZpZXcoaW1nKSB7XG4gICAgICAgICAgaWYgKHZtLmF0dHJpYnV0ZS5oYXZlSW1nUHJldmlldykge1xuICAgICAgICAgICAgdm0uaW1nUHJldmlldyA9IGltZztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAuY29udHJvbGxlcignQ2hlY2tib3hDb250cm9sbGVyJywgQ2hlY2tib3hDb250cm9sbGVyKTtcblxuICAgIENoZWNrYm94Q29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIENoZWNrYm94Q29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlcyA9IFtdO1xuICAgICAgICB2bS5leGlzdHMgPSBleGlzdHM7XG4gICAgICAgIHZtLnRvZ2dsZSA9IHRvZ2dsZTtcbiAgICAgICAgdm0uc2F2ZUNob2ljZXMgPSBzYXZlQ2hvaWNlcztcblxuICAgICAgICBmdW5jdGlvbiBleGlzdHModmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gdm0uY2hvaWNlcy5pbmRleE9mKHZhbHVlKSA+IC0xO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdG9nZ2xlKHZhbHVlKSB7XG4gICAgICAgICAgdmFyIGlkeCA9IHZtLmNob2ljZXMuaW5kZXhPZih2YWx1ZSk7XG4gICAgICAgICAgaWYgKGlkeCA+IC0xKSB7XG4gICAgICAgICAgICB2bS5jaG9pY2VzLnNwbGljZShpZHgsIDEpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2bS5jaG9pY2VzLnB1c2godmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBzYXZlQ2hvaWNlcygpIHtcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB2bS5jaG9pY2VzO1xuICAgICAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAuY29udHJvbGxlcignQ29sb3JDb250cm9sbGVyJywgQ29sb3JDb250cm9sbGVyKTtcblxuICAgIENvbG9yQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIENvbG9yQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY2hvaWNlID0gbnVsbDtcbiAgICAgICAgdm0uc2V0Q2hvaWNlID0gc2V0Q2hvaWNlO1xuICAgICAgICB2bS5zZXRPcGFjaXR5ID0gc2V0T3BhY2l0eTtcbiAgICAgICAgdm0uc2F2ZUNob2ljZSA9IHNhdmVDaG9pY2U7XG4gICAgICAgIHZtLnBlcmNlbnQgPSAxMDA7XG5cblxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoYXR0cmlidXRlQ2hvaWNlZCkge1xuICAgICAgICAgIGlmICh2bS5jaG9pY2UpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb3JtLWNvbG9yLScgKyB2bS5jaG9pY2UpLnN0eWxlLm9wYWNpdHkgPSAxO1xuICAgICAgICAgICAgdm0ucGVyY2VudCA9IDEwMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgdm0uY2hvaWNlID0gYXR0cmlidXRlQ2hvaWNlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNhdmVDaG9pY2UoKSB7XG4gICAgICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0ge3ZhbHVlOiB2bS5jaG9pY2UsIHBlcmNlbnQ6IHZtLnBlcmNlbnR9O1xuICAgICAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0T3BhY2l0eSgpIHtcbiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9ybS1jb2xvci0nICsgdm0uY2hvaWNlKS5zdHlsZS5vcGFjaXR5ID0gdm0ucGVyY2VudCAvIDEwMDtcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgICAgLm1vZHVsZSgnYXBwLmxhYi5hdHRyaWJ1dGVzJylcbiAgICAgIC5jb250cm9sbGVyKCdJbWdSYWRpb0NvbnRyb2xsZXInLCBJbWdSYWRpb0NvbnRyb2xsZXIpO1xuXG4gIEltZ1JhZGlvQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAvKiBAbmdJbmplY3QgKi9cbiAgZnVuY3Rpb24gSW1nUmFkaW9Db250cm9sbGVyKCRzY29wZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uY2hvaWNlID0gbnVsbDtcbiAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XG5cblxuICAgIGZ1bmN0aW9uIHNldENob2ljZShhdHRyaWJ1dGVDaG9pY2VkKSB7XG4gICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgICAgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdID0gYXR0cmlidXRlQ2hvaWNlZDtcbiAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xuICAgIH1cblxuICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAuY29udHJvbGxlcignSW5wdXRUZXh0Q29udHJvbGxlcicsIElucHV0VGV4dENvbnRyb2xsZXIpO1xuXG4gICAgSW5wdXRUZXh0Q29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIElucHV0VGV4dENvbnRyb2xsZXIoJHNjb3BlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLmNob2ljZSA9IG51bGw7XG4gICAgICAgIHZtLnNldENob2ljZSA9IHNldENob2ljZTtcblxuICAgICAgICBmdW5jdGlvbiBzZXRDaG9pY2UoKSB7XG4gICAgICAgICAgaWYgKHZtLmNob2ljZSAhPT0gXCJcIiAmJiB2bS5jaG9pY2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgICRzY29wZS5sYWJWbS5jaG9pY2VzW3ZtLmF0dHJpYnV0ZS5uYW1lXSA9IHZtLmNob2ljZTtcbiAgICAgICAgICAgICRzY29wZS5hdHRyaWJ1dGVzVm0uZ29Ub05leHQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyB2bS5hdHRyaWJ1dGUubmFtZSkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgJHNjb3BlLmxhYlZtLmNob2ljZXNbdm0uYXR0cmlidXRlLm5hbWVdO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5sYWIuYXR0cmlidXRlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdSYWRpb1NsaWRlckNvbnRyb2xsZXInLCBSYWRpb1NsaWRlckNvbnRyb2xsZXIpO1xuXG4gICAgUmFkaW9TbGlkZXJDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gUmFkaW9TbGlkZXJDb250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5jaG9pY2UgPSBudWxsO1xuICAgICAgICB2bS5zZXRDaG9pY2UgPSBzZXRDaG9pY2U7XG4gICAgICAgIHZtLnNhdmVDaG9pY2UgPSBzYXZlQ2hvaWNlO1xuICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xuXG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2hvaWNlKGF0dHJpYnV0ZUNob2ljZWQpIHtcbiAgICAgICAgICBpZiAodm0uY2hvaWNlKSB7XG4gICAgICAgICAgICB2bS5wZXJjZW50ID0gMTAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2bS5jaG9pY2UgPSBhdHRyaWJ1dGVDaG9pY2VkO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZUNob2ljZSgpIHtcbiAgICAgICAgICAkc2NvcGUubGFiVm0uY2hvaWNlc1t2bS5hdHRyaWJ1dGUubmFtZV0gPSB7dmFsdWU6IHZtLmNob2ljZSwgcGVyY2VudDogdm0ucGVyY2VudH07XG4gICAgICAgICAgJHNjb3BlLmF0dHJpYnV0ZXNWbS5nb1RvTmV4dChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyArIHZtLmF0dHJpYnV0ZS5uYW1lKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubGFiLmF0dHJpYnV0ZXMnKVxuICAgICAgICAuY29udHJvbGxlcignQ3JlYW1Db250cm9sbGVyJywgQ3JlYW1Db250cm9sbGVyKTtcblxuICAgIENyZWFtQ29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIENyZWFtQ29udHJvbGxlcigkc2NvcGUpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgXG4gICAgfVxuXG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
